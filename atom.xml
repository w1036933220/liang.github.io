<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Liangçš„ä¸ªäººåšå®¢</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://liang5757.github.io/"/>
  <updated>2021-06-08T14:46:20.560Z</updated>
  <id>https://liang5757.github.io/</id>
  
  <author>
    <name>Liang</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>React Hook</title>
    <link href="https://liang5757.github.io/2021/06/08/React/React%20Hook/"/>
    <id>https://liang5757.github.io/2021/06/08/React/React%20Hook/</id>
    <published>2021-06-08T14:45:46.000Z</published>
    <updated>2021-06-08T14:46:20.560Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‡½æ•°å¼ç»„ä»¶åªèƒ½ä½¿ç”¨propsï¼ŒHookèƒ½å¤Ÿåœ¨å‡½æ•°å¼ç»„ä»¶çš„æƒ…å†µä¸‹ä½¿ç”¨stateã€ç”Ÿå‘½å‘¨æœŸä»¥åŠå…¶ä»–çš„Reactç‰¹æ€§</p></blockquote><p>ä¸ºä»€ä¹ˆéœ€è¦å¼•å…¥React Hookï¼Œå¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://zh-hans.reactjs.org/docs/hooks-intro.html#motivation">https://zh-hans.reactjs.org/docs/hooks-intro.html#motivation</a></p><h2 id="1-æ³¨æ„äº‹é¡¹"><a href="#1-æ³¨æ„äº‹é¡¹" class="headerlink" title="1. æ³¨æ„äº‹é¡¹"></a>1. æ³¨æ„äº‹é¡¹</h2><ul><li>åªèƒ½åœ¨å‡½æ•°å†…éƒ¨çš„æœ€å¤–å±‚è°ƒç”¨ Hookï¼Œä¸è¦åœ¨å¾ªç¯ã€æ¡ä»¶åˆ¤æ–­æˆ–è€…å­å‡½æ•°ä¸­è°ƒç”¨</li><li>åªèƒ½åœ¨ React çš„å‡½æ•°ç»„ä»¶æˆ–è‡ªå®šä¹‰Hookä¸­è°ƒç”¨ Hookï¼Œä¸è¦åœ¨å…¶ä»– JavaScript å‡½æ•°ä¸­è°ƒç”¨</li><li>Hook åœ¨ class å†…éƒ¨æ˜¯<strong>ä¸</strong>èµ·ä½œç”¨çš„</li></ul><h2 id="2-useState"><a href="#2-useState" class="headerlink" title="2. useState"></a>2. useState</h2><p>useStateåœ¨ç»„ä»¶å†…åˆ›å»ºçš„å†…éƒ¨stateï¼ŒReact ä¼šåœ¨é‡å¤æ¸²æŸ“æ—¶ä¿ç•™è¿™ä¸ª stateï¼Œè¯¥å‡½æ•°çš„<strong>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åˆå§‹å€¼</strong>ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œæ­¤å‡½æ•°åªåœ¨åˆå§‹æ¸²æŸ“ä¸­è¢«è°ƒç”¨ã€‚è°ƒç”¨è¯¥å‡½æ•°ä¼šè¿”å›ä¸€å¯¹å€¼ï¼š[å½“å‰çŠ¶æ€ï¼Œæ›´æ–°å½“å‰çŠ¶æ€çš„å‡½æ•°]ã€‚</p><p>è¿™ä¸ªæ›´æ–°çŠ¶æ€çš„å‡½æ•°<strong>ä¸ä¼šå¯¹stateè¿›è¡Œåˆå¹¶ï¼Œè€Œæ˜¯ç›´æ¥æ›¿æ¢</strong>ï¼Œå¯ä»¥ä¼ é€’ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæºå¸¦å‚æ•°æ˜¯ä¸Šä¸€æ¬¡çš„state</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>; <span class="number">2</span>:</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>); <span class="number">5</span>:</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt;</span><br><span class="line">            &lt;button onClick=&#123;<span class="function">() =&gt;</span> setCount(count + <span class="number">1</span>)&#125;&gt;</span><br><span class="line">                Click me</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†…éƒ¨ä½¿ç”¨<code>Object.js</code>ï¼ˆæµ…ï¼‰æ¥æ¯”è¾ƒæ–°/æ—§<code>state</code>æ˜¯å¦ç›¸ç­‰ï¼Œåœ¨ä¿®æ”¹çŠ¶æ€æ—¶ï¼Œ<strong>ä¼ çš„çŠ¶æ€å€¼æ²¡æœ‰å˜åŒ–ï¼Œåˆ™ä¸é‡æ–°æ¸²æŸ“</strong></p><h2 id="2-useEffect"><a href="#2-useEffect" class="headerlink" title="2. useEffect"></a>2. useEffect</h2><p>ç”¨æ¥åœ¨å‡½æ•°å¼ç»„ä»¶å†…ä½¿ç”¨classç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå¯ä»¥ä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯ç›‘å¬çš„å˜é‡æ•°ç»„ã€‚</p><h3 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h3><h4 id="1-åªåœ¨ç¬¬ä¸€æ¬¡çš„componentDidMountæ‰§è¡Œ"><a href="#1-åªåœ¨ç¬¬ä¸€æ¬¡çš„componentDidMountæ‰§è¡Œ" class="headerlink" title="1.åªåœ¨ç¬¬ä¸€æ¬¡çš„componentDidMountæ‰§è¡Œ"></a>1.åªåœ¨ç¬¬ä¸€æ¬¡çš„componentDidMountæ‰§è¡Œ</h4><p>ç¬¬äºŒä¸ªå‚æ•°ä¸º []</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">useEffect(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;, [])</span><br></pre></td></tr></table></figure><h4 id="2-åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“å’Œæ¯æ¬¡æ›´æ–°åæ‰§è¡Œ"><a href="#2-åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“å’Œæ¯æ¬¡æ›´æ–°åæ‰§è¡Œ" class="headerlink" title="2. åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“å’Œæ¯æ¬¡æ›´æ–°åæ‰§è¡Œ"></a>2. åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“å’Œæ¯æ¬¡æ›´æ–°åæ‰§è¡Œ</h4><p>ç¬¬äºŒä¸ªå‚æ•°ä¸ºç©º</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">useEffect(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="3-ç›‘å¬å˜é‡çš„å˜åŒ–æ‰§è¡Œ"><a href="#3-ç›‘å¬å˜é‡çš„å˜åŒ–æ‰§è¡Œ" class="headerlink" title="3. ç›‘å¬å˜é‡çš„å˜åŒ–æ‰§è¡Œ"></a>3. ç›‘å¬å˜é‡çš„å˜åŒ–æ‰§è¡Œ</h4><p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå˜é‡æ•°ç»„ï¼Œåªè¦æœ‰ä¸€ä¸ªå˜é‡å˜åŒ–äº†å°±ä¼šæ‰§è¡Œ</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// countæ”¹å˜æ‰ä¼šæ‰§è¡Œ</span></span><br><span class="line">&#125;, [count])</span><br></pre></td></tr></table></figure><h4 id="4-åœ¨componentWillUnmountä¸­æ‰§è¡Œ"><a href="#4-åœ¨componentWillUnmountä¸­æ‰§è¡Œ" class="headerlink" title="4. åœ¨componentWillUnmountä¸­æ‰§è¡Œ"></a>4. åœ¨componentWillUnmountä¸­æ‰§è¡Œ</h4><p>ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°å¯ä»¥returnä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªreturnçš„å‡½æ•°ä¼šåœ¨<code>componentWillUnmount</code>è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ‰§è¡Œã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;use effect...&#x27;</span>, count)</span><br><span class="line">    <span class="keyword">const</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> setCount(count +<span class="number">1</span>), <span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="built_in">clearInterval</span>(timer)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="3-useRef"><a href="#3-useRef" class="headerlink" title="3. useRef"></a>3. useRef</h2><p><code>useRef</code> è¿”å›ä¸€ä¸ªå¯å˜çš„ ref å¯¹è±¡ï¼Œå…¶ <code>.current</code> å±æ€§è¢«åˆå§‹åŒ–ä¸ºä¼ å…¥çš„å‚æ•°ï¼ˆ<code>initialValue</code>ï¼‰ã€‚è¿”å›çš„ ref å¯¹è±¡åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜ã€‚</p><p>å½“ ref å¯¹è±¡å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ<code>useRef</code> å¹¶<em>ä¸ä¼š</em>é€šçŸ¥ä½ ã€‚å˜æ›´ <code>.current</code> å±æ€§ä¸ä¼šå¼•å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</p><p><strong>å’ŒcreateRefçš„åŒºåˆ«</strong>ï¼šcreateRef æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å¼•ç”¨ï¼Œè€Œ useRef æ¯æ¬¡éƒ½ä¼šè¿”å›ç›¸åŒçš„å¼•ç”¨ï¼ˆå¯ä»¥è§£å†³æ¯æ¬¡æ¸²æŸ“å¼•ç”¨ä¸åŒçš„useStateï¼Œå¯¼è‡´çŠ¶æ€å¼‚å¸¸çš„bugï¼‰</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [renderIndex, setRenderIndex] = useState(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">const</span> refFromUseRef = useRef();</span><br><span class="line">    <span class="keyword">const</span> refFromCreateRef = createRef();</span><br><span class="line">    <span class="keyword">if</span> (!refFromUseRef.current) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;useRef&quot;</span>)</span><br><span class="line">        refFromUseRef.current = renderIndex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!refFromCreateRef.current) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;createRef&quot;</span>)</span><br><span class="line">        refFromCreateRef.current = renderIndex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div className=<span class="string">&quot;App&quot;</span>&gt;</span><br><span class="line">            Current render index: &#123;renderIndex&#125;</span><br><span class="line">            &lt;p&gt;refFromUseRef value: &#123;refFromUseRef.current&#125;&lt;/p&gt;</span><br><span class="line">            &lt;p&gt;refFromCreateRef value: &#123;refFromCreateRef.current&#125;&lt;/p&gt;</span><br><span class="line">            &lt;button onClick=&#123;<span class="function">() =&gt;</span> setRenderIndex(<span class="function"><span class="params">prev</span> =&gt;</span> prev + <span class="number">1</span>)&#125;&gt;</span><br><span class="line">                Cause re-render</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>![image-20210606235123989](D:\OneDrive - mail2.gdut.edu.cn\typora_img\React Hook\image-20210606235123989.png)</p><h2 id="4-useMemo"><a href="#4-useMemo" class="headerlink" title="4.useMemo"></a>4.useMemo</h2><blockquote><p>çˆ¶ç»„ä»¶çš„stateæ”¹å˜ï¼Œå­ç»„ä»¶ä¹Ÿä¼šéšä¹‹é‡æ–°renderï¼Œå³ä½¿å­ç»„ä»¶å†…éƒ¨stateæ²¡æœ‰æ”¹å˜ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨useMemoæ¥è¿›è¡Œæ€§èƒ½ä¼˜åŒ–</p></blockquote><p>å‚æ•°åˆ—è¡¨</p><ul><li>å›è°ƒå‡½æ•°ï¼Œreturnå‡ºæ¥çš„å€¼ä½œä¸ºuseMemoçš„è¿”å›å€¼</li><li>ä¾èµ–é¡¹æ•°ç»„ï¼Œåªè¦æœ‰ä¸€ä¸ªå˜é‡æ”¹å˜ï¼Œå°±ä¼šé‡æ–°æ‰§è¡Œå›è°ƒï¼Œä½†ä¸ä¼šè§¦å‘æ¸²æŸ“ï¼Œå¦‚æœ<strong>æ²¡æœ‰æä¾›ä¾èµ–æ•°ç»„ï¼Œåˆ™<code>useMemo</code> åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½ä¼šè®¡ç®—æ–°çš„å€¼</strong></li></ul><p><code>useMemo</code>è¿”å›ä¸€ä¸ª <a href="https://en.wikipedia.org/wiki/Memoization">memoized</a> å€¼ï¼Œå®ƒä»…ä¼šåœ¨ä¼šåœ¨æŸä¸ªä¾èµ–é¡¹æ”¹å˜æ—¶æ‰é‡æ–°è®¡ç®— memoized å€¼ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Child = memo(<span class="function">(<span class="params">&#123;data&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;child render...&#x27;</span>, data.name)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;div&gt;child&lt;/div&gt;</span><br><span class="line">            &lt;div&gt;&#123;data.name&#125;&lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Hook = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Hook render...&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">const</span> [name, setName] = useState(<span class="string">&#x27;rose&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> data = useMemo(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            name</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, [name])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>(</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &#123;count&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;button onClick=&#123;<span class="function">() =&gt;</span> setCount(count + <span class="number">1</span>)&#125;&gt;update count &lt;/button&gt;</span><br><span class="line">            &lt;Child data=&#123;data&#125;/&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-useCallback"><a href="#5-useCallback" class="headerlink" title="5. useCallback"></a>5. useCallback</h2><blockquote><p><code>useCallback</code>ä¸<code>useMemo</code>çš„å·®åˆ«æ˜¯ï¼Œå‰è€…æ˜¯ç¼“å­˜å‡½æ•°ï¼Œåè€…æ˜¯ç¼“å­˜å€¼</p></blockquote><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> onChange = useCallback(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    setText(e.target.value)</span><br><span class="line">&#125;, [])</span><br></pre></td></tr></table></figure><p><code>useCallback(fn, deps)</code>ç›¸å½“äº<code>useMemo(() =&gt; fn, deps)</code></p><h2 id="6-useContext"><a href="#6-useContext" class="headerlink" title="6. useContext"></a>6. useContext</h2><p>æ¥æ”¶ä¸€ä¸ª context å¯¹è±¡ï¼ˆç”±<code>React.createContext</code> æ‰€åˆ›å»ºï¼‰å¹¶è¿”å›è¯¥ context çš„å½“å‰å€¼ï¼Œå½“å‰çš„ context å€¼ç”±ä¸Šå±‚ç»„ä»¶ä¸­è·ç¦»å½“å‰ç»„ä»¶æœ€è¿‘çš„ <code>&lt;MyContext.Provider&gt;</code> çš„ <code>value</code> prop å†³å®š</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> TextContext = React.createContext();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;TextContext.Provider value=&#123;<span class="number">666</span>&#125;&gt;</span><br><span class="line">      &lt;Toolbar /&gt;</span><br><span class="line">    &lt;/TextContext.Provider&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Toolbar</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;xxxButton /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">xxxButton</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> text = useContext(ThemeContext);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;button style=&#123;&#123; <span class="attr">color</span>: text &#125;&#125;&gt;</span><br><span class="line">      I am styled by theme context!</span><br><span class="line">    &lt;/button&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ç»„ä»¶ä¸Šå±‚æœ€è¿‘çš„ <code>&lt;MyContext.Provider&gt;</code> æ›´æ–°æ—¶ï¼Œè¯¥ Hook ä¼šè§¦å‘é‡æ¸²æŸ“ï¼Œå¹¶ä½¿ç”¨æœ€æ–°ä¼ é€’ç»™ <code>MyContext</code> provider çš„ context <code>value</code> å€¼ã€‚å³ä½¿ç¥–å…ˆä½¿ç”¨ <a href="https://zh-hans.reactjs.org/docs/react-api.html#reactmemo"><code>React.memo</code></a> æˆ– <a href="https://zh-hans.reactjs.org/docs/react-component.html#shouldcomponentupdate"><code>shouldComponentUpdate</code></a>ï¼Œä¹Ÿä¼šåœ¨ç»„ä»¶æœ¬èº«ä½¿ç”¨ <code>useContext</code> æ—¶é‡æ–°æ¸²æŸ“</p><h2 id="7-è‡ªå®šä¹‰Hook"><a href="#7-è‡ªå®šä¹‰Hook" class="headerlink" title="7. è‡ªå®šä¹‰Hook"></a>7. è‡ªå®šä¹‰Hook</h2><p>å…¶å®å°±æ˜¯å†™ä¸€ä¸ªå‡½æ•°å†…éƒ¨è°ƒç”¨å…¶ä»–Hookï¼Œæ¯æ¬¡ä½¿ç”¨è‡ªå®šä¹‰Hookæ—¶ï¼Œæ‰€æœ‰çš„stateå’Œå‰¯ä½œç”¨éƒ½æ˜¯å®Œå…¨éš”ç¦»çš„</p><p>ä¾‹å¦‚ï¼šæˆ‘ä»¬å¯ä»¥å¯¹useRefå°è£…æˆè‡ªå®šä¹‰Hookæ¥è·å–ä¸Šä¸€æ¬¡çš„å€¼</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> usePrevious = <span class="function"><span class="params">state</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> ref = useRef();</span><br><span class="line"></span><br><span class="line">    useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        ref.current = state;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ref.current;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">const</span> prevCount = usePrevious(count);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div className=<span class="string">&quot;App&quot;</span>&gt;</span><br><span class="line">            &lt;button onClick=&#123;<span class="function">() =&gt;</span> setCount(count + <span class="number">1</span>)&#125;&gt;</span><br><span class="line">                Cause re-render</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line">            &lt;p&gt; &#123;count&#125; &#123;prevCount&#125;&lt;/p&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯æ¬¡ç‚¹å‡»buttonï¼ŒprevCountéƒ½æ˜¯ä¸Šä¸€æ¬¡countçš„å€¼</p><h2 id="æ˜“é”™ç‚¹"><a href="#æ˜“é”™ç‚¹" class="headerlink" title="æ˜“é”™ç‚¹"></a>æ˜“é”™ç‚¹</h2><h3 id="1-ä¸ºä»€ä¹ˆæˆ‘çš„countæ²¡æœ‰æ›´æ–°"><a href="#1-ä¸ºä»€ä¹ˆæˆ‘çš„countæ²¡æœ‰æ›´æ–°" class="headerlink" title="1. ä¸ºä»€ä¹ˆæˆ‘çš„countæ²¡æœ‰æ›´æ–°"></a>1. ä¸ºä»€ä¹ˆæˆ‘çš„countæ²¡æœ‰æ›´æ–°</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ErrorDemo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">const</span> dom = useRef(<span class="literal">null</span>);</span><br><span class="line">    useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        dom.current.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> setCount(count + <span class="number">1</span>));</span><br><span class="line">    &#125;, []);</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;dom&#125;</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ®µä»£ç ï¼Œç”¨æˆ·ç‚¹å‡»divï¼Œcountåªä¼šåŠ åˆ°1ï¼Œåé¢å°±ä¸ä¼šå†åŠ äº†ã€‚</p><p>åŸå› æ˜¯ï¼šæ¯æ¬¡ <code>count</code> éƒ½æ˜¯é‡æ–°å£°æ˜çš„å˜é‡ï¼ŒæŒ‡å‘ä¸€ä¸ªå…¨æ–°çš„æ•°æ®ï¼›æ¯æ¬¡çš„ <code>setCount</code> è™½ç„¶æ˜¯é‡æ–°å£°æ˜çš„ï¼Œä½†æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå¼•ç”¨ã€‚</p><h3 id="è§£å†³æ–¹å¼ä¸€ï¼šå‡½æ•°å¼æ›´æ–°"><a href="#è§£å†³æ–¹å¼ä¸€ï¼šå‡½æ•°å¼æ›´æ–°" class="headerlink" title="è§£å†³æ–¹å¼ä¸€ï¼šå‡½æ•°å¼æ›´æ–°"></a>è§£å†³æ–¹å¼ä¸€ï¼šå‡½æ•°å¼æ›´æ–°</h3><p>ç”¨å›è°ƒå‡½æ•°çš„å½¢å¼ï¼Œ<code>() =&gt; setCount(prevCount =&gt; ++prevCount)</code>ï¼Œæ¥æ¶ˆé™¤å¯¹å¤–éƒ¨countçš„å¼•ç”¨ã€‚</p><h3 id="è§£å†³æ–¹å¼äºŒï¼šé‡æ–°ç»‘å®šäº‹ä»¶"><a href="#è§£å†³æ–¹å¼äºŒï¼šé‡æ–°ç»‘å®šäº‹ä»¶" class="headerlink" title="è§£å†³æ–¹å¼äºŒï¼šé‡æ–°ç»‘å®šäº‹ä»¶"></a>è§£å†³æ–¹å¼äºŒï¼šé‡æ–°ç»‘å®šäº‹ä»¶</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    dom.current.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> setCount(count + <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> dom.current.removeEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> setCount(count + <span class="number">1</span>));</span><br><span class="line">&#125;, [count]); <span class="comment">// åœ¨è¿™é‡Œå¯¹countè¿›è¡Œç›‘å¬ï¼Œæ¯æ¬¡æ”¹å˜éƒ½ä¼šé‡æ–°ç»‘å®šäº‹ä»¶</span></span><br><span class="line"><span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br></pre></td></tr></table></figure><h3 id="è§£å†³æ–¹å¼ä¸‰ï¼šç”¨refé‡æ–°è·å–å¼•ç”¨"><a href="#è§£å†³æ–¹å¼ä¸‰ï¼šç”¨refé‡æ–°è·å–å¼•ç”¨" class="headerlink" title="è§£å†³æ–¹å¼ä¸‰ï¼šç”¨refé‡æ–°è·å–å¼•ç”¨"></a>è§£å†³æ–¹å¼ä¸‰ï¼šç”¨refé‡æ–°è·å–å¼•ç”¨</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dom = useRef(<span class="literal">null</span>);</span><br><span class="line"><span class="keyword">const</span> countRef = useRef(count);</span><br><span class="line">useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    dom.current.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        countRef.current++;</span><br><span class="line">        setCount(countRef.current);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;, []);</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://juejin.cn/post/6844904090032406536">å†™React Hookså‰å¿…è¯»</a><br><a href="https://juejin.cn/post/6844904072168865800">ç»ˆäºææ‡‚ React Hooksäº†ï¼ï¼ï¼ï¼ï¼</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;å‡½æ•°å¼ç»„ä»¶åªèƒ½ä½¿ç”¨propsï¼ŒHookèƒ½å¤Ÿåœ¨å‡½æ•°å¼ç»„ä»¶çš„æƒ…å†µä¸‹ä½¿ç”¨stateã€ç”Ÿå‘½å‘¨æœŸä»¥åŠå…¶ä»–çš„Reactç‰¹æ€§&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆéœ€è¦å¼•å…¥React Hookï¼Œå¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š&lt;a href=&quot;https://zh-
      
    
    </summary>
    
    
      <category term="å‰ç«¯" scheme="https://liang5757.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="React" scheme="https://liang5757.github.io/tags/React/"/>
    
  </entry>
  
  <entry>
    <title>React Router</title>
    <link href="https://liang5757.github.io/2021/05/28/React/React%20Router/"/>
    <id>https://liang5757.github.io/2021/05/28/React/React%20Router/</id>
    <published>2021-05-28T12:13:21.000Z</published>
    <updated>2021-05-28T15:50:29.396Z</updated>
    
    <content type="html"><![CDATA[<ul><li>react-routerï¼šè·¯ç”±æ ¸å¿ƒåº“ï¼ŒåŒ…å«è¯¸å¤šå’Œè·¯ç”±åŠŸèƒ½ç›¸å…³çš„æ ¸å¿ƒä»£ç </li><li>react-router-domï¼šåˆ©ç”¨è·¯ç”±æ ¸å¿ƒåº“ï¼Œç»“åˆå®é™…çš„é¡µé¢ï¼Œå®ç°è·Ÿé¡µé¢è·¯ç”±å¯†åˆ‡ç›¸å…³çš„åŠŸèƒ½</li></ul><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># react-router-domä¾èµ–react-router</span></span><br><span class="line"><span class="comment"># å®‰è£…çš„æ—¶å€™ä¼šæŠŠreact-routerä¸€èµ·å®‰è£…äº†</span></span><br><span class="line">npm install react-router-dom -S</span><br></pre></td></tr></table></figure><h2 id="1-ä¸¤ç§è·¯ç”±æ¨¡å¼-Hashã€History"><a href="#1-ä¸¤ç§è·¯ç”±æ¨¡å¼-Hashã€History" class="headerlink" title="1.ä¸¤ç§è·¯ç”±æ¨¡å¼ Hashã€History"></a>1.ä¸¤ç§è·¯ç”±æ¨¡å¼ Hashã€History</h2><ul><li><code>HashRouter</code>ï¼šä½¿ç”¨ hash æ¨¡å¼åŒ¹é…</li><li><code>BrowserRouter</code>ï¼šä½¿ç”¨ BrowserHistory æ¨¡å¼åŒ¹é…</li></ul><p>ä¸¤è€…åŒºåˆ«<br>1.åº•å±‚åŸç†ä¸ä¸€æ ·ï¼š<br>    BrowserRouterä½¿ç”¨çš„æ˜¯H5çš„history APIï¼Œä¸å…¼å®¹IE9åŠä»¥ä¸‹ç‰ˆæœ¬ã€‚<br>    HashRouterä½¿ç”¨çš„æ˜¯URLçš„å“ˆå¸Œå€¼ã€‚<br>2.pathè¡¨ç°å½¢å¼ä¸ä¸€æ ·<br>    BrowserRouterçš„è·¯å¾„ä¸­æ²¡æœ‰#ï¼Œä¾‹å¦‚ï¼šlocalhost:3000/demo/test<br>    HashRouterçš„è·¯å¾„åŒ…å«#,ä¾‹å¦‚ï¼šlocalhost:3000/#/demo/test<br>3.åˆ·æ–°åå¯¹è·¯ç”±stateå‚æ•°çš„å½±å“<br>    BrowserRouteræ²¡æœ‰ä»»ä½•å½±å“ï¼Œå› ä¸ºstateä¿å­˜åœ¨historyå¯¹è±¡ä¸­ã€‚<br>    HashRouteråˆ·æ–°åä¼šå¯¼è‡´è·¯ç”±stateå‚æ•°çš„ä¸¢å¤±ï¼ï¼ï¼<br>4.å¤‡æ³¨ï¼šHashRouterå¯ä»¥ç”¨äºè§£å†³ä¸€äº›è·¯å¾„é”™è¯¯ç›¸å…³çš„é—®é¢˜ã€‚</p><h2 id="2-è·³è½¬ç»„ä»¶-Linkå’ŒNavLink"><a href="#2-è·³è½¬ç»„ä»¶-Linkå’ŒNavLink" class="headerlink" title="2. è·³è½¬ç»„ä»¶ Linkå’ŒNavLink"></a>2. è·³è½¬ç»„ä»¶ Linkå’ŒNavLink</h2><p>Linkç»„ä»¶</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Link to=<span class="string">&quot;/xxxxx&quot;</span>&gt;Demo&lt;/Link&gt;</span><br></pre></td></tr></table></figure><p>Linkç»„ä»¶é…ç½®æ–¹å¼</p><ul><li><p>toï¼šè¦è·³è½¬çš„é“¾æ¥ï¼ˆString | Object  | Functionï¼‰</p></li><li><p>replaceï¼šè®¾ç½®ä¸ºtrueï¼Œåˆ™è·³è½¬æ›¿æ¢è·¯ç”±æ ˆé¡¶</p></li><li><p>innerRefï¼šå¯ä»¥å°†å†…éƒ¨çš„aå…ƒç´ çš„refé™„ç€åœ¨ä¼ é€’çš„å¯¹è±¡æˆ–å‡½æ•°å‚æ•°ä¸Šï¼ˆFunction | RefObjectï¼‰</p></li><li><p>componentï¼šå¯ä»¥è®¾ç½®è‡ªå®šä¹‰çš„å¯¼èˆªç»„ä»¶</p>  <figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> FancyLink = React.forwardRef(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> (</span><br><span class="line">    &lt;a ref=&#123;ref&#125; &#123;...props&#125;&gt;ğŸ’… &#123;props.children&#125;&lt;/a&gt;</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">&lt;Link to=<span class="string">&quot;/&quot;</span> component=&#123;FancyLink&#125; /&gt;</span><br></pre></td></tr></table></figure></li></ul><p><strong>NavLink</strong>å¯ä»¥å®ç°è·¯ç”±é“¾æ¥çš„é«˜äº®ï¼Œé€šè¿‡<code>activeClassName</code>æŒ‡å®šæ ·å¼ç±»å</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;NavLink to=<span class="string">&quot;/xxxxx&quot;</span>&gt;Demo&lt;/NavLink&gt;</span><br></pre></td></tr></table></figure><h2 id="3-routeç»„ä»¶"><a href="#3-routeç»„ä»¶" class="headerlink" title="3. routeç»„ä»¶"></a>3. routeç»„ä»¶</h2><p>é…ç½®æ–¹å¼</p><ul><li>pathï¼šåŒ¹é…çš„è·¯å¾„<ul><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼Œå¯ä»¥è®¾ç½®sensitiveå±æ€§ä¸ºtrueï¼Œæ¥åŒºåˆ†å¤§å°å†™</li><li>é»˜è®¤æƒ…å†µä¸‹ï¼ŒåªåŒ¹é…åˆå§‹ç›®å½•ï¼Œå¦‚æœè¦ç²¾ç¡®åŒ¹é…ï¼Œé…ç½®exactå±æ€§ä¸ºtrue</li><li>å¦‚æœä¸å†™pathï¼Œåˆ™ä¼šåŒ¹é…ä»»æ„è·¯å¾„</li></ul></li><li>componentï¼šåŒ¹é…æˆåŠŸåè¦æ˜¾ç¤ºçš„ç»„ä»¶</li><li>children<ul><li>ä¼ é€’Reactå…ƒç´ ï¼Œæ— è®ºæ˜¯å¦åŒ¹é…ï¼Œä¸€å®šä¼šæ˜¾ç¤ºchildrenï¼Œå¹¶ä¸”ä¼šå¿½ç•¥componentå±æ€§</li><li>ä¼ é€’ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æœ‰å¤šä¸ªå‚æ•°ï¼Œè¿™äº›å‚æ•°æ¥è‡ªäºä¸Šä¸‹æ–‡ï¼Œè¯¥å‡½æ•°è¿”å›reactå…ƒç´ ï¼Œåˆ™ä¸€å®šä¼šæ˜¾ç¤ºè¿”å›çš„å…ƒç´ ï¼Œå¹¶ä¸”å¿½ç•¥componentå±æ€§</li></ul></li><li>renderï¼šåŒ¹é…æˆåŠŸæ¸²æŸ“çš„ç»„ä»¶ï¼Œå†…è”ä¹¦å†™renderï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªReactå…ƒç´ </li><li>sensitiveï¼štrueåˆ™å¯¹pahtçš„å¤§å°å†™æ•æ„Ÿ</li><li>exactï¼šç²¾ç¡®åŒ¹é…</li></ul><h3 id="routeåµŒå¥—"><a href="#routeåµŒå¥—" class="headerlink" title="routeåµŒå¥—"></a>routeåµŒå¥—</h3><p>ä¸‹è¿°ä»£ç ä¸­ï¼Œç”¨æˆ·è®¿é—®<code>/repos</code>æ—¶ï¼Œä¼šå…ˆåŠ è½½<code>App</code>ç»„ä»¶ï¼Œç„¶ååœ¨å®ƒçš„å†…éƒ¨å†åŠ è½½<code>Repos</code>ç»„ä»¶ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;BrowserRouter history=&#123;hashHistory&#125;&gt;</span><br><span class="line">    &lt;Route path=<span class="string">&quot;/&quot;</span> component=&#123;App&#125;&gt;</span><br><span class="line">        &lt;Route path=<span class="string">&quot;/repos&quot;</span> component=&#123;Repos&#125;/&gt;</span><br><span class="line">        &lt;Route path=<span class="string">&quot;/about&quot;</span> component=&#123;About&#125;/&gt;</span><br><span class="line">    &lt;/Route&gt;</span><br><span class="line">&lt;/BrowserRouter&gt;</span><br></pre></td></tr></table></figure><h3 id="åŒ¹é…è§„åˆ™"><a href="#åŒ¹é…è§„åˆ™" class="headerlink" title="åŒ¹é…è§„åˆ™"></a>åŒ¹é…è§„åˆ™</h3><ol><li>:paramName</li></ol><p><code>:paramName</code>åŒ¹é…URLçš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ª<code>/</code>ã€<code>?</code>ã€<code>#</code>ä¸ºæ­¢ã€‚è¿™ä¸ªè·¯å¾„å‚æ•°å¯ä»¥é€šè¿‡<code>this.props.params.paramName</code>å–å‡ºã€‚</p><ol start="2"><li>()</li></ol><p><code>()</code>è¡¨ç¤ºURLçš„è¿™ä¸ªéƒ¨åˆ†æ˜¯å¯é€‰çš„ã€‚</p><ol start="3"><li>*</li></ol><p><code>*</code>åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œç›´åˆ°æ¨¡å¼é‡Œé¢çš„ä¸‹ä¸€ä¸ªå­—ç¬¦ä¸ºæ­¢ã€‚åŒ¹é…æ–¹å¼æ˜¯éè´ªå©ªæ¨¡å¼ã€‚</p><ol start="4"><li>**</li></ol><p><code>**</code> åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œç›´åˆ°ä¸‹ä¸€ä¸ª<code>/</code>ã€<code>?</code>ã€<code>#</code>ä¸ºæ­¢ã€‚åŒ¹é…æ–¹å¼æ˜¯è´ªå©ªæ¨¡å¼ã€‚</p><p>æ­¤å¤–ï¼ŒURLçš„æŸ¥è¯¢å­—ç¬¦ä¸²<code>/foo?bar=baz</code>ï¼Œå¯ä»¥ç”¨<code>this.props.location.query.bar</code>è·å–ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BrowserRouter, Route &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line">&lt;BrowserRouter&gt;</span><br><span class="line">    &lt;Route path=<span class="string">&quot;/a&quot;</span> component=&#123;A&#125; /&gt;</span><br><span class="line">    &lt;Route path=<span class="string">&quot;/a/d&quot;</span> exact component=&#123;D&#125;/&gt;  <span class="comment">// ç²¾ç¡®åŒ¹é…</span></span><br><span class="line">    &lt;Route component=&#123;C&#125; /&gt;</span><br><span class="line">    &lt;Route path=<span class="string">&#x27;/abc&#x27;</span> children=&#123;E&#125;/&gt;</span><br><span class="line">&lt;/BrowserRouter&gt;</span><br></pre></td></tr></table></figure><p>  ä¸Šè¿°ä»£ç ï¼Œå¦‚æœè·¯ç”±æ˜¯ <strong>/a/dï¼Œåˆ™ä¼šæ¸²æŸ“ Aã€Dã€Cã€E</strong>ï¼Œreact routeræ˜¯ä¼šä»ä¸Šè‡³ä¸‹å®Œå…¨åŒ¹é…ä¸€éï¼Œè€Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¼•å…¥äº†Switchç»„ä»¶ã€‚</p><h2 id="4-Switchç»„ä»¶"><a href="#4-Switchç»„ä»¶" class="headerlink" title="4. Switchç»„ä»¶"></a>4. Switchç»„ä»¶</h2><p>ä¼š<strong>å¾ªç¯æ‰€æœ‰å­å…ƒç´ </strong>ï¼Œå½“åŒ¹é…åˆ°ç¬¬ä¸€ä¸ªRouteåï¼Œä¼šç«‹å³åœæ­¢åŒ¹é…å¹¶æ¸²æŸ“ï¼Œå› æ­¤ä¸èƒ½åœ¨Switchç»„ä»¶çš„å­å…ƒç´ ä¸­ä½¿ç”¨é™¤Routeå¤–çš„å…¶ä»–ç»„ä»¶</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;Router&gt;</span><br><span class="line">    &lt;Switch&gt;</span><br><span class="line">        &lt;Route path=<span class="string">&quot;/a&quot;</span> component=&#123;A&#125; /&gt;</span><br><span class="line">        &lt;Route path=<span class="string">&quot;/a/b&quot;</span> component=&#123;B&#125; /&gt;</span><br><span class="line">        &lt;Route component=&#123;C&#125; /&gt;</span><br><span class="line">    &lt;/Switch&gt;</span><br><span class="line">&lt;/Router&gt;</span><br></pre></td></tr></table></figure><h2 id="5-Redirectç»„ä»¶"><a href="#5-Redirectç»„ä»¶" class="headerlink" title="5. Redirectç»„ä»¶"></a>5. Redirectç»„ä»¶</h2><p>ä¸€èˆ¬å†™åœ¨æ‰€æœ‰è·¯ç”±æ³¨å†Œçš„æœ€ä¸‹æ–¹ï¼Œå½“æ‰€æœ‰è·¯ç”±éƒ½æ— æ³•åŒ¹é…æ—¶ï¼Œè·³è½¬åˆ°RedirectæŒ‡å®šçš„è·¯ç”±</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Redirect to=<span class="string">&quot;/about/&quot;</span> /&gt;</span><br></pre></td></tr></table></figure><h2 id="6-è·¯ç”±ä¿¡æ¯"><a href="#6-è·¯ç”±ä¿¡æ¯" class="headerlink" title="6. è·¯ç”±ä¿¡æ¯"></a>6. è·¯ç”±ä¿¡æ¯</h2><p>Routerç»„ä»¶ä¼šåˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”å‘ä¸Šä¸‹æ–‡ä¸­æ³¨å…¥ä¸€äº›ä¿¡æ¯ï¼Œè¯¥ä¸Šä¸‹æ–‡å¯¹å¼€å‘è€…æ˜¯éšè—çš„ï¼ŒRouteç»„ä»¶è‹¥åŒ¹é…åˆ°äº†åœ°å€ï¼Œåˆ™ä¼šå°†è¿™äº›ä¸Šä¸‹æ–‡ä¸­çš„ä¿¡æ¯ä½œä¸ºå±æ€§ä¼ å…¥å¯¹åº”çš„ç»„ä»¶</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; BrowserRouter <span class="keyword">as</span> Router, Route, Switch &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// a</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(props)</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç»„ä»¶A<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;Router&gt;</span><br><span class="line">            &lt;Switch&gt;</span><br><span class="line">                &lt;Route path=<span class="string">&quot;/a&quot;</span> component=&#123;A&#125; /&gt;</span><br><span class="line">            &lt;/Switch&gt;</span><br><span class="line">        &lt;/Router&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰“å°ä¸€ä¸‹props</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">history</span>:</span><br><span class="line">go: Æ’ go(n)</span><br><span class="line">goBack: Æ’ goBack()</span><br><span class="line">goForward: Æ’ goForward()</span><br><span class="line">push: Æ’ push(path, state)</span><br><span class="line">replace: Æ’ replace(path, state)</span><br><span class="line">location:</span><br><span class="line">    <span class="built_in">hash</span>ï¼šé¡µé¢<span class="built_in">hash</span></span><br><span class="line">    pathnameï¼šé¡µé¢çš„path</span><br><span class="line">    stateï¼špushæ—¶ä¼ å…¥çš„æ•°æ®</span><br><span class="line">    searchï¼šä¼ å…¥çš„å‚æ•°</span><br><span class="line">match:</span><br><span class="line">isExactï¼šäº‹å®ä¸Šï¼Œå½“å‰çš„è·¯å¾„å’Œè·¯ç”±é…ç½®çš„è·¯å¾„æ˜¯å¦æ˜¯ç²¾ç¡®åŒ¹é…çš„</span><br><span class="line">paramsï¼šè·å–è·¯å¾„ä¸­å¯¹åº”çš„æ•°æ®</span><br><span class="line">pathï¼šè·¯å¾„è§„åˆ™</span><br><span class="line">urlï¼šé¡µé¢è·¯å¾„</span><br></pre></td></tr></table></figure><h2 id="7-è·¯ç”±ä¼ å‚"><a href="#7-è·¯ç”±ä¼ å‚" class="headerlink" title="7.è·¯ç”±ä¼ å‚"></a>7.è·¯ç”±ä¼ å‚</h2><h3 id="5-1-params-å‚æ•°"><a href="#5-1-params-å‚æ•°" class="headerlink" title="5.1 params å‚æ•°"></a>5.1 params å‚æ•°</h3><p>è·¯ç”±é“¾æ¥(æºå¸¦å‚æ•°)ï¼š<code>&lt;Link to=&#39;/demo/test/tom/18&#39;&#125;&gt;è¯¦æƒ…&lt;/Link&gt;</code><br>æ³¨å†Œè·¯ç”±(å£°æ˜æ¥æ”¶)ï¼š<code>&lt;Route path=&quot;/demo/test/:name/:age&quot; component=&#123;Test&#125;/&gt;</code><br>æ¥æ”¶å‚æ•°ï¼šthis.props.match.params</p><h3 id="5-2-searchå‚æ•°"><a href="#5-2-searchå‚æ•°" class="headerlink" title="5.2 searchå‚æ•°"></a>5.2 searchå‚æ•°</h3><p>è·¯ç”±é“¾æ¥(æºå¸¦å‚æ•°)ï¼š<code>&lt;Link to=&#39;/demo/test?name=tom&amp;age=18&#39;&#125;&gt;è¯¦æƒ…&lt;/Link&gt;</code><br>æ³¨å†Œè·¯ç”±(æ— éœ€å£°æ˜ï¼Œæ­£å¸¸æ³¨å†Œå³å¯)ï¼š<code>&lt;Route path=&quot;/demo/test&quot; component=&#123;Test&#125;/&gt;</code><br>æ¥æ”¶å‚æ•°ï¼š<code>this.props.location.search</code><br>å¤‡æ³¨ï¼šè·å–åˆ°çš„searchæ˜¯urlencodedç¼–ç å­—ç¬¦ä¸²ï¼Œéœ€è¦å€ŸåŠ©querystringè§£æ</p><h3 id="5-3-stateå‚æ•°"><a href="#5-3-stateå‚æ•°" class="headerlink" title="5.3 stateå‚æ•°"></a>5.3 stateå‚æ•°</h3><p>è·¯ç”±é“¾æ¥(æºå¸¦å‚æ•°)ï¼š<code>&lt;Link to=&#123;&#123;pathname:'/demo/test',state:&#123;name:'tom',age:18&#125;&#125;&#125;&gt;è¯¦æƒ…&lt;/Link&gt;</code><br>æ³¨å†Œè·¯ç”±(æ— éœ€å£°æ˜ï¼Œæ­£å¸¸æ³¨å†Œå³å¯)ï¼š<code>&lt;Route path=&quot;/demo/test&quot; component=&#123;Test&#125;/&gt;</code><br>æ¥æ”¶å‚æ•°ï¼š<code>this.props.location.state</code><br>å¤‡æ³¨ï¼šåˆ·æ–°ä¹Ÿå¯ä»¥ä¿ç•™ä½å‚æ•°</p><h2 id="8-ç¼–ç¨‹å¼å¯¼èˆª"><a href="#8-ç¼–ç¨‹å¼å¯¼èˆª" class="headerlink" title="8. ç¼–ç¨‹å¼å¯¼èˆª"></a>8. ç¼–ç¨‹å¼å¯¼èˆª</h2><p>å€ŸåŠ©<code>this.props.history</code>ä¸Šçš„æ–¹æ³•ï¼ŒåŸºæœ¬å’ŒH5çš„historyä¸€è‡´ï¼Œå°±åªæ˜¯åˆ—ä¸€ä¸‹äº†</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.props.history.push()</span><br><span class="line"><span class="built_in">this</span>.props.history.replace()</span><br><span class="line"><span class="built_in">this</span>.props.history.goBack()</span><br><span class="line"><span class="built_in">this</span>.props.history.goForward()</span><br><span class="line"><span class="built_in">this</span>.props.history.go()</span><br></pre></td></tr></table></figure><h2 id="9-withRouter"><a href="#9-withRouter" class="headerlink" title="9. withRouter"></a>9. withRouter</h2><blockquote><p>ç”±äº<strong>åªèƒ½åœ¨è·³è½¬çš„ç»„ä»¶ä¸­è·å–è·¯ç”±ä¿¡æ¯</strong>ï¼Œæ‰€ä»¥æå‡º<code>withRouter</code>ï¼Œç”¨withRouteråŒ…è£¹çš„ç»„ä»¶èƒ½è·å–è·¯ç”±ä¿¡æ¯</p></blockquote><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ButtonContainer</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> history = props.history;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div className=&#123;<span class="string">&quot;container&quot;</span>&#125;&gt;</span><br><span class="line">            &lt;button onClick=&#123;<span class="function">() =&gt;</span> &#123;history.push(<span class="string">&quot;/a?key=a&quot;</span>, <span class="string">&quot;AçŠ¶æ€æ•°æ®&quot;</span>)&#125;&#125;&gt;A&lt;/button&gt;</span><br><span class="line">            &lt;button onClick=&#123;<span class="function">() =&gt;</span> &#123;history.push(<span class="string">&quot;/a/b?key=b&quot;</span>, <span class="string">&quot;BçŠ¶æ€æ•°æ®&quot;</span>)&#125;&#125;&gt;B&lt;/button&gt;</span><br><span class="line">            &lt;button onClick=&#123;<span class="function">() =&gt;</span> &#123;history.push(<span class="string">&quot;/a/c?key=c&quot;</span>, <span class="string">&quot;CçŠ¶æ€æ•°æ®&quot;</span>)&#125;&#125;&gt;C&lt;/button&gt;</span><br><span class="line">            &lt;button onClick=&#123;<span class="function">() =&gt;</span> &#123;history.push(<span class="string">&quot;/a/d?key=d&quot;</span>, <span class="string">&quot;DçŠ¶æ€æ•°æ®&quot;</span>)&#125;&#125;&gt;D&lt;/button&gt;</span><br><span class="line">            &lt;button onClick=&#123;<span class="function">() =&gt;</span> &#123;history.push(<span class="string">&quot;/a/news/2020/12/21&quot;</span>)&#125;&#125;&gt;News&lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> WithRouterButtonContainer = withRouter(ButtonContainer)</span><br></pre></td></tr></table></figure><p>å…¶è¿”å›å€¼æ˜¯ä¸€ä¸ªæ–°ç»„ä»¶</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://blog.sakura-snow.com/post/react-node-5/">reactå­¦ä¹ ç¬”è®°5-React Router</a><br>[React Router ä½¿ç”¨æ•™ç¨‹](</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;react-routerï¼šè·¯ç”±æ ¸å¿ƒåº“ï¼ŒåŒ…å«è¯¸å¤šå’Œè·¯ç”±åŠŸèƒ½ç›¸å…³çš„æ ¸å¿ƒä»£ç &lt;/li&gt;
&lt;li&gt;react-router-domï¼šåˆ©ç”¨è·¯ç”±æ ¸å¿ƒåº“ï¼Œç»“åˆå®é™…çš„é¡µé¢ï¼Œå®ç°è·Ÿé¡µé¢è·¯ç”±å¯†åˆ‡ç›¸å…³çš„åŠŸèƒ½&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;å®‰è£…&quot;&gt;&lt;a href=&quot;#å®‰è£…&quot; c
      
    
    </summary>
    
    
      <category term="å‰ç«¯" scheme="https://liang5757.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="React" scheme="https://liang5757.github.io/tags/React/"/>
    
  </entry>
  
  <entry>
    <title>Reactä»å…¥é—¨åˆ°çœŸé¦™</title>
    <link href="https://liang5757.github.io/2021/05/27/React/React%E5%85%A5%E9%97%A8/"/>
    <id>https://liang5757.github.io/2021/05/27/React/React%E5%85%A5%E9%97%A8/</id>
    <published>2021-05-27T15:41:33.000Z</published>
    <updated>2021-06-08T14:38:26.861Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-è®¾è®¡æ€æƒ³"><a href="#1-è®¾è®¡æ€æƒ³" class="headerlink" title="1. è®¾è®¡æ€æƒ³"></a>1. è®¾è®¡æ€æƒ³</h2><ol><li><a href="https://github.com/react-guide/react-basic">React è®¾è®¡æ€æƒ³</a></li><li><a href="http://www.infoq.com/cn/articles/react-art-of-simplity/">Reactçš„è®¾è®¡å“²å­¦ - ç®€å•ä¹‹ç¾</a></li><li><a href="http://www.infoq.com/cn/articles/subversion-front-end-ui-development-framework-react/">é¢ è¦†å¼å‰ç«¯UIå¼€å‘æ¡†æ¶:React</a></li></ol><h2 id="2-å®‰è£…"><a href="#2-å®‰è£…" class="headerlink" title="2. å®‰è£…"></a>2. å®‰è£…</h2><h3 id="2-1-CDNçš„æ–¹å¼å¼•å…¥"><a href="#2-1-CDNçš„æ–¹å¼å¼•å…¥" class="headerlink" title="2.1 CDNçš„æ–¹å¼å¼•å…¥"></a>2.1 CDNçš„æ–¹å¼å¼•å…¥</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react@17/umd/react.development.js&quot;</span> <span class="attr">crossorigin</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react-dom@17/umd/react-dom.development.js&quot;</span> <span class="attr">crossorigin</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/babel-standalone@6/babel.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>react.jsï¼šReactæ ¸å¿ƒåº“</li><li>react-dom.jsï¼šæä¾›æ“ä½œ DOM çš„ react æ‰©å±•åº“</li><li>babel.min.jsï¼šè§£æ JSX è¯­æ³•ä»£ç è½¬ä¸º JS ä»£ç çš„åº“</li></ul><h3 id="2-2-create-react-app"><a href="#2-2-create-react-app" class="headerlink" title="2.2 create-react-app"></a>2.2 create-react-app</h3><p>å®‰è£…<code>create-react-app</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm isntall -g create-react-app</span><br></pre></td></tr></table></figure><p>åˆ›å»ºé¡¹ç›®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create-react-app my-app</span><br></pre></td></tr></table></figure><h2 id="3-JSX"><a href="#3-JSX" class="headerlink" title="3. JSX"></a>3. JSX</h2><p>jsx å…è®¸åœ¨æ¨¡æ¿ä¸­ç”¨<code>&#123;&#125;</code>æ’å…¥JavaScriptè¡¨è¾¾å¼ï¼Œå¦‚æœ<code>&#123;&#125;</code>ä¸­çš„å˜é‡æ˜¯æ•°ç»„ï¼Œåˆ™ä¼šå±•å¼€è¿™ä¸ªæ•°ç»„çš„æ‰€æœ‰æˆå‘˜</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [</span><br><span class="line">  &lt;h1&gt;Hello world!&lt;/h1&gt;,</span><br><span class="line">  &lt;h2&gt;React is awesome&lt;/h2&gt;,</span><br><span class="line">];</span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;div&gt;&#123;arr&#125;&lt;/div&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">&#x27;example&#x27;</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> names = [<span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;Emily&#x27;</span>, <span class="string">&#x27;Kate&#x27;</span>];</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">  &#123;</span><br><span class="line">    names.map(<span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123; <span class="comment">// åˆ—è¡¨æ¸²æŸ“</span></span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello, &#123;name&#125;!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  &lt;/div&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">&#x27;example2&#x27;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><code>ReactDOM.render</code>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¸²æŸ“çš„ç»„ä»¶ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æŒ‚è½½å®ä¾‹çš„ä½ç½®ã€‚</p><ul><li>classNameæ›¿æ¢class</li><li>å†…è”æ ·å¼â€”â€”style=</li><li>åªèƒ½å«æœ‰ä¸€ä¸ªæœ€å¤–å±‚æ ‡ç­¾</li></ul><p>å¯¹äºæœ€åä¸€ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨React.Fragmentç»„ä»¶ï¼Œå®ƒèƒ½å¤Ÿåœ¨ä¸é¢å¤–åˆ›å»º DOM å…ƒç´ çš„æƒ…å†µä¸‹ï¼Œè®©renderè¿”å›å¤šä¸ªå…ƒç´ </p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;React.Fragment&gt;</span><br><span class="line">      Some text.</span><br><span class="line">      &lt;h2&gt;A heading&lt;/h2&gt;</span><br><span class="line">    &lt;/React.Fragment&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-ç»„ä»¶"><a href="#4-ç»„ä»¶" class="headerlink" title="4.ç»„ä»¶"></a>4.ç»„ä»¶</h2><h3 id="4-1-ç±»ç»„ä»¶ï¼ˆæœ‰çŠ¶æ€ï¼‰"><a href="#4-1-ç±»ç»„ä»¶ï¼ˆæœ‰çŠ¶æ€ï¼‰" class="headerlink" title="4.1 ç±»ç»„ä»¶ï¼ˆæœ‰çŠ¶æ€ï¼‰"></a>4.1 ç±»ç»„ä»¶ï¼ˆæœ‰çŠ¶æ€ï¼‰</h3><blockquote><p>ç»„ä»¶ç±»çš„ç¬¬ä¸€ä¸ªåå­—å¿…é¡»å¤§å†™</p></blockquote><p>é€šè¿‡ç»§æ‰¿React.Componentæ¥å®ç°ç±»ç»„ä»¶ï¼Œéœ€è¦å®ç°ä¸€ä¸ªrenderæ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªæ¨¡æ¿</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Clock</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render () &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div onClick=&#123;<span class="built_in">this</span>.clickFunc.bind(<span class="built_in">this</span>)&#125;&gt; <span class="comment">// å°†clickFuncå†…éƒ¨thisæŒ‡å‘ç»„ä»¶å®ä¾‹</span></span><br><span class="line">                &lt;h1&gt;Hello, world!&lt;/h1&gt;</span><br><span class="line">                &lt;h2&gt;It is &#123;<span class="built_in">this</span>.props.date.toLocaleTimeString()&#125;&lt;/h2&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> é€šè¿‡React.createClassç”Ÿæˆä¸€ä¸ªç»„ä»¶ç±»</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Clock = React.createClass(&#123;</span><br><span class="line">    render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;h1&gt;Hello, world!&lt;/h1&gt;</span><br><span class="line">                &lt;h2&gt;It is &#123;<span class="built_in">this</span>.props.date.toLocaleTimeString()&#125;&lt;/h2&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸¤ç§æ–¹å¼çš„åŒºåˆ«æ˜¯ï¼Œå‰è€…ä¸ä¼šè‡ªåŠ¨ç»‘å®šthis</p><h3 id="4-2-å‡½æ•°å¼ç»„ä»¶ï¼ˆæ— çŠ¶æ€ï¼‰"><a href="#4-2-å‡½æ•°å¼ç»„ä»¶ï¼ˆæ— çŠ¶æ€ï¼‰" class="headerlink" title="4.2 å‡½æ•°å¼ç»„ä»¶ï¼ˆæ— çŠ¶æ€ï¼‰"></a>4.2 å‡½æ•°å¼ç»„ä»¶ï¼ˆæ— çŠ¶æ€ï¼‰</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;name, age, sex&#125; = props;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">            &lt;li&gt;å§“åï¼š&#123;name&#125;&lt;/li&gt;</span><br><span class="line">            &lt;li&gt;æ€§åˆ«ï¼š&#123;sex&#125;&lt;/li&gt;</span><br><span class="line">            &lt;li&gt;å¹´é¾„ï¼š&#123;age&#125;&lt;/li&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-State"><a href="#5-State" class="headerlink" title="5. State"></a>5. State</h2><h3 id="5-1-stateåˆå§‹åŒ–"><a href="#5-1-stateåˆå§‹åŒ–" class="headerlink" title="5.1 stateåˆå§‹åŒ–"></a>5.1 stateåˆå§‹åŒ–</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Clock</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ç¬¬ä¸€ç§ ç›´æ¥åœ¨å®ä¾‹ä¸Šå®šä¹‰stateå±æ€§</span></span><br><span class="line">  state = &#123;</span><br><span class="line">      value: <span class="number">6</span>,</span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// ç¬¬äºŒç§ åœ¨æ„é€ å™¨ä¸­è®¾ç½®state</span></span><br><span class="line">  <span class="title">constructor</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="built_in">this</span>.state = &#123;</span><br><span class="line">          value: <span class="number">6</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-2-stateä¿®æ”¹"><a href="#5-2-stateä¿®æ”¹" class="headerlink" title="5.2 stateä¿®æ”¹"></a>5.2 stateä¿®æ”¹</h3><p><strong>ç›´æ¥ä¿®æ”¹æ•°æ®æ˜¯ä¸ä¼šè§¦å‘è§†å›¾æ›´æ–°</strong>çš„ï¼Œåªæœ‰ä½¿ç”¨<code>setState</code>æ¥ä¿®æ”¹æ•°æ®ï¼Œä¼šé‡æ–°è§¦å‘ç»„ä»¶çš„renderå‡½æ•°</p><p>setStateç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ä¿®æ”¹åçš„stateå¯¹è±¡ï¼Œå¯ä»¥ä¿®æ”¹æŸä¸€ä¸ªå€¼ï¼Œ<strong>setStateæ˜¯æµ…åˆå¹¶</strong>ã€‚</p><p>å¦‚æœsetStateçš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡è€Œæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°åœ¨æ‰§è¡Œæ—¶ä¼šé€šè¿‡å‚æ•°è¢«ä¼ å…¥prevStateï¼Œä¹Ÿå°±æ˜¯ä¹‹å‰çš„çŠ¶æ€ï¼Œè€Œè¿”å›å€¼å°±ä¼šå’Œstateè¿›è¡Œåˆå¹¶</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.setState(<span class="function">(<span class="params">prevState : any</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        num : prevState.num + <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.state.num)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯setStateæœ‰ä¸¤ä¸ªé—®é¢˜</p><ul><li>setStateå¯¹çŠ¶æ€çš„ä¿®æ”¹ï¼Œå¯èƒ½æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼ˆå¦‚æœæ”¹å˜çŠ¶æ€çš„ä»£ç å¤„äºæŸä¸ªHTMLå…ƒç´ çš„äº‹ä»¶ä¸­ï¼Œåˆ™å…¶æ˜¯å¼‚æ­¥çš„ï¼Œå¦åˆ™æ˜¯åŒæ­¥ï¼‰</li><li>Reactä¼šå¯¹å¼‚æ­¥çš„setStateè¿›è¡Œä¼˜åŒ–ï¼Œå°†å¤šæ¬¡setStateè¿›è¡Œåˆå¹¶ï¼ˆå°†å¤šæ¬¡çŠ¶æ€æ”¹å˜å®Œæˆåï¼Œå†ç»Ÿä¸€å¯¹stateè¿›è¡Œæ”¹å˜ï¼Œç„¶åè§¦å‘renderï¼‰</li></ul><p>ä¸‹é¢ç»™å‡ºç¬¬ä¸€ä¸ªé—®é¢˜çš„ä¾‹å­</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Comp</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123;</span><br><span class="line">        num: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.setState(&#123;</span><br><span class="line">            num: <span class="built_in">this</span>.state.num + <span class="number">1</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">this</span>.state.num) <span class="comment">// ç¬¬ä¸€ä¸‹ç‚¹å‡»è¾“å‡º 0</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render () &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;React.Fragment&gt;</span><br><span class="line">                &lt;p&gt;&#123;<span class="built_in">this</span>.state.num&#125;&lt;/p&gt;</span><br><span class="line">                &lt;button onClick=&#123;<span class="built_in">this</span>.handleClick&#125;&gt;ç‚¹æˆ‘&lt;/button&gt;</span><br><span class="line">            &lt;/React.Fragment&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ç¬¬ä¸€ä¸‹ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™ï¼Œconsole.logè¾“å‡º 0ï¼Œè¯´æ˜setStateåœ¨DOMäº‹ä»¶ä¸­æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ã€‚</p><p><strong>è§£å†³æ–¹å¼</strong>ï¼šsetStateæœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ¥æ”¾ç½®renderæ‰§è¡Œåæ¥ç€æ‰§è¡Œçš„å›è°ƒå‡½æ•°</p><h2 id="6-Props"><a href="#6-Props" class="headerlink" title="6. Props"></a>6. Props</h2><h3 id="6-1-ä¼ é€’å‚æ•°"><a href="#6-1-ä¼ é€’å‚æ•°" class="headerlink" title="6.1 ä¼ é€’å‚æ•°"></a>6.1 ä¼ é€’å‚æ•°</h3><p>çˆ¶ç»„ä»¶åœ¨ä½¿ç”¨å­ç»„ä»¶çš„æ—¶å€™ï¼Œé€šè¿‡ç»™å­ç»„ä»¶å…ƒç´ è®¾ç½®å±æ€§çš„æ–¹å¼ä¼ é€’å‚æ•°ç»™å­ç»„ä»¶</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// çˆ¶ç»„ä»¶è®¾ç½®å±æ€§ç»™å­ç»„ä»¶ä¼ å‚ï¼Œè¿™é‡Œå±æ€§åç”¨value2ç”¨ä½œåŒºåˆ†</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Board</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render () &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;Square value2=&#123;<span class="number">0</span>&#125;/&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç±»ç»„ä»¶ é€šè¿‡ this.props.[å±æ€§] æ¥è·å–å‚æ•°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Square</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;button className=<span class="string">&quot;square&quot;</span>&gt;</span><br><span class="line">                &#123;<span class="built_in">this</span>.props.value2&#125;</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å¼ç»„ä»¶é€šè¿‡ props.[å±æ€§] æ¥è·å–å‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Square</span> (<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;button className=<span class="string">&quot;square&quot;</span>&gt;</span><br><span class="line">            &#123;props.value2&#125;</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-2-propsä¼ é€’äº‹ä»¶"><a href="#6-2-propsä¼ é€’äº‹ä»¶" class="headerlink" title="6.2 propsä¼ é€’äº‹ä»¶"></a>6.2 propsä¼ é€’äº‹ä»¶</h3><p>é€šè¿‡this.props.[äº‹ä»¶å]è°ƒç”¨</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Board</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render () &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;Square click=&#123;<span class="function">() =&gt;</span> &#123;alert(<span class="string">&quot;click event&quot;</span>)&#125;&#125;/&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Square</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;button onClick=&#123;<span class="built_in">this</span>.props.click&#125; className=<span class="string">&quot;square&quot;</span>&gt;</span><br><span class="line">              button</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-3-propsæ ¡éªŒ"><a href="#6-3-propsæ ¡éªŒ" class="headerlink" title="6.3 propsæ ¡éªŒ"></a>6.3 propsæ ¡éªŒ</h3><p>1.éœ€è¦å¼•å…¥ä¸€ä¸ªåº“prop-types.js</p><ul><li>cdn</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/prop-types@15.6/prop-types.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>npm</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save prop-types </span><br></pre></td></tr></table></figure><p>2.ä½¿ç”¨æ–¹å¼</p><p>åœ¨ç»„ä»¶ä¸Šå®šä¹‰ PropTypeså¯¹è±¡ï¼Œé”®å°±æ˜¯propsçš„åï¼Œå€¼å°±æ˜¯é™åˆ¶ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Square</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="comment">// ... do things with the props</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–¹å¼ä¸€</span></span><br><span class="line">    <span class="keyword">static</span> propTypes = &#123;</span><br><span class="line">        value1: PropTypes.number.isRequired,</span><br><span class="line">        value2: PropTypes.string</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‡å®špropsé»˜è®¤å€¼</span></span><br><span class="line"><span class="keyword">static</span> defaultProps = &#123;</span><br><span class="line">        value1: <span class="number">666</span>,</span><br><span class="line">        value2: <span class="string">&quot;6&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹å¼äºŒ</span></span><br><span class="line">Square.propTypes = &#123;</span><br><span class="line">    value1: PropTypes.number.isRequired,</span><br><span class="line">    value2: PropTypes.string</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ›´å¤šä½¿ç”¨æ–¹å¼å‚è€ƒï¼š<a href="https://github.com/facebook/prop-types">https://github.com/facebook/prop-types</a></p><h3 id="6-4-this-props-children"><a href="#6-4-this-props-children" class="headerlink" title="6.4 this.props.children"></a>6.4 this.props.children</h3><blockquote><p>è·å–ç»„ä»¶æ‰€æœ‰å­èŠ‚ç‚¹</p></blockquote><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NotesList</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;ol&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    React.Children.map(<span class="built_in">this</span>.props.children, <span class="function"><span class="keyword">function</span> (<span class="params">child</span>) </span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;child&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>;</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &lt;/ol&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">    &lt;NotesList&gt;</span><br><span class="line">        &lt;span&gt;hello&lt;/span&gt;</span><br><span class="line">        &lt;span&gt;world&lt;/span&gt;</span><br><span class="line">    &lt;/NotesList&gt;,</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">&#x27;example&#x27;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>æ²¡æœ‰å­èŠ‚ç‚¹ï¼šundefined</li><li>ä¸€ä¸ªå­èŠ‚ç‚¹ï¼šobject</li><li>å¤šä¸ªå­èŠ‚ç‚¹ï¼šarray</li></ul><p>å¯ä»¥ç”¨<code>React.Children.map</code>æ¥éå†å­èŠ‚ç‚¹ï¼Œåˆ™ä¸éœ€è¦æ‹…å¿ƒå­å…ƒç´ ä¸ªæ•°</p><h3 id="6-5-propsä¼ é€’ç»„ä»¶"><a href="#6-5-propsä¼ é€’ç»„ä»¶" class="headerlink" title="6.5 propsä¼ é€’ç»„ä»¶"></a>6.5 propsä¼ é€’ç»„ä»¶</h3><p>Reactç»„ä»¶æœ¬è´¨å°±æ˜¯å¯¹è±¡ï¼Œå½“ä½œpropsåƒå…¶ä»–æ•°æ®ä¸€æ ·ä¼ é€’ä¹Ÿæ˜¯å¯ä»¥çš„</p><h2 id="7-Reactç”Ÿå‘½å‘¨æœŸ"><a href="#7-Reactç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="7. Reactç”Ÿå‘½å‘¨æœŸ"></a>7. Reactç”Ÿå‘½å‘¨æœŸ</h2><blockquote><p>æ„Ÿè§‰å’Œvueå·®ä¸å¤šï¼Œç›´æ¥ç®€å•å¸¦è¿‡æŠŠ</p></blockquote><h4 id="componentWillMount"><a href="#componentWillMount" class="headerlink" title="componentWillMount()"></a>componentWillMount()</h4><p>ç»„ä»¶å³å°†è¢«æ¸²æŸ“åˆ°é¡µé¢ä¹‹å‰è§¦å‘ï¼Œæ­¤æ—¶å¯ä»¥è¿›è¡Œå¼€å¯å®šæ—¶å™¨ã€å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ç­‰æ“ä½œ</p><h4 id="componentDidMount"><a href="#componentDidMount" class="headerlink" title="componentDidMount()"></a>componentDidMount()</h4><p>ç»„ä»¶å·²ç»è¢«æ¸²æŸ“åˆ°é¡µé¢ä¸­åè§¦å‘ï¼Œå¯ä»¥é€šè¿‡<code>this.getDOMNode()</code>æ¥è¿›è¡Œè®¿é—®DOMã€‚</p><h4 id="componentWillReceiveProps"><a href="#componentWillReceiveProps" class="headerlink" title="componentWillReceiveProps()"></a>componentWillReceiveProps()</h4><p>åœ¨ç»„ä»¶æ¥æ”¶åˆ°ä¸€ä¸ªæ–°çš„ prop (æ›´æ–°å)æ—¶è¢«è°ƒç”¨ã€‚è¿™ä¸ªæ–¹æ³•åœ¨åˆå§‹åŒ–<code>render</code>æ—¶ä¸ä¼šè¢«è°ƒç”¨ã€‚</p><h4 id="shouldComponentUpdate"><a href="#shouldComponentUpdate" class="headerlink" title="shouldComponentUpdate()"></a>shouldComponentUpdate()</h4><p>è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚åœ¨ç»„ä»¶æ¥æ”¶åˆ°æ–°çš„<code>props</code>æˆ–è€…<code>state</code>æ—¶è¢«è°ƒç”¨ã€‚åœ¨åˆå§‹åŒ–æ—¶æˆ–è€…ä½¿ç”¨<code>forceUpdate</code>æ—¶ä¸è¢«è°ƒç”¨ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¯¥é’©å­å‡½æ•°å¯ä»¥æ¥æ”¶åˆ°ä¸¤ä¸ªå‚æ•°ï¼Œæ–°çš„å±æ€§å’ŒçŠ¶æ€ï¼Œè¿”å›true/falseæ¥æ§åˆ¶ç»„ä»¶æ˜¯å¦éœ€è¦æ›´æ–°ã€‚</span></span><br><span class="line"><span class="function"><span class="title">shouldComponentUpdate</span>(<span class="params">newProps, newState</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (newProps.number &lt; <span class="number">5</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸€ä¸ªReacté¡¹ç›®éœ€è¦æ›´æ–°ä¸€ä¸ªå°ç»„ä»¶æ—¶ï¼Œå¾ˆå¯èƒ½éœ€è¦çˆ¶ç»„ä»¶æ›´æ–°è‡ªå·±çš„çŠ¶æ€ã€‚è€Œä¸€ä¸ª<strong>çˆ¶ç»„ä»¶çš„é‡æ–°æ›´æ–°ä¼šé€ æˆå®ƒæ——ä¸‹æ‰€æœ‰çš„å­ç»„ä»¶é‡æ–°æ‰§è¡Œrender()æ–¹æ³•ï¼ˆå³ä½¿æ²¡æœ‰ä½¿ç”¨çˆ¶ç»„ä»¶çš„stateï¼‰</strong>ï¼Œå½¢æˆæ–°çš„è™šæ‹ŸDOMï¼Œå†ç”¨diffç®—æ³•å¯¹æ–°æ—§è™šæ‹ŸDOMè¿›è¡Œç»“æ„å’Œå±æ€§çš„æ¯”è¾ƒï¼Œå†³å®šç»„ä»¶æ˜¯å¦éœ€è¦é‡æ–°æ¸²æŸ“ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä¸‹é¢è¯´äº†PureComponent</p></blockquote><h4 id="componentWillUpdate"><a href="#componentWillUpdate" class="headerlink" title="componentWillUpdate()"></a>componentWillUpdate()</h4><p>åœ¨ç»„ä»¶æ¥æ”¶åˆ°æ–°çš„<code>props</code>æˆ–è€…<code>state</code>ä½†è¿˜æ²¡æœ‰<code>render</code>æ—¶è¢«è°ƒç”¨ã€‚åœ¨åˆå§‹åŒ–æ—¶ä¸ä¼šè¢«è°ƒç”¨ã€‚</p><h4 id="componentDidUpdate"><a href="#componentDidUpdate" class="headerlink" title="componentDidUpdate()"></a>componentDidUpdate()</h4><p>åœ¨ç»„ä»¶å®Œæˆæ›´æ–°åç«‹å³è°ƒç”¨ã€‚åœ¨åˆå§‹åŒ–æ—¶ä¸ä¼šè¢«è°ƒç”¨ã€‚</p><h4 id="componentWillUnMount"><a href="#componentWillUnMount" class="headerlink" title="componentWillUnMount()"></a>componentWillUnMount()</h4><p>ç»„ä»¶è¢«é”€æ¯æ—¶è§¦å‘ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œä¸€äº›æ¸…ç†æ“ä½œï¼Œä¾‹å¦‚æ¸…ç†å®šæ—¶å™¨ï¼Œå–æ¶ˆReduxçš„è®¢é˜…äº‹ä»¶ç­‰ç­‰ã€‚</p><h4 id="getDerivedStateFromError"><a href="#getDerivedStateFromError" class="headerlink" title="getDerivedStateFromError()"></a>getDerivedStateFromError()</h4><p>è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•åœ¨<strong>ErrorBoundary</strong>ç±»ä¸­ä½¿ç”¨ã€‚å®é™…ä¸Šï¼Œå¦‚æœä½¿ç”¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œä»»ä½•ç±»éƒ½ä¼šå˜æˆ<code>ErrorBoundary</code>ã€‚è¿™ç”¨äºåœ¨ç»„ä»¶æ ‘ä¸­å‡ºç°é”™è¯¯æ—¶å‘ˆç°å›é€€UIï¼Œè€Œä¸æ˜¯åœ¨å±å¹•ä¸Šæ˜¾ç¤ºä¸€äº›å¥‡æ€ªçš„é”™è¯¯ã€‚</p><h4 id="componentDidCatch"><a href="#componentDidCatch" class="headerlink" title="componentDidCatch()"></a>componentDidCatch()</h4><p>è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•åœ¨<strong>ErrorBoundary</strong>ç±»ä¸­ä½¿ç”¨ã€‚å®é™…ä¸Šï¼Œå¦‚æœä½¿ç”¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œä»»ä½•ç±»éƒ½ä¼šå˜æˆ<code>ErrorBoundary</code>ã€‚è¿™ç”¨äºåœ¨ç»„ä»¶æ ‘ä¸­å‡ºç°é”™è¯¯æ—¶è®°å½•é”™è¯¯ã€‚</p><h2 id="8-Ref"><a href="#8-Ref" class="headerlink" title="8. Ref"></a>8. Ref</h2><p>ç”¨æ¥è®¿é—®DOMå…ƒç´ æˆ–renderä¸­çš„reactå…ƒç´ ï¼ŒRefçš„ä½¿ç”¨è§„åˆ™å¦‚ä¸‹</p><ol><li>refä½œç”¨äºå†…ç½®çš„htmlç»„ä»¶æ—¶ï¼Œå¾—åˆ°çš„å°†æ˜¯çœŸå®çš„domå¯¹è±¡</li><li>refä½œç”¨äºç±»ç»„ä»¶æ—¶ï¼Œå¾—åˆ°çš„å°†æ˜¯ç±»çš„å®ä¾‹</li><li>refä¸èƒ½ä½œç”¨äºå‡½æ•°ç»„ä»¶ï¼ˆå› ä¸ºæ²¡æœ‰å®ä¾‹ï¼‰ï¼Œä½†æ˜¯å‡½æ•°ç»„ä»¶å†…éƒ¨å¯ä»¥</li></ol><h3 id="8-1-åˆ›å»ºref"><a href="#8-1-åˆ›å»ºref" class="headerlink" title="8.1 åˆ›å»ºref"></a>8.1 åˆ›å»ºref</h3><p>refçš„å¯é€‰å€¼ä¸º</p><ol><li><p>å­—ç¬¦ä¸²ï¼ˆä¸å»ºè®®ï¼‰</p><p> åŸå› ï¼š<a href="http://www.qiutianaimeili.com/html/page/2020/04/20204277uz3udr631a.html">react refæ³¨æ„äº‹é¡¹</a></p></li><li><p>å›è°ƒå‡½æ•°</p><p> è§¦å‘æ—¶æœºï¼šrefä¸­çš„å›è°ƒå‡½æ•°ä¼šåœ¨å¯¹åº”çš„<strong>æ™®é€š</strong>ç»„ä»¶ï¼ˆæˆ–å…ƒç´ ï¼‰<code>componentDidMount</code>ï¼Œ<code>ComponentDidUpdate</code>ä¹‹å‰ï¼Œæˆ–è€…<code>componentWillUnmount</code>ä¹‹åæ‰§è¡Œ</p><p> <strong>æ³¨æ„ï¼š</strong>å¦‚æœ <code>ref</code> å›è°ƒå‡½æ•°æ˜¯ä»¥<strong>å†…è”å‡½æ•°çš„æ–¹å¼å®šä¹‰</strong>çš„ï¼Œåœ¨æ›´æ–°è¿‡ç¨‹ä¸­å®ƒä¼šè¢«<strong>æ‰§è¡Œä¸¤æ¬¡</strong>ï¼Œç¬¬ä¸€æ¬¡ä¼ å…¥å‚æ•° <code>null</code>ï¼Œç„¶åç¬¬äºŒæ¬¡ä¼šä¼ å…¥å‚æ•° DOM å…ƒç´ ã€‚è¿™æ˜¯å› ä¸ºåœ¨<strong>æ¯æ¬¡æ¸²æŸ“æ—¶ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°å®ä¾‹</strong>ï¼Œæ‰€ä»¥ React æ¸…ç©ºæ—§çš„ ref å¹¶ä¸”è®¾ç½®æ–°çš„</p></li><li><p>createRef</p></li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">props</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(props);</span><br><span class="line">        <span class="built_in">this</span>.textInput = React.createRef();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">focusTextInput</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="comment">// æ³¨æ„ï¼šæˆ‘ä»¬é€šè¿‡ &quot;current&quot; æ¥è®¿é—® DOM èŠ‚ç‚¹</span></span><br><span class="line">        <span class="built_in">this</span>.textInput.current.focus();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;React.Fragment&gt;</span><br><span class="line">                &lt;input type=<span class="string">&quot;text&quot;</span> ref=&#123;<span class="built_in">this</span>.textInput&#125; /&gt;</span><br><span class="line">                &lt;input type=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;Focus the text input&quot;</span> onClick=&#123;<span class="built_in">this</span>.focusTextInput.bind(<span class="built_in">this</span>)&#125;/&gt;</span><br><span class="line">            &lt;/React.Fragment&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8-2-è½¬å‘ref"><a href="#8-2-è½¬å‘ref" class="headerlink" title="8.2 è½¬å‘ref"></a>8.2 è½¬å‘ref</h3><blockquote><p>ç”¨äºè·å–ç»„ä»¶å†…éƒ¨çš„æŸä¸ªå…ƒç´ ï¼Œæœ‰äº›é«˜åº¦å¤ç”¨çš„åŸºç¡€ç»„ä»¶ä¸å¯é¿å…çš„éœ€è¦åœ¨çˆ¶ç»„ä»¶è·å–ï¼Œç”¨ä»¥ç®¡ç†ç„¦ç‚¹ç­‰</p></blockquote><p><code>React.forwardRef</code>ç”¨ä»¥è·å–ä¼ é€’ç»™å®ƒçš„<code>ref</code>ï¼Œç„¶åè½¬å‘åˆ°æ¸²æŸ“å®ƒçš„DOMã€‚</p><p>å¯¹äº<strong>å‡½æ•°å¼ç»„ä»¶</strong>ï¼Œ<code>React.forwardRef</code>ç›´æ¥åŒ…è£¹å‡½æ•°å°±å¯ä»¥æ¥æ”¶åˆ°ref</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> FancyButton = React.forwardRef(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> (</span><br><span class="line">  &lt;button ref=&#123;ref&#125; className=<span class="string">&quot;FancyButton&quot;</span>&gt;</span><br><span class="line">    &#123;props.children&#125;</span><br><span class="line">  &lt;/button&gt;</span><br><span class="line">));</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ å¯ä»¥ç›´æ¥è·å– DOM button çš„ refï¼š</span></span><br><span class="line"><span class="keyword">const</span> ref = React.createRef();</span><br><span class="line">&lt;FancyButton ref=&#123;ref&#125;&gt;Click me!&lt;/FancyButton&gt;;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>FancyButton</code> çš„ç»„ä»¶å¯ä»¥è·å–åº•å±‚ DOM èŠ‚ç‚¹ <code>button</code> çš„ ref </p><p>è€Œå¯¹äº<strong>ç±»ç»„ä»¶</strong>ï¼Œéœ€è¦ä½¿ç”¨HOCçš„å½¢å¼ï¼Œç”¨<code>React.forwardRef</code>åŒ…è£¹è¿”å›çš„å‡½æ•°å¼ç»„ä»¶</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logProps</span>(<span class="params">Component</span>) </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">LogProps</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123;forwardedRef, ...rest&#125; = <span class="built_in">this</span>.props;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å°†è‡ªå®šä¹‰çš„ prop å±æ€§ â€œforwardedRefâ€ å®šä¹‰ä¸º ref</span></span><br><span class="line">            <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;forwardedRef&#125;</span> &#123;<span class="attr">...rest</span>&#125; /&gt;</span></span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ³¨æ„ React.forwardRef å›è°ƒçš„ç¬¬äºŒä¸ªå‚æ•° â€œrefâ€ã€‚</span></span><br><span class="line">    <span class="comment">// æˆ‘ä»¬å¯ä»¥å°†å…¶ä½œä¸ºå¸¸è§„ prop å±æ€§ä¼ é€’ç»™ LogPropsï¼Œä¾‹å¦‚ â€œforwardedRefâ€</span></span><br><span class="line">    <span class="comment">// ç„¶åå®ƒå°±å¯ä»¥è¢«æŒ‚è½½åˆ°è¢« LogProps åŒ…è£¹çš„å­ç»„ä»¶ä¸Šã€‚</span></span><br><span class="line">    <span class="keyword">return</span> React.forwardRef(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">LogProps</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">forwardedRef</span>=<span class="string">&#123;ref&#125;</span> /&gt;</span></span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨<code>React.forwardRef</code>åŒ…è£¹çš„ç»„ä»¶åœ¨<strong>DevToolsä¸­æ˜¾ç¤ºä¸ºâ€ForwardRefâ€</strong>ï¼Œå¯ä»¥æŠŠåŒ…è£¹çš„å‡½æ•°ç”¨æ™®é€šå‡½æ•°çš„å½¢å¼å‘½åï¼ŒDevToolsä¹Ÿå°†åŒ…å«å…¶åç§°ï¼ˆä¾‹å¦‚ â€œ<em>ForwardRef(myFunction)</em>â€ï¼‰ï¼Œä¹Ÿå¯ä»¥<strong>è®¾ç½®å‡½æ•°çš„displayNameå±æ€§</strong>æ¥è®¾ç½®DevToolsä¸­æ˜¾ç¤ºçš„åå­—</p><h2 id="9-Context"><a href="#9-Context" class="headerlink" title="9.Context"></a>9.Context</h2><blockquote><p>è·¨ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Œç­‰åŒVueçš„provideã€inject</p></blockquote><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>1.åˆ›å»ºContextå®¹å™¨å¯¹è±¡</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åªæœ‰å½“ç»„ä»¶æ‰€å¤„çš„æ ‘ä¸­æ²¡æœ‰åŒ¹é…åˆ° Provider æ—¶ï¼Œå…¶ defaultValue å‚æ•°æ‰ä¼šç”Ÿæ•ˆ</span></span><br><span class="line"><span class="keyword">const</span> xxxContext = React.createContext(defaultValue) </span><br></pre></td></tr></table></figure><p>2.æ¸²æŸ“å­ç»„æ—¶ï¼Œå¤–é¢åŒ…è£¹xxxContext.Providerï¼Œé€šè¿‡valueå±æ€§ç»™åä»£ç»„ä»¶ä¼ é€’æ•°æ®</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;xxxContext.Provider value=&#123;æ•°æ®&#125;&gt;</span><br><span class="line">    &lt;å­ç»„ä»¶&gt;&lt;/å­ç»„ä»¶&gt;</span><br><span class="line">&lt;/xxxContext.Provider&gt;</span><br></pre></td></tr></table></figure><p>psï¼šå¦‚æœè¦ä¼ å¤šä¸ªæ•°æ®ï¼Œéœ€è¦å¥—å¤šå±‚</p><p>3.åä»£ç»„ä»¶è·å–æ•°æ®</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¬¬ä¸€ç§ï¼šä»…é€‚ç”¨äºç±»ç»„ä»¶</span></span><br><span class="line"><span class="keyword">static</span> contextType = xxxContext <span class="comment">// å£°æ˜æ¥å—context</span></span><br><span class="line"><span class="built_in">this</span>.context; <span class="comment">// è¯»å–contextä¸­çš„valueæ•°æ®</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬äºŒç§ï¼šå‡½æ•°ç»„ä»¶ä¸ç±»ç»„ä»¶éƒ½å¯ä»¥</span></span><br><span class="line">&lt;xxxContext.Consumer&gt;</span><br><span class="line">    &#123;value&#125;</span><br><span class="line">&lt;/xxxContext.Consumer&gt;</span><br></pre></td></tr></table></figure><p><strong>ä¸å»ºè®®ä½¿ç”¨è¯¥apiï¼Œä»–æé«˜äº†ç»„ä»¶å¤ç”¨çš„éš¾åº¦</strong></p><h2 id="10-PureComponent"><a href="#10-PureComponent" class="headerlink" title="10.PureComponent"></a>10.PureComponent</h2><blockquote><p>çˆ¶ç»„ä»¶setStateä¼šè§¦å‘å­ç»„ä»¶renderï¼ŒPureComponenté€šè¿‡propå’Œstateçš„<strong>æµ…æ¯”è¾ƒ</strong>æ¥å®ç°shouldComponentUpdateï¼Œç®—æ˜¯ä¸€ç§è¯­æ³•ç³–ï¼Œå¸®æˆ‘ä»¬åº”è¯¥åœ¨shouldComponentUpdateä¸­åº”è¯¥æ‰‹åŠ¨æ¯”è¾ƒçš„ç»™åšäº†</p></blockquote><p>å¦‚æœæ˜¯æµ…å±‚stateæˆ–propæ²¡æ”¹å˜ï¼Œé‚£ä¹ˆä¸ä¼šè§¦å‘è§†å›¾æ›´æ–°ï¼Œä¹¦å†™æ–¹å¼å¦‚ä¸‹</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexPage</span> <span class="keyword">extends</span> <span class="title">PureComponent</span> </span>&#123;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç”±äºæ˜¯æµ…æ¯”è¾ƒï¼Œæ‰€ä»¥ç›´æ¥ä¿®æ”¹å¯¹è±¡å†…éƒ¨çš„å€¼æ˜¯æ— æ³•æ›´æ–°è§†å›¾çš„</strong></p><p>åœ¨å‡½æ•°å¼ç»„ä»¶åˆ™æ˜¯ç”¨<code>React.memo</code>åŒ…è£¹å‡½æ•°å¼ç»„ä»¶æ¥åšåˆ°PureComponentçš„æ•ˆæœ</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://github.com/tsrot/study-notes/blob/master/React%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90%E6%B1%87%E6%80%BB.md">Reactå­¦ä¹ èµ„æºæ±‡æ€»</a><br><a href="http://www.ruanyifeng.com/blog/2015/03/react.html">React å…¥é—¨å®ä¾‹æ•™ç¨‹</a><br><a href="https://blog.sakura-snow.com/post/react-node-2/">reactå­¦ä¹ ç¬”è®°2-reactåŸºæœ¬ä½¿ç”¨</a><br><a href="https://blog.sakura-snow.com/post/react-node-3/">reactå­¦ä¹ ç¬”è®°3-reactå…¶ä»–ä½¿ç”¨æŠ€å·§</a><br><a href="https://juejin.cn/post/6844903510538977287">å›¾è§£ES6ä¸­çš„Reactç”Ÿå‘½å‘¨æœŸ</a><br><a href="https://juejin.cn/post/6844903857135304718#heading-25">ä½ è¦çš„ React é¢è¯•çŸ¥è¯†ç‚¹ï¼Œéƒ½åœ¨è¿™äº†</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;1-è®¾è®¡æ€æƒ³&quot;&gt;&lt;a href=&quot;#1-è®¾è®¡æ€æƒ³&quot; class=&quot;headerlink&quot; title=&quot;1. è®¾è®¡æ€æƒ³&quot;&gt;&lt;/a&gt;1. è®¾è®¡æ€æƒ³&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/react-guide/react-
      
    
    </summary>
    
    
      <category term="å‰ç«¯" scheme="https://liang5757.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="React" scheme="https://liang5757.github.io/tags/React/"/>
    
  </entry>
  
  <entry>
    <title>jså‡†ç¡®å€’è®¡æ—¶</title>
    <link href="https://liang5757.github.io/2021/05/25/Js/js%E5%87%86%E7%A1%AE%E5%80%92%E8%AE%A1%E6%97%B6/"/>
    <id>https://liang5757.github.io/2021/05/25/Js/js%E5%87%86%E7%A1%AE%E5%80%92%E8%AE%A1%E6%97%B6/</id>
    <published>2021-05-24T16:03:51.000Z</published>
    <updated>2021-05-24T16:04:59.178Z</updated>
    
    <content type="html"><![CDATA[<h1 id="jså‡†ç¡®å€’è®¡æ—¶"><a href="#jså‡†ç¡®å€’è®¡æ—¶" class="headerlink" title="jså‡†ç¡®å€’è®¡æ—¶"></a>jså‡†ç¡®å€’è®¡æ—¶</h1><h2 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h2><p>å¦‚æœç”¨æœ€åˆå§‹çš„<code>setTimeout</code>é€’å½’å®ç°å®šæ—¶å™¨ï¼Œä¸€ç§’æ‰§è¡Œä¸€æ¬¡å›è°ƒï¼Œåˆ™ä»£ç å¦‚ä¸‹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¨¡æ‹Ÿæ‰§è¡Œå¤§é‡ä»£ç </span></span><br><span class="line"><span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (i++ &lt; <span class="number">100000000</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">countDown</span> (<span class="params">fn, time</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> startTime = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime(), count = <span class="number">0</span>, second = <span class="number">1000</span>;</span><br><span class="line">  <span class="keyword">let</span> timeCounter = <span class="literal">null</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">interFunc</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> offset = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime() - (startTime + count * second);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;è¯¯å·®ï¼š&quot;</span> + offset + <span class="string">&quot;msï¼Œä¸‹ä¸€æ¬¡æ‰§è¡Œï¼š&quot;</span> + <span class="number">1000</span> + <span class="string">&quot;msåï¼Œç¦»æ´»åŠ¨å¼€å§‹è¿˜æœ‰ï¼š&quot;</span> + time + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">    time -= second;</span><br><span class="line">    count++;</span><br><span class="line">    <span class="keyword">if</span> (time &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="built_in">clearTimeout</span>(timeCounter);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      timeCounter = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        fn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        interFunc();</span><br><span class="line">      &#125;, <span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">countDown(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;, <span class="number">10000</span>)(); <span class="comment">// æµ‹è¯•ä»£ç </span></span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="/2021/05/25/Js/js%E5%87%86%E7%A1%AE%E5%80%92%E8%AE%A1%E6%97%B6/image-20210524235731030.png" alt="image-20210524235731030"></p><p>å¯ä»¥çœ‹åˆ°è¯¯å·®æ˜¯ä¼šè¶Šæ¥è¶Šå¤šçš„ã€‚</p><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>æ ¸å¿ƒæ€æƒ³å°±æ˜¯é€šè¿‡è®¡ç®— <strong>å½“å‰æ—¶é—´ - åº”è¯¥åˆ°çš„æ—¶é—´</strong> è®¡ç®—å‡º<strong>æ—¶é—´åç§»é‡</strong>ï¼Œ<strong>ä¸‹ä¸€æ¬¡å»¶è¿Ÿæ—¶é—´å°±æ˜¯ 1s - åç§»é‡</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¨¡æ‹Ÿæ‰§è¡Œå¤§é‡ä»£ç </span></span><br><span class="line"><span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (i++ &lt; <span class="number">100000000</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å€’è®¡æ—¶</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">countDown</span> (<span class="params">fn, time</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> startTime = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime(), count = <span class="number">0</span>, second = <span class="number">1000</span>;</span><br><span class="line">  <span class="keyword">let</span> timeCounter = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">interFunc</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> offset = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime() - (startTime + count * second);</span><br><span class="line">    <span class="keyword">let</span> nextTime = second - offset;</span><br><span class="line">    <span class="keyword">if</span> (nextTime &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      nextTime = <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;è¯¯å·®ï¼š&quot;</span> + offset + <span class="string">&quot;msï¼Œä¸‹ä¸€æ¬¡æ‰§è¡Œï¼š&quot;</span> + nextTime + <span class="string">&quot;msåï¼Œç¦»æ´»åŠ¨å¼€å§‹è¿˜æœ‰ï¼š&quot;</span> + time + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">    time -= second;</span><br><span class="line">    count++;</span><br><span class="line">    <span class="keyword">if</span> (time &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="built_in">clearTimeout</span>(timeCounter);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      timeCounter = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        fn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        interFunc();</span><br><span class="line">      &#125;, nextTime);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">countDown(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;, <span class="number">10000</span>)(); <span class="comment">// æµ‹è¯•ä»£ç </span></span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="/2021/05/25/Js/js%E5%87%86%E7%A1%AE%E5%80%92%E8%AE%A1%E6%97%B6/image-20210525000118726.png" alt="image-20210525000118726"></p><p>å¯ä»¥çœ‹åˆ°è™½ç„¶ä»æœ‰è¯¯å·®ï¼Œä½†ä¸ä¼šéšç€æ—¶é—´å¢å¤§</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;jså‡†ç¡®å€’è®¡æ—¶&quot;&gt;&lt;a href=&quot;#jså‡†ç¡®å€’è®¡æ—¶&quot; class=&quot;headerlink&quot; title=&quot;jså‡†ç¡®å€’è®¡æ—¶&quot;&gt;&lt;/a&gt;jså‡†ç¡®å€’è®¡æ—¶&lt;/h1&gt;&lt;h2 id=&quot;å¼•å…¥&quot;&gt;&lt;a href=&quot;#å¼•å…¥&quot; class=&quot;headerlink&quot; title=&quot;å¼•
      
    
    </summary>
    
    
      <category term="å‰ç«¯" scheme="https://liang5757.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="js" scheme="https://liang5757.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•ç»™å¯¹è±¡è®¾ç½®é»˜è®¤å€¼</title>
    <link href="https://liang5757.github.io/2021/05/06/Js/%E5%A6%82%E4%BD%95%E7%BB%99%E5%AF%B9%E8%B1%A1%E8%AE%BE%E7%BD%AE%E9%BB%98%E8%AE%A4%E5%80%BC/"/>
    <id>https://liang5757.github.io/2021/05/06/Js/%E5%A6%82%E4%BD%95%E7%BB%99%E5%AF%B9%E8%B1%A1%E8%AE%BE%E7%BD%AE%E9%BB%98%E8%AE%A4%E5%80%BC/</id>
    <published>2021-05-05T17:06:29.000Z</published>
    <updated>2021-05-05T17:18:53.875Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-ç”¨-â€¦-è§£æ„è®¾ç½®"><a href="#1-ç”¨-â€¦-è§£æ„è®¾ç½®" class="headerlink" title="1.ç”¨ â€¦ è§£æ„è®¾ç½®"></a>1.ç”¨ â€¦ è§£æ„è®¾ç½®</h2><p>åœ¨çœ‹compressor.jsçš„æ—¶å€™ï¼Œä»–ç”¨ä¸€ä¸ªæ–‡ä»¶æ¥å­˜é»˜è®¤å€¼ï¼Œç„¶åå¯¼å‡ºï¼Œæœ€åç”¨è§£æ„çš„æ–¹å¼ï¼Œåé¢çš„å€¼è¦†ç›–å‰é¢çš„æ–¹å¼è®¾ç½®é»˜è®¤å€¼ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ç”¨<code>Object.assign</code>éƒ½æ˜¯ä¸€æ ·çš„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// defaults.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    maxWidth: <span class="literal">Infinity</span>,</span><br><span class="line">    maxHeight: <span class="literal">Infinity</span>,</span><br><span class="line">    <span class="comment">// ... </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">import</span> DEFAULTS <span class="keyword">from</span> <span class="string">&#x27;./defaults&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Compressor</span> </span>&#123;</span><br><span class="line">    <span class="title">constructor</span> (<span class="params">option</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.option = &#123;</span><br><span class="line">            ...DEFAULTS,</span><br><span class="line">            ...option,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„æ–¹æ³•çœ‹ç€æŒºæ–¹ä¾¿çš„ï¼Œä½†æ˜¯è¿˜æœ‰ç¼ºé™·ï¼Œè§£å†³ä¸äº†ä¸‹é¢çš„é—®é¢˜</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> user = &#123;</span><br><span class="line">  a: <span class="string">&quot;a1&quot;</span>,</span><br><span class="line">  b: &#123;</span><br><span class="line">    c: <span class="string">&quot;c1&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> defaults = &#123;</span><br><span class="line">  a: <span class="string">&quot;a2&quot;</span>,</span><br><span class="line">  b: &#123;</span><br><span class="line">    c: <span class="string">&quot;c2&quot;</span>,</span><br><span class="line">    d: <span class="string">&quot;d1&quot;</span> <span class="comment">// ä¸¢å¤±äº†</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> option = &#123;</span><br><span class="line">  ...defaults,</span><br><span class="line">  ...user</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(option) <span class="comment">// &#123; a: &#x27;a1&#x27;, b: &#123; c: &#x27;c1&#x27; &#125; &#125;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°é»˜è®¤é…ç½®ä¸­ <strong>dä¸¢å¤±äº†</strong>ï¼Œä¸‹é¢çš„æ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜</p><h2 id="2-extendæ–¹æ³•"><a href="#2-extendæ–¹æ³•" class="headerlink" title="2.extendæ–¹æ³•"></a>2.extendæ–¹æ³•</h2><p>Mescroll.jså®ç°çš„æ–¹æ³•ï¼Œé€‚åˆå¤šä¸ªæ–¹æ³•éƒ½éœ€è¦é»˜è®¤å€¼çš„æ—¶å€™ï¼Œå¹¶ä¸”<strong>å¯ä»¥æ·±åº¦åŒ¹é…é»˜è®¤å€¼</strong>ï¼Œé»˜è®¤å€¼ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ï¼Œ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MeScroll.extend = <span class="function"><span class="keyword">function</span> (<span class="params">userOption, defaultOption</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!userOption) <span class="keyword">return</span> defaultOption;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> defaultOption) &#123;</span><br><span class="line">        <span class="keyword">if</span> (userOption[key] == <span class="literal">null</span>) &#123; <span class="comment">// å¦‚æœç”¨æˆ·æ²¡è®¾ç½®ï¼Œåˆ™ç”¨é»˜è®¤å€¼</span></span><br><span class="line">            userOption[key] = defaultOption[key]; </span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> userOption[key] === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">            MeScroll.extend(userOption[key], defaultOption[key]); <span class="comment">// æ·±åº¦åŒ¹é…</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> userOption;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æœ‰äº›åœºæ™¯æˆ‘ä»¬æ˜¯éœ€è¦æœ‰<strong>å¤šä¸ªé…ç½®è¿›è¡Œåˆå¹¶</strong>ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒjqueryçš„<code>extend</code>å®ç°æ–¹å¼</p><h2 id="3-extend"><a href="#3-extend" class="headerlink" title="3.$.extend"></a>3.$.extend</h2><p><code>$.extend([deep,] [target,] object1 [,objectN])</code></p><blockquote><p><strong>deep</strong>: Boolenç±»å‹ï¼Œå¯é€‰ï¼Œè¡¨ç¤ºæ˜¯å¦è¿›è¡Œé€’å½’åˆå¹¶ï¼ˆæ·±/æµ…å¤åˆ¶ï¼‰ï¼Œä¸ºtrueæ˜¯ä¸ºæ·±å¤åˆ¶ï¼›é»˜è®¤å€¼ä¸ºfalseï¼Œæµ…å¤åˆ¶ã€‚<br><strong>target</strong>:æ‰©å±•å¯¹è±¡ï¼Œå¯é€‰ï¼Œå°†æ¥æ”¶æ–°çš„å±æ€§ã€‚<br><strong>objectN</strong>:ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«é¢å¤–çš„å±æ€§ï¼Œæ‰©å±•åˆ°ç›®æ ‡å¯¹è±¡ï¼ˆæ‰©å±•å¯¹è±¡ï¼‰ã€‚</p></blockquote><p>æˆ‘ä»¬å¯ä»¥ç æ‰ä¸€ä¸ªæ²¡å¿…è¦çš„åŠŸèƒ½ï¼Œå°±æ˜¯<code>$.extend</code>å¦‚æœå‚æ•°ä¸­åªæœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™æ‰©å±•jqueryå¯¹è±¡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ­¤æ–¹æ³•ä¼šæ”¹å˜åŸå¯¹è±¡</span></span><br><span class="line">jQuery.extend = jQuery.fn.extend = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> options, name, src, copy, copyIsArray, clone,</span><br><span class="line">    target = <span class="built_in">arguments</span>[<span class="number">0</span>] || &#123;&#125;,</span><br><span class="line">    i = <span class="number">1</span>,    <span class="comment">// iè¡¨ç¤ºä»ç¬¬å‡ ä¸ªå‚æ•°å¼€å§‹å‘ç›®æ ‡å‚æ•°è¿›è¡Œåˆå¹¶ï¼Œé»˜è®¤ä»ç¬¬2ä¸ªå‚æ•°å¼€å§‹å‘ç¬¬1ä¸ªå‚æ•°è¿›è¡Œåˆå¹¶</span></span><br><span class="line">    length = <span class="built_in">arguments</span>.length,</span><br><span class="line">    deep = <span class="literal">false</span>;  <span class="comment">// é»˜è®¤ä¸ºæµ…åº¦æ‹·è´</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç”¨æ¥è®¾ç½®deepçš„booleanå€¼ï¼Œåˆ™å°†targetè®¾ç½®ä¸ºä¸‹ä¸€ä¸ªå‚æ•°</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> target === <span class="string">&quot;boolean&quot;</span>) &#123;</span><br><span class="line">    deep = target;</span><br><span class="line">    </span><br><span class="line">    target = <span class="built_in">arguments</span>[i] || &#123;&#125;;</span><br><span class="line">    i++;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//  åˆ¤æ–­ç›®æ ‡å‚æ•°çš„ç±»å‹ï¼Œè‹¥ç›®æ ‡å‚æ•°æ—¢ä¸æ˜¯objectç±»å‹ï¼Œä¹Ÿä¸æ˜¯functionç±»å‹ï¼Œåˆ™ä¸ºç›®æ ‡å‚æ•°é‡æ–°èµ‹å€¼</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> target !== <span class="string">&quot;object&quot;</span> &amp;&amp; <span class="keyword">typeof</span> target !== <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">    target = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// ä»ç¬¬iä¸ªå‚æ•°å¼€å§‹</span></span><br><span class="line">  <span class="keyword">for</span> (; i &lt; length; i++) &#123;</span><br><span class="line">    <span class="comment">// è·å–ç¬¬iä¸ªä¸ä¸ºnullæˆ–undefinedçš„å‚æ•°</span></span><br><span class="line">    <span class="keyword">if</span> ((options = <span class="built_in">arguments</span>[i]) != <span class="literal">null</span>) &#123;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">for</span> (name <span class="keyword">in</span> options) &#123;</span><br><span class="line">        src = target[name];</span><br><span class="line">        copy = options[name];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// é˜²æ­¢å¾ªç¯å¼•ç”¨</span></span><br><span class="line">        <span class="keyword">if</span> (name === <span class="string">&quot;__proto__&quot;</span> || target === copy) &#123;</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è‹¥deepä¸ºtrueï¼Œä¸”å½“å‰å‚æ•°ä¸­nameå­—æ®µçš„å€¼å­˜åœ¨ä¸”ä¸ºobjectç±»å‹æˆ–Arrayç±»å‹ï¼Œåˆ™è¿›è¡Œæ·±åˆå¹¶</span></span><br><span class="line">        <span class="keyword">if</span> (deep &amp;&amp; copy &amp;&amp; (isPlainObject(copy) || (copyIsArray = <span class="built_in">Array</span>.isArray(copy)))) &#123;</span><br><span class="line">          <span class="comment">// å¦‚æœcopyæ˜¯æ•°ç»„ç±»å‹ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡å‚æ•°ä¸­nameå­—æ®µçš„å€¼æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨åˆ™ä½¿ç”¨åŸæ¥çš„ï¼Œå¦åˆ™è¿›è¡Œåˆå§‹åŒ–</span></span><br><span class="line">          <span class="keyword">if</span> (copyIsArray &amp;&amp; !<span class="built_in">Array</span>.isArray(src)) &#123;</span><br><span class="line">            clone = [];</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!copyIsArray &amp;&amp; !isPlainObject(src)) &#123;</span><br><span class="line">            clone = &#123;&#125;;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            clone = src;</span><br><span class="line">          &#125;</span><br><span class="line">          copyIsArray = <span class="literal">false</span>;</span><br><span class="line">          </span><br><span class="line">          target[name] = merge(deep, clone, copy);</span><br><span class="line">          </span><br><span class="line">          <span class="comment">// deepä¸ºfalseï¼Œè¡¨ç¤ºæµ…æ‹·è´ï¼Œç›´æ¥è¿›è¡Œèµ‹å€¼</span></span><br><span class="line">          <span class="comment">// æˆ–è€…copyä¸ä¸ºObjectå¯¹è±¡ã€æ•°ç»„ï¼Œåˆ™ç›´æ¥èµ‹å€¼</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (copy !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">          <span class="comment">// è‹¥åŸå¯¹è±¡å­˜åœ¨nameå±æ€§ï¼Œåˆ™ç›´æ¥è¦†ç›–æ‰ï¼›è‹¥ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–°çš„å±æ€§</span></span><br><span class="line">          target[name] = copy;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// è¿”å›ä¿®æ”¹åçš„ç›®æ ‡å‚æ•°</span></span><br><span class="line">  <span class="keyword">return</span> target;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="é™„1ï¼šjqueryé‡æ„äº†çš„ä¸€æ®µä»£ç "><a href="#é™„1ï¼šjqueryé‡æ„äº†çš„ä¸€æ®µä»£ç " class="headerlink" title="é™„1ï¼šjqueryé‡æ„äº†çš„ä¸€æ®µä»£ç "></a>é™„1ï¼šjqueryé‡æ„äº†çš„ä¸€æ®µä»£ç </h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (deep &amp;&amp; copy &amp;&amp; (jQuery.isPlainObject(copy) || (copyIsArray = <span class="built_in">Array</span>.isArray(copy)))) &#123;</span><br><span class="line">    <span class="keyword">if</span> (copyIsArray) &#123;</span><br><span class="line">        copyIsArray = <span class="literal">false</span>;</span><br><span class="line">        clone = src &amp;&amp; <span class="built_in">Array</span>.isArray(src) ? src : [];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        clone = src &amp;&amp; jQuery.isPlainObject(src) ? src : &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    target[name] = jQuery.extend(deep, clone, copy);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> ( copy !== <span class="literal">undefined</span> ) &#123;</span><br><span class="line">    target[name] = copy;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (deep &amp;&amp; copy &amp;&amp; (isPlainObject(copy) || (copyIsArray = <span class="built_in">Array</span>.isArray(copy)))) &#123;</span><br><span class="line">    <span class="keyword">if</span> (copyIsArray &amp;&amp; !<span class="built_in">Array</span>.isArray(src)) &#123;</span><br><span class="line">        clone = [];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!copyIsArray &amp;&amp; !isPlainObject(src)) &#123;</span><br><span class="line">        clone = &#123;&#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        clone = src;</span><br><span class="line">    &#125;</span><br><span class="line">    copyIsArray = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    target[name] = merge(deep, clone, copy);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (copy !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">    target[name] = copy;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»£ç æ˜æ˜¾ä¸‹é¢å¥½çœ‹äº†è®¸å¤šï¼Œå¯ä»¥å­¦ä¹ ä¸€ä¸‹è¿™ç§é‡æ„æ–¹å¼</p><h2 id="é™„2ï¼šisEmptyObjectã€isPlainObject"><a href="#é™„2ï¼šisEmptyObjectã€isPlainObject" class="headerlink" title="é™„2ï¼šisEmptyObjectã€isPlainObject"></a>é™„2ï¼šisEmptyObjectã€isPlainObject</h2><h4 id="1-isEmptyObject"><a href="#1-isEmptyObject" class="headerlink" title="1.isEmptyObject"></a>1.isEmptyObject</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">isEmptyObject: <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (name <span class="keyword">in</span> obj) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿˜å¯ä»¥åˆ©ç”¨JSON.stringify</span></span><br><span class="line"><span class="built_in">JSON</span>.stringify(obj) == <span class="string">&quot;&#123;&#125;&quot;</span></span><br></pre></td></tr></table></figure><h4 id="2-isPlainObject"><a href="#2-isPlainObject" class="headerlink" title="2.isPlainObject"></a>2.isPlainObject</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPlainObject</span> (<span class="params">target</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 1.å…ˆæ’é™¤æ˜æ˜¾ä¸æ˜¯Objectçš„</span></span><br><span class="line">    <span class="keyword">if</span> (!target || <span class="built_in">Object</span>.prototype.toString.call(target) !== <span class="string">&quot;[object Object]&quot;</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2.åˆ¤æ–­æ˜¯å¦æœ‰åŸå‹ï¼Œæ²¡æœ‰åŸå‹çš„æ˜¯ç®€å•å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">const</span> proto = <span class="built_in">Object</span>.getPrototypeOf(target);</span><br><span class="line">    <span class="keyword">if</span> (!proto) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3.åˆ¤æ–­å…¶æ„é€ å‡½æ•°æ˜¯å¦ä¸º Object</span></span><br><span class="line">    <span class="keyword">const</span> ctor = proto.constructor;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> ctor === <span class="string">&quot;function&quot;</span> &amp;&amp; ctor === <span class="built_in">Object</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://blog.csdn.net/weixin_33694172/article/details/89369987">https://blog.csdn.net/weixin_33694172/article/details/89369987</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;1-ç”¨-â€¦-è§£æ„è®¾ç½®&quot;&gt;&lt;a href=&quot;#1-ç”¨-â€¦-è§£æ„è®¾ç½®&quot; class=&quot;headerlink&quot; title=&quot;1.ç”¨ â€¦ è§£æ„è®¾ç½®&quot;&gt;&lt;/a&gt;1.ç”¨ â€¦ è§£æ„è®¾ç½®&lt;/h2&gt;&lt;p&gt;åœ¨çœ‹compressor.jsçš„æ—¶å€™ï¼Œä»–ç”¨ä¸€ä¸ªæ–‡ä»¶æ¥å­˜é»˜è®¤å€¼ï¼Œç„¶åå¯¼å‡ºï¼Œæœ€å
      
    
    </summary>
    
    
      <category term="å‰ç«¯" scheme="https://liang5757.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="js" scheme="https://liang5757.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>crossventæºç è§£è¯»</title>
    <link href="https://liang5757.github.io/2021/04/06/Js/crossvent%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/"/>
    <id>https://liang5757.github.io/2021/04/06/Js/crossvent%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/</id>
    <published>2021-04-06T15:46:07.000Z</published>
    <updated>2021-04-06T16:06:44.030Z</updated>
    
    <content type="html"><![CDATA[<h1 id="crossventæºç è§£è¯»"><a href="#crossventæºç è§£è¯»" class="headerlink" title="crossventæºç è§£è¯»"></a>crossventæºç è§£è¯»</h1><blockquote><p>å…¶å®å°±æ˜¯ä¸€ä¸ªå°è£…äº‹ä»¶ç»‘å®šçš„åº“ï¼Œä½†æ˜¯çœ‹åˆ°äº†ä¸€äº›æŠ€å·§è®°å½•ä¸‹æ¥<br>githubåœ°å€ï¼š<a href="https://github.com/bevacqua/crossvent/blob/master/src/crossvent.js">https://github.com/bevacqua/crossvent/blob/master/src/crossvent.js</a></p></blockquote><h2 id="ä»å‡ºå£å¼€å§‹"><a href="#ä»å‡ºå£å¼€å§‹" class="headerlink" title="ä»å‡ºå£å¼€å§‹"></a>ä»å‡ºå£å¼€å§‹</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  add: addEvent,</span><br><span class="line">  remove: removeEvent,</span><br><span class="line">  fabricate: fabricateEvent</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="addå’Œremoveå‡½æ•°"><a href="#addå’Œremoveå‡½æ•°" class="headerlink" title="addå’Œremoveå‡½æ•°"></a>addå’Œremoveå‡½æ•°</h2><p><code>addEvent</code>å®é™…ä¸Šå°±æ˜¯åˆ¤æ–­windowæ˜¯å¦æœ‰<code>addEventListener</code>ï¼Œå¦‚æœæ²¡æœ‰å°±ç”¨<code>attachEvent</code>ï¼ŒremoveåŒç†</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> addEvent = addEventEasy;</span><br><span class="line"><span class="keyword">var</span> removeEvent = removeEventEasy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">global</span>.addEventListener) &#123;</span><br><span class="line">  addEvent = addEventHard;</span><br><span class="line">  removeEvent = removeEventHard;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addEventEasy</span> (<span class="params">el, type, fn, capturing</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> el.addEventListener(type, fn, capturing); <span class="comment">// capturingå¦‚æœä¸ºtrueåˆ™åœ¨äº‹ä»¶æ•è·é˜¶æ®µæ‰§è¡Œï¼Œé»˜è®¤ä¸ºfalse</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addEventHard</span> (<span class="params">el, type, fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> el.attachEvent(<span class="string">&#x27;on&#x27;</span> + type, wrap(el, type, fn));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeEventEasy</span> (<span class="params">el, type, fn, capturing</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> el.removeEventListener(type, fn, capturing);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeEventHard</span> (<span class="params">el, type, fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> listener = unwrap(el, type, fn);</span><br><span class="line">  <span class="keyword">if</span> (listener) &#123;</span><br><span class="line">    <span class="keyword">return</span> el.detachEvent(<span class="string">&#x27;on&#x27;</span> + type, listener);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦æ³¨æ„ï¼šåœ¨ä¸æ”¯æŒ<code>addEventListener</code>çš„æ—¶å€™ï¼Œä½¿ç”¨<code>attachEvent</code>å’Œ<code>detachEvent</code>äº‹ä»¶å›è°ƒå‡½æ•°å¤šåšäº†ä¸€å±‚<code>wrap</code>å’Œ<code>unwrap</code>å¤„ç†</p><h2 id="wrapå’Œunwrap"><a href="#wrapå’Œunwrap" class="headerlink" title="wrapå’Œunwrap"></a>wrapå’Œunwrap</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hardCache = [];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">wrap</span> (<span class="params">el, type, fn</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// å¦‚æœå·²ç»æ³¨å†Œè¿‡è¿™ä¸ªtypeçš„äº‹ä»¶ï¼Œåˆ™unwrapå³ä»hardCacheåˆ é™¤äº‹ä»¶ï¼Œå¹¶åœ¨ä¸‹é¢é‡æ–°æ·»åŠ åˆ°hardCacheæ•°ç»„é‡Œ</span></span><br><span class="line">  <span class="keyword">var</span> wrapper = unwrap(el, type, fn) || wrapperFactory(el, type, fn); </span><br><span class="line">  hardCache.push(&#123;</span><br><span class="line">    wrapper: wrapper,</span><br><span class="line">    element: el,</span><br><span class="line">    type: type,</span><br><span class="line">    fn: fn</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> wrapper;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unwrap</span> (<span class="params">el, type, fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> i = find(el, type, fn);</span><br><span class="line">  <span class="keyword">if</span> (i) &#123;</span><br><span class="line">    <span class="keyword">var</span> wrapper = hardCache[i].wrapper;</span><br><span class="line">    hardCache.splice(i, <span class="number">1</span>); <span class="comment">// free up a tad of memory</span></span><br><span class="line">    <span class="keyword">return</span> wrapper;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">find</span> (<span class="params">el, type, fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> i, item;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; hardCache.length; i++) &#123;</span><br><span class="line">    item = hardCache[i];</span><br><span class="line">    <span class="keyword">if</span> (item.element === el &amp;&amp; item.type === type &amp;&amp; item.fn === fn) &#123;</span><br><span class="line">      <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ˜¯åˆ©ç”¨ä¸€ä¸ªæ•°ç»„å­˜å‚¨äº‹ä»¶å›è°ƒï¼Œåœ¨ç»‘å®šäº‹ä»¶å’Œè§£ç»‘äº‹ä»¶åŒæ—¶å¯¹hardCacheæ•°ç»„è¿›è¡Œæ“ä½œï¼Œä½†æ˜¯ä¸ºå•¥è¦è¿™æ ·å‘¢ã€‚å¯ä»¥çœ‹åˆ°åœ¨wrapå‡½æ•°çš„ç¬¬ä¸€è¡Œ<code>var wrapper = unwrap(el, type, fn) || wrapperFactory(el, type, fn);</code> ï¼Œå®é™…ä¸Šå°±æ˜¯å¦‚æœä¹‹å‰æ²¡æœ‰ç»‘å®šè¿™ä¸ªtypeçš„äº‹ä»¶ï¼Œå°±è°ƒç”¨<code>wrapperFactory</code>å¯¹<code>fn</code>è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œ<strong><code>wrapperFactory</code>è¿™ä¸ªå°è£…ä¸»è¦æ˜¯ä¸ºäº†è§£å†³eventå‚æ•°å†…çš„å±æ€§çš„å…¼å®¹æ€§</strong>ã€‚</p><p>è¿™å°±è§£é‡Šäº†åˆšæ‰æå‡ºçš„ç–‘é—®ï¼Œå°±æ˜¯å› ä¸ºå¤šäº†è¿™å±‚è§£å†³æµè§ˆå™¨å…¼å®¹æ€§çš„åŒ…è£…ï¼Œåœ¨è§£ç»‘äº‹ä»¶çš„æ—¶å€™ï¼Œå¦‚æœåªæ˜¯ä¼ é€’åŸæ¥çš„fnï¼Œåˆ™ä¸èƒ½è§£ç»‘äº‹ä»¶ï¼Œéœ€è¦ä¸€ä¸ªhardCacheæ•°ç»„æ¥å­˜å–äº‹ä»¶å›è°ƒã€‚</p><h2 id="wrapperFactory"><a href="#wrapperFactory" class="headerlink" title="wrapperFactory"></a>wrapperFactory</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">wrapperFactory</span> (<span class="params">el, type, fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">wrapper</span> (<span class="params">originalEvent</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> e = originalEvent || <span class="built_in">global</span>.event;</span><br><span class="line">    e.target = e.target || e.srcElement;</span><br><span class="line">    e.preventDefault = e.preventDefault || <span class="function"><span class="keyword">function</span> <span class="title">preventDefault</span> (<span class="params"></span>) </span>&#123; e.returnValue = <span class="literal">false</span>; &#125;;</span><br><span class="line">    e.stopPropagation = e.stopPropagation || <span class="function"><span class="keyword">function</span> <span class="title">stopPropagation</span> (<span class="params"></span>) </span>&#123; e.cancelBubble = <span class="literal">true</span>; &#125;;</span><br><span class="line">    e.which = e.which || e.keyCode;</span><br><span class="line">    fn.call(el, e);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å±‚å°è£…å¯ä»¥ä½¿eventçš„å„ä¸ªå±æ€§åœ¨ä¸åŒæµè§ˆå™¨ä¸‹è¡Œä¸ºä¸€è‡´ã€‚</p><p>addå’Œrevomeå°±è®²å®Œäº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¯¼å‡ºçš„æœ€åä¸€ä¸ªå‡½æ•°fabricate</p><h2 id="fabricate"><a href="#fabricate" class="headerlink" title="fabricate"></a>fabricate</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fabricateEvent</span> (<span class="params">el, type, model</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> e = eventmap.indexOf(type) === -<span class="number">1</span> ? makeCustomEvent() : makeClassicEvent(); <span class="comment">// åˆ¤æ–­äº‹ä»¶ç±»å‹ å¹¶ åˆ›å»º</span></span><br><span class="line">  <span class="keyword">if</span> (el.dispatchEvent) &#123; <span class="comment">// è§¦å‘äº‹ä»¶</span></span><br><span class="line">    el.dispatchEvent(e);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    el.fireEvent(<span class="string">&#x27;on&#x27;</span> + type, e);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">makeClassicEvent</span> (<span class="params"></span>) </span>&#123; <span class="comment">// åˆ›å»ºåŸç”Ÿäº‹ä»¶</span></span><br><span class="line">    <span class="keyword">var</span> e;</span><br><span class="line">    <span class="keyword">if</span> (doc.createEvent) &#123;</span><br><span class="line">      e = doc.createEvent(<span class="string">&#x27;Event&#x27;</span>);</span><br><span class="line">      e.initEvent(type, <span class="literal">true</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (doc.createEventObject) &#123;</span><br><span class="line">      e = doc.createEventObject();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> e;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">makeCustomEvent</span> (<span class="params"></span>) </span>&#123; <span class="comment">// åˆ›å»ºè‡ªå®šä¹‰äº‹ä»¶</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> customEvent(type, &#123; <span class="attr">detail</span>: model &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>eventmap</code>æ˜¯åŸç”Ÿäº‹ä»¶åçš„é›†åˆï¼Œå¦‚æœæ²¡æœ‰åœ¨<code>eventmap</code>æ‰¾åˆ°åˆ™åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œå¦åˆ™åˆ›å»ºä¸€ä¸ªåŸç”Ÿäº‹ä»¶ï¼Œç„¶åè§¦å‘äº‹ä»¶ã€‚</p><p>é‚£ä¹ˆeventmapæ˜¯æ€ä¹ˆç”Ÿæˆçš„å‘¢ï¼Œæˆ‘ä»¬ä¸‹é¢æ¥çœ‹çœ‹</p><h2 id="è·å–åŸç”Ÿäº‹ä»¶åé›†åˆ"><a href="#è·å–åŸç”Ÿäº‹ä»¶åé›†åˆ" class="headerlink" title="è·å–åŸç”Ÿäº‹ä»¶åé›†åˆ"></a>è·å–åŸç”Ÿäº‹ä»¶åé›†åˆ</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> eventmap = [];</span><br><span class="line"><span class="keyword">var</span> eventname = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> ron = <span class="regexp">/^on/</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (eventname <span class="keyword">in</span> <span class="built_in">global</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (ron.test(eventname)) &#123;</span><br><span class="line">    eventmap.push(eventname.slice(<span class="number">2</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = eventmap;</span><br></pre></td></tr></table></figure><p>å…¶å®å°±æ˜¯æ­£åˆ™åŒ¹é…windowä¸Šçš„å¼€å¤´ä¸ºonçš„å±æ€§å</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>çœ‹åˆ°äº†æŒºå¤šæµè§ˆå™¨å…¼å®¹çš„å¤„ç†æ–¹å¼ï¼Œä»¥åŠåŸç”Ÿäº‹ä»¶åè·å–çš„éªšæ“ä½œï¼Œä¸è¿‡ä»æœ‰ä¸€äº›å…¼å®¹æ–¹å¼æ²¡çœ‹æ‡‚æ˜¯å…¼å®¹å“ªäº›æµè§ˆå™¨çš„ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;crossventæºç è§£è¯»&quot;&gt;&lt;a href=&quot;#crossventæºç è§£è¯»&quot; class=&quot;headerlink&quot; title=&quot;crossventæºç è§£è¯»&quot;&gt;&lt;/a&gt;crossventæºç è§£è¯»&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;å…¶å®å°±æ˜¯ä¸€ä¸ªå°è£…äº‹ä»¶ç»‘å®šçš„
      
    
    </summary>
    
    
      <category term="å‰ç«¯" scheme="https://liang5757.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="js" scheme="https://liang5757.github.io/tags/js/"/>
    
      <category term="æºç è§£è¯»" scheme="https://liang5757.github.io/tags/%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>Koaæ´‹è‘±åŸå‹æºç è§£è¯»</title>
    <link href="https://liang5757.github.io/2021/02/28/node.js/Koa%E6%B4%8B%E8%91%B1%E5%8E%9F%E5%9E%8B%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/"/>
    <id>https://liang5757.github.io/2021/02/28/node.js/Koa%E6%B4%8B%E8%91%B1%E5%8E%9F%E5%9E%8B%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/</id>
    <published>2021-02-27T16:25:27.000Z</published>
    <updated>2021-04-06T15:47:30.046Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Koaæ´‹è‘±åŸå‹æºç è§£è¯»"><a href="#Koaæ´‹è‘±åŸå‹æºç è§£è¯»" class="headerlink" title="Koaæ´‹è‘±åŸå‹æºç è§£è¯»"></a>Koaæ´‹è‘±åŸå‹æºç è§£è¯»</h1><blockquote><p>ç‰ˆæœ¬ï¼š2.13.1</p></blockquote><h2 id="application-js"><a href="#application-js" class="headerlink" title="application.js"></a>application.js</h2><h3 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">constructor</span>(<span class="params">options</span>)</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="built_in">this</span>.middleware = [];</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æœ‰ä¸€ä¸ª<code>middleware</code>å­˜å‡½æ•°</p></blockquote><h3 id="useæ–¹æ³•"><a href="#useæ–¹æ³•" class="headerlink" title="useæ–¹æ³•"></a>useæ–¹æ³•</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">use</span>(<span class="params">fn</span>)</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="built_in">this</span>.middleware.push(fn);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯æ¬¡ä½¿ç”¨app.use()å°±ä¼šå§å›è°ƒå‡½æ•°pushåˆ°<code>middleware</code>é‡Œ</p><h3 id="listenæ–¹æ³•"><a href="#listenæ–¹æ³•" class="headerlink" title="listenæ–¹æ³•"></a>listenæ–¹æ³•</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">listen</span>(<span class="params">...args</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> server = http.createServer(<span class="built_in">this</span>.callback());</span><br><span class="line">    <span class="keyword">return</span> server.listen(...args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºä¸€ä¸ªæœåŠ¡ï¼Œæ‰§è¡Œcallbackæ–¹æ³•</p><h3 id="callbackå’ŒhandleRequestæ–¹æ³•"><a href="#callbackå’ŒhandleRequestæ–¹æ³•" class="headerlink" title="callbackå’ŒhandleRequestæ–¹æ³•"></a>callbackå’ŒhandleRequestæ–¹æ³•</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">callback</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> fn = compose(<span class="built_in">this</span>.middleware);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">this</span>.listenerCount(<span class="string">&#x27;error&#x27;</span>)) <span class="built_in">this</span>.on(<span class="string">&#x27;error&#x27;</span>, <span class="built_in">this</span>.onerror);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> handleRequest = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> ctx = <span class="built_in">this</span>.createContext(req, res); <span class="comment">// node åŸç”Ÿçš„ reqã€res å¯¹è±¡æŠŠå…¶ä¸­çš„å±æ€§æŒ‚è½½åˆ° ctx ä¸Š</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.handleRequest(ctx, fn); <span class="comment">// è°ƒç”¨</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> handleRequest;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">handleRequest</span>(<span class="params">ctx, fnMiddleware</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> res = ctx.res;</span><br><span class="line">    <span class="keyword">const</span> onerror = <span class="function"><span class="params">err</span> =&gt;</span> ctx.onerror(err);</span><br><span class="line">    <span class="comment">// å¤„ç†å“åº”</span></span><br><span class="line">    <span class="keyword">const</span> handleResponse = <span class="function">() =&gt;</span> respond(ctx);</span><br><span class="line">    <span class="keyword">return</span> fnMiddleware(ctx).then(handleResponse).catch(onerror);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>compseå‡½æ•°è¿”å›ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°ï¼Œåœ¨handleRequestæ‰§è¡Œä¸­é—´ä»¶å‡½æ•°ï¼Œå¦‚æœå…¨éƒ¨ resolve äº†å°±å¯ä»¥è°ƒç”¨ handleResponse å‘é€ç»™å®¢æˆ·ç«¯</p><p>æœ¬ç‰‡åšå®¢çš„é‡ç‚¹å°±æ˜¯composeæ˜¯æ€ä¹ˆå®ç°koaçš„æ´‹è‘±æ¨¡å‹çš„</p><h2 id="koa-compose-js"><a href="#koa-compose-js" class="headerlink" title="koa-compose.js"></a>koa-compose.js</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> next();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;4&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use(<span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> next();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="composeå‡½æ•°"><a href="#composeå‡½æ•°" class="headerlink" title="composeå‡½æ•°"></a>composeå‡½æ•°</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compose</span> (<span class="params">middleware</span>) </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> <span class="variable">context</span></span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return <span class="type">&#123;Promise&#125;</span></span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api <span class="variable">public</span></span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">context, next</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// last called middleware #</span></span><br><span class="line">        <span class="keyword">let</span> index = -<span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> dispatch(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">dispatch</span> (<span class="params">i</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (i &lt;= index)</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;next() called multiple times&#x27;</span>))</span><br><span class="line">            index = i</span><br><span class="line">            <span class="keyword">let</span> fn = middleware[i]</span><br><span class="line">            <span class="keyword">if</span> (i === middleware.length) fn = next</span><br><span class="line">            <span class="keyword">if</span> (!fn) <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve()</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(fn(context, dispatch.bind(<span class="literal">null</span>, i + <span class="number">1</span>)));</span><br><span class="line">            &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(err)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p><code>compose</code>å‡½æ•°æ¥æ”¶<code>middleware</code>æ•°ç»„ï¼Œ<code>dispatch(0)</code>å³å¼€å§‹åˆ†å‘ä¸€å·ä¸­é—´ä»¶ã€‚</p></li><li><p><code>dispatch(0)</code>å†…éƒ¨ï¼Œæ­¤æ—¶ fn ä¸ºä¸€å·ä¸­é—´ä»¶ï¼Œä¼šèµ°åˆ° try/catch å—ï¼Œå°è¯•æ‰§è¡Œ<code>Promise.resolve(fn(context, dispatch.bind(null, i + 1)))</code>ï¼Œå³ä¸€å·ä¸­é—´ä»¶æ­¤æ—¶è·å¾—å…¥å‚<code>context</code>ã€<code>dispatch(1)</code>ã€‚</p></li><li><p>ä¸€å·ä¸­é—´ä»¶å¼€å§‹æ‰§è¡Œï¼Œé‡åˆ° next()ï¼ˆå³dispatch(1)ï¼‰ï¼Œæ§åˆ¶æƒç§»äº¤ï¼Œæ‰§è¡Œ dispatch(1)ï¼Œæ­¤æ—¶äºŒå·ä¸­é—´ä»¶è·å¾—å…¥å‚<code>context</code>ã€<code>dispatch(2)</code>ã€‚</p></li><li><p>äºŒå·ä¸­é—´ä»¶å¼€å§‹æ‰§è¡Œï¼Œæ‰§è¡Œåˆ°<code>await next()</code>æ—¶ï¼Œå†é‡å¤ä¸Šè¿°é€»è¾‘ï¼Œdispatch(2)ï¼Œä½†æ˜¯è¿™ä¸€æ¬¡ä¼šåœåœ¨è¿™é‡Œï¼š</p>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fn = middleware[i];</span><br><span class="line"><span class="keyword">if</span> (i === middleware.length) fn = next;</span><br><span class="line"><span class="keyword">if</span> (!fn) <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve();</span><br></pre></td></tr></table></figure><p>  fn = nextï¼Œè¿™é‡Œçš„ next ç”±äºå¹¶æ²¡æœ‰å€¼ï¼Œæ‰€ä»¥ä¼šç›´æ¥ return ä¸€ä¸ªç«‹å³ resolve çš„ Promiseã€‚ä¹Ÿå°±æ˜¯è¯´äºŒå·ä¸­é—´ä»¶å†…éƒ¨çš„ await next()ä¼šç«‹åˆ»è¿”å›ã€‚</p></li><li><p>äºŒå·ä¸­é—´ä»¶åšå®Œè‡ªå·±çš„äº‹åï¼Œç›¸å½“äºä¸€å·ä¸­é—´ä»¶å†…éƒ¨çš„<code>await next()</code>è¿”å›äº†ï¼Œå› æ­¤æ§åˆ¶æƒå°±å½’è¿˜ç»™ä¸€å·ä¸­é—´ä»¶ã€‚</p></li></ul><h2 id="å¦‚æœä¸­é—´ä»¶ä¸­çš„next-æ–¹æ³•æŠ¥é”™äº†æ€ä¹ˆåŠã€‚"><a href="#å¦‚æœä¸­é—´ä»¶ä¸­çš„next-æ–¹æ³•æŠ¥é”™äº†æ€ä¹ˆåŠã€‚" class="headerlink" title="å¦‚æœä¸­é—´ä»¶ä¸­çš„next()æ–¹æ³•æŠ¥é”™äº†æ€ä¹ˆåŠã€‚"></a>å¦‚æœä¸­é—´ä»¶ä¸­çš„<code>next()</code>æ–¹æ³•æŠ¥é”™äº†æ€ä¹ˆåŠã€‚</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ctx.onerror = <span class="function"><span class="keyword">function</span> </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.app.emit(<span class="string">&#x27;error&#x27;</span>, err, <span class="built_in">this</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">listen</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span>  fnMiddleware = compose(<span class="built_in">this</span>.middleware);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">this</span>.listenerCount(<span class="string">&#x27;error&#x27;</span>)) <span class="built_in">this</span>.on(<span class="string">&#x27;error&#x27;</span>, <span class="built_in">this</span>.onerror);</span><br><span class="line">    <span class="keyword">const</span> onerror = <span class="function"><span class="params">err</span> =&gt;</span> ctx.onerror(err);</span><br><span class="line">    fnMiddleware(ctx).then(handleResponse).catch(onerror);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">onerror</span>(<span class="params">err</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// ä»£ç çœç•¥</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç­”ï¼šä¸­é—´ä»¶é“¾é”™è¯¯ä¼šç”±<code>ctx.onerror</code>æ•è·ï¼Œè¯¥å‡½æ•°ä¸­ä¼šè°ƒç”¨<code>this.app.emit(&#39;error&#39;, err, this)</code>ï¼ˆå› ä¸º<code>koa</code>ç»§æ‰¿è‡ª<code>Emitter</code>ï¼Œæ‰€ä»¥æœ‰<code>emit</code>å’Œ<code>on</code>ç­‰æ–¹æ³•ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨<code>app.on(&#39;error&#39;, (err) =&gt; &#123;&#125;)</code>ï¼Œæˆ–è€…<code>app.onerror = (err) =&gt; &#123;&#125;</code>è¿›è¡Œæ•è·ã€‚</p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="https://juejin.cn/post/6844904088220467213#heading-16">https://juejin.cn/post/6844904088220467213#heading-16</a><br><a href="https://linbudu.top/posts/2020/02/25/koa%E6%BA%90%E7%A0%81%E7%B2%BE%E8%AF%BB.html#new-%E4%B8%80%E4%B8%AA-koa-%EF%BC%8C%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88%EF%BC%9F">https://linbudu.top/posts/2020/02/25/koa%E6%BA%90%E7%A0%81%E7%B2%BE%E8%AF%BB.html#new-%E4%B8%80%E4%B8%AA-koa-%EF%BC%8C%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88%EF%BC%9F</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Koaæ´‹è‘±åŸå‹æºç è§£è¯»&quot;&gt;&lt;a href=&quot;#Koaæ´‹è‘±åŸå‹æºç è§£è¯»&quot; class=&quot;headerlink&quot; title=&quot;Koaæ´‹è‘±åŸå‹æºç è§£è¯»&quot;&gt;&lt;/a&gt;Koaæ´‹è‘±åŸå‹æºç è§£è¯»&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;ç‰ˆæœ¬ï¼š2.13.1&lt;/p&gt;
&lt;/block
      
    
    </summary>
    
    
      <category term="åç«¯" scheme="https://liang5757.github.io/categories/%E5%90%8E%E7%AB%AF/"/>
    
    
      <category term="æºç è§£è¯»" scheme="https://liang5757.github.io/tags/%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/"/>
    
      <category term="node.js" scheme="https://liang5757.github.io/tags/node-js/"/>
    
  </entry>
  
  <entry>
    <title>å°¤é›¨æºªfrontend Masterè¯¾ç¨‹ç¬”è®°</title>
    <link href="https://liang5757.github.io/2021/02/18/Vue/%E5%B0%A4%E9%9B%A8%E6%BA%AAfrontend%20Master%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"/>
    <id>https://liang5757.github.io/2021/02/18/Vue/%E5%B0%A4%E9%9B%A8%E6%BA%AAfrontend%20Master%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/</id>
    <published>2021-02-17T18:46:31.000Z</published>
    <updated>2021-02-17T18:47:34.586Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å°¤é›¨æºªFrontend-Masterè¯¾ç¨‹ç¬”è®°"><a href="#å°¤é›¨æºªFrontend-Masterè¯¾ç¨‹ç¬”è®°" class="headerlink" title="å°¤é›¨æºªFrontend Masterè¯¾ç¨‹ç¬”è®°"></a>å°¤é›¨æºªFrontend Masterè¯¾ç¨‹ç¬”è®°</h1><h2 id="1-å“åº”å¼"><a href="#1-å“åº”å¼" class="headerlink" title="1.å“åº”å¼"></a>1.å“åº”å¼</h2><h3 id="ç›®çš„"><a href="#ç›®çš„" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h3><p>å®ç°ä¸€ä¸ªç¥å¥‡çš„å‡½æ•°autoï¼Œä¼šåœ¨<code>state.count</code>æ”¹å˜åï¼Œè‡ªåŠ¨è¿è¡Œé‡Œé¢çš„å‡½æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">autoRun(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">&quot;app&quot;</span>).innerText = state.count;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">state.count++; <span class="comment">// é‡æ–°æ‰§è¡ŒautoRunå†…çš„å‡½æ•°</span></span><br></pre></td></tr></table></figure><h3 id="ç¬¬ä¸€æ­¥-getterå’Œsetter"><a href="#ç¬¬ä¸€æ­¥-getterå’Œsetter" class="headerlink" title="ç¬¬ä¸€æ­¥ getterå’Œsetter"></a>ç¬¬ä¸€æ­¥ getterå’Œsetter</h3><p>éœ€è¦èƒ½ç›‘å¬åˆ°å¯¹è±¡å†…å±æ€§çš„æ”¹å˜</p><h4 id="å®ç°æ•ˆæœ"><a href="#å®ç°æ•ˆæœ" class="headerlink" title="å®ç°æ•ˆæœ"></a>å®ç°æ•ˆæœ</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">foo</span>: <span class="number">123</span> &#125;</span><br><span class="line">observer(obj);</span><br><span class="line">obj.foo <span class="comment">// éœ€è¦æ‰“å°: &#x27;getting key &quot;foo&quot;: 123&#x27;</span></span><br><span class="line">obj.foo = <span class="number">234</span> <span class="comment">// éœ€è¦æ‰“å°: &#x27;setting key &quot;foo&quot; to 234&#x27;</span></span><br><span class="line">obj.foo <span class="comment">// éœ€è¦æ‰“å°: &#x27;getting key &quot;foo&quot;: 234&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="å®ç°æ–¹å¼"><a href="#å®ç°æ–¹å¼" class="headerlink" title="å®ç°æ–¹å¼"></a>å®ç°æ–¹å¼</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">observer</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">Object</span>.keys(obj).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ä¿å­˜å±æ€§åˆå§‹å€¼</span></span><br><span class="line">    <span class="keyword">let</span> internalValue = obj[key]</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(obj, key, &#123;</span><br><span class="line">      get () &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`getting key &quot;<span class="subst">$&#123;key&#125;</span>&quot;: <span class="subst">$&#123;internalValue&#125;</span>`</span>)</span><br><span class="line">        <span class="keyword">return</span> internalValue</span><br><span class="line">      &#125;,</span><br><span class="line">      set (newValue) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`setting key &quot;<span class="subst">$&#123;key&#125;</span>&quot; to: <span class="subst">$&#123;newValue&#125;</span>`</span>)</span><br><span class="line">        internalValue = newValue</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¬¬äºŒæ­¥-ä¾èµ–æ”¶é›†-Dep"><a href="#ç¬¬äºŒæ­¥-ä¾èµ–æ”¶é›†-Dep" class="headerlink" title="ç¬¬äºŒæ­¥ ä¾èµ–æ”¶é›† Dep"></a>ç¬¬äºŒæ­¥ ä¾èµ–æ”¶é›† Dep</h3><h4 id="å®ç°æ•ˆæœ-1"><a href="#å®ç°æ•ˆæœ-1" class="headerlink" title="å®ç°æ•ˆæœ"></a>å®ç°æ•ˆæœ</h4><p>å³ä¸€ä¸ªå‘å¸ƒè®¢é˜…æ¨¡å¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dep = <span class="keyword">new</span> Dep()</span><br><span class="line"></span><br><span class="line">autoRun(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  dep.depend()</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;updated&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// æ‰“å°: &quot;updated&quot;</span></span><br><span class="line"></span><br><span class="line">dep.notify()</span><br><span class="line"><span class="comment">// æ‰“å°: &quot;updated&quot;</span></span><br></pre></td></tr></table></figure><h4 id="å®ç°æ–¹å¼-1"><a href="#å®ç°æ–¹å¼-1" class="headerlink" title="å®ç°æ–¹å¼"></a>å®ç°æ–¹å¼</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dep</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.subs = []</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">depend</span>(<span class="params"></span>)</span> &#123; <span class="comment">// è®¢é˜…å‡½æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (activeUpdate) &#123;</span><br><span class="line">      <span class="built_in">this</span>.subs.push(activeUpdate); <span class="comment">// æŠŠå…¨å±€å˜é‡activeUpdateå­˜çš„å‡½æ•°æ”¾å…¥è®¢é˜…è€…åˆ—è¡¨</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">notify</span>(<span class="params"></span>)</span> &#123; <span class="comment">// å‘å¸ƒå‡½æ•°</span></span><br><span class="line">    <span class="built_in">this</span>.subs.forEach(<span class="function"><span class="params">sub</span> =&gt;</span> sub());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> activeUpdate = <span class="literal">null</span> <span class="comment">// æ”¾ç½®ä¾èµ–å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">autoRun</span> (<span class="params">update</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> wrappedUpdate = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    activeUpdate = wrappedUpdate <span class="comment">// æŠŠwrappedUpdateå­˜èµ·æ¥</span></span><br><span class="line">    update() <span class="comment">// åœ¨updateå†…éƒ¨è°ƒç”¨dep.depend()æ”¶é›†ä¾èµ–</span></span><br><span class="line">    activeUpdate = <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">  wrappedUpdate()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¬¬ä¸‰æ­¥-æ•´åˆä¸€ã€äºŒ"><a href="#ç¬¬ä¸‰æ­¥-æ•´åˆä¸€ã€äºŒ" class="headerlink" title="ç¬¬ä¸‰æ­¥ æ•´åˆä¸€ã€äºŒ"></a>ç¬¬ä¸‰æ­¥ æ•´åˆä¸€ã€äºŒ</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dep</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.subs = []</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">depend</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (activeUpdate) &#123;</span><br><span class="line">      <span class="built_in">this</span>.subs.push(activeUpdate);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">notify</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.subs.forEach(<span class="function"><span class="params">sub</span> =&gt;</span> sub());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">obj</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.dep = <span class="keyword">new</span> Dep();</span><br><span class="line">    <span class="built_in">this</span>.walk(obj);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">walk</span>(<span class="params">obj</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">Object</span>.keys(obj).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.defineReactive(obj, key);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">defineReactive</span>(<span class="params">obj, key</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> that = <span class="built_in">this</span>;</span><br><span class="line">    <span class="keyword">let</span> internalValue = obj[key];</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(obj, key, &#123;</span><br><span class="line">      enumerable: <span class="literal">false</span>,</span><br><span class="line">      configurable: <span class="literal">false</span>,</span><br><span class="line">      <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        that.dep.depend();</span><br><span class="line">        <span class="keyword">return</span> internalValue;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="function"><span class="title">set</span>(<span class="params">newVal</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> isChanged = internalValue !== newVal;</span><br><span class="line">        <span class="keyword">if</span> (isChanged) &#123;</span><br><span class="line">          internalValue = newVal;</span><br><span class="line">          that.dep.notify();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> activeUpdate = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">autoRun</span> (<span class="params">update</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> wrappedUpdate = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    activeUpdate = wrappedUpdate <span class="comment">// æŠŠwrappedUpdateå­˜èµ·æ¥</span></span><br><span class="line">    update() <span class="comment">// åœ¨updateå†…éƒ¨è°ƒç”¨dep.depend()æ”¶é›†ä¾èµ–</span></span><br><span class="line">    activeUpdate = <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">  wrappedUpdate()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-è™šæ‹ŸDOM"><a href="#2-è™šæ‹ŸDOM" class="headerlink" title="2. è™šæ‹ŸDOM"></a>2. è™šæ‹ŸDOM</h2><h3 id="2-1è™šæ‹ŸDOMå’ŒçœŸå®çš„DOMçš„å·®å¼‚"><a href="#2-1è™šæ‹ŸDOMå’ŒçœŸå®çš„DOMçš„å·®å¼‚" class="headerlink" title="2.1è™šæ‹ŸDOMå’ŒçœŸå®çš„DOMçš„å·®å¼‚"></a>2.1è™šæ‹ŸDOMå’ŒçœŸå®çš„DOMçš„å·®å¼‚</h3><p>1.èµ„æºæ¶ˆè€—é—®é¢˜</p><p>ä½¿ç”¨javascriptæ“ä½œçœŸå®DOMæ˜¯éå¸¸æ¶ˆè€—èµ„æºçš„ï¼Œè™½ç„¶å¾ˆå¤šæµè§ˆå™¨åšäº†ä¼˜åŒ–ä½†æ˜¯æ•ˆæœä¸å¤§ã€‚ä½ çœ‹åˆ°è™šæ‹ŸDOMæ˜¯ä¸€ä¸ªçº¯javascriptå¯¹è±¡ã€‚è€ŒDOMèŠ‚ç‚¹æœ‰70ï¼‹ä¸ªå±æ€§ï¼Œç»§æ‰¿å±‚çº§æœ‰6ï¼Œ7å±‚ï¼ˆæ–‡æœ¬èŠ‚ç‚¹6å±‚ï¼Œå…ƒç´ èŠ‚ç‚¹7å±‚ï¼‰,è®¿é—®ä¸€ä¸ªå±æ€§ï¼Œå¯èƒ½ä¼šè¿½æº¯å‡ é‡åŸå‹é“¾ã€‚</p><p>2.æ‰§è¡Œæ•ˆç‡é—®é¢˜</p><p>å¦‚æœä½ è¦ä¿®æ”¹ä¸€ä¸ªçœŸå®DOMï¼Œä¸€èˆ¬è°ƒç”¨<code>innerHTML</code>æ–¹æ³•ï¼Œé‚£æµè§ˆå™¨ä¼šæŠŠæ—§çš„èŠ‚ç‚¹ç§»é™¤å†æ·»åŠ æ–°çš„èŠ‚ç‚¹ï¼Œä½†æ˜¯åœ¨è™šæ‹ŸDOMä¸­ï¼Œåªéœ€è¦ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œå†æŠŠè™šæ‹ŸDOMæ¸²æŸ“åˆ°çœŸå®DOMä¸Šã€‚å¾ˆå¤šäººä¼šè¯¯è§£è™šæ‹ŸDOMæ¯”çœŸå®DOMé€Ÿåº¦å¿«ï¼Œå…¶å®è™šæ‹ŸDOMåªæ˜¯æŠŠDOMå˜æ›´çš„é€»è¾‘æå–å‡ºæ¥ï¼Œä½¿ç”¨javascriptè®¡ç®—å·®å¼‚ï¼Œå‡å°‘äº†æ“ä½œçœŸå®DOMçš„æ¬¡æ•°ï¼Œåªåœ¨æœ€åä¸€æ¬¡æ‰æ“ä½œçœŸå®DOMï¼Œæ‰€ä»¥å¦‚æœä½ çš„åº”ç”¨æœ‰å¤æ‚çš„DOMå˜æ›´æ“ä½œï¼Œè™šæ‹ŸDOMä¼šæ¯”è¾ƒå¿«ã€‚</p><p>3.è™šæ‹ŸDOMè¿˜æœ‰å…¶ä»–å¥½å¤„</p><p>å…¶å®è™šæ‹ŸDOMè¿˜å¯ä»¥åº”ç”¨åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› ä¸ºä»–ä»¬åªæ˜¯æŠ½è±¡èŠ‚ç‚¹ï¼Œå¯ä»¥æŠŠå®ƒç¼–è¯‘æˆå…¶ä»–å¹³å°ï¼Œä¾‹å¦‚androidã€iosã€‚å¸‚é¢ä¸Šåˆ©ç”¨å½¢åŒæ¶æ„æ¨¡å¼çš„åº”ç”¨æœ‰React Nativeï¼ŒWeeksï¼ŒNative scriptï¼Œå°±æ˜¯åˆ©ç”¨è™šæ‹ŸDOMçš„ç‰¹ç‚¹å®ç°çš„ã€‚</p><h3 id="2-2-è™šæ‹ŸDOMåœ¨çº¿æŸ¥çœ‹"><a href="#2-2-è™šæ‹ŸDOMåœ¨çº¿æŸ¥çœ‹" class="headerlink" title="2.2 è™šæ‹ŸDOMåœ¨çº¿æŸ¥çœ‹"></a>2.2 è™šæ‹ŸDOMåœ¨çº¿æŸ¥çœ‹</h3><p>ä½¿ç”¨Vue Template Explorerå¯ä»¥æŸ¥çœ‹Vueæ˜¯å¦‚ä½•è½¬æ¢è™šæ‹ŸDOMçš„ã€‚</p><p><a href="https://template-explorer.vuejs.org/">è®¿é—®åœ°å€</a></p><h2 id="3-templateå’Œjsxå¯¹æ¯”"><a href="#3-templateå’Œjsxå¯¹æ¯”" class="headerlink" title="3.templateå’Œjsxå¯¹æ¯”"></a>3.templateå’Œjsxå¯¹æ¯”</h2><p><strong>æ¨¡ç‰ˆçš„ä¼˜åŠ¿</strong>ï¼šæ¨¡ç‰ˆæ˜¯ä¸€ç§æ›´é™æ€æ›´å…·æœ‰çº¦æŸçš„è¡¨ç°å½¢æ€ï¼Œå®ƒå¯ä»¥é¿å…å‘æ˜æ–°è¯­æ³•ï¼Œä»»ä½•å¯ä»¥è§£æHTMLçš„å¼•æ“éƒ½å¯ä»¥ä½¿ç”¨å®ƒï¼Œè¿ç§»æˆæœ¬æ›´ä½ï¼›å¦å¤–æœ€é‡è¦çš„æ˜¯<strong>é™æ€æ¨¡ç‰ˆå¯ä»¥åœ¨ç¼–è¯‘è¿›è¡Œæ¯”è¾ƒå¤šçš„ä¼˜åŒ–</strong>ï¼Œè€ŒåŠ¨æ€è¯­è¨€å°±æ²¡æ³•å®ç°äº†ã€‚</p><p><strong>jsxçš„ä¼˜åŠ¿</strong>ï¼šæ›´çµæ´»ï¼Œä»»ä½•çš„jsä»£ç éƒ½å¯ä»¥æ”¾åœ¨jsxä¸­æ‰§è¡Œå®ç°ä½ æƒ³è¦çš„æ•ˆæœï¼Œä½†æ˜¯ä¹Ÿ<strong>ç”±äºä»–çš„çµæ´»æ€§å¯¼è‡´åœ¨ç¼–è¯‘é˜¶æ®µä¼˜åŒ–æ¯”è¾ƒå›°éš¾ï¼Œåªèƒ½é€šè¿‡å¼€å‘è€…è‡ªå·±ä¼˜åŒ–</strong>ã€‚</p><h2 id="4-å‡½æ•°ç»„ä»¶"><a href="#4-å‡½æ•°ç»„ä»¶" class="headerlink" title="4. å‡½æ•°ç»„ä»¶"></a>4. å‡½æ•°ç»„ä»¶</h2><p>å‡½æ•°ç»„ä»¶å°±æ˜¯ä¸åŒ…å«stateå’Œpropsçš„ç»„ä»¶ï¼Œå°±åƒå®ƒçš„åå­—ä¸€æ ·ï¼Œä½ å¯ä»¥ç†è§£ä¸ºä»–å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨Vueä¸­å£°æ˜ä¸€ä¸ªå‡½æ•°ç»„ä»¶ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = &#123;</span><br><span class="line">functional: <span class="literal">true</span>,</span><br><span class="line">    render: <span class="function"><span class="params">h</span> =&gt;</span> h(<span class="string">&#x27;div&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><ol><li>ç»„ä»¶ä¸æ”¯æŒå®ä¾‹åŒ–ã€‚</li><li>ä¼˜åŒ–æ›´ä¼˜ï¼Œå› ä¸ºåœ¨Vueä¸­å®ƒçš„æ¸²æŸ“å‡½æ•°æ¯”çˆ¶çº§ç»„ä»¶æ›´æ—©è¢«è°ƒç”¨ï¼Œä½†æ˜¯ä»–å¹¶ä¸ä¼šå ç”¨å¾ˆå¤šèµ„æºï¼Œå› ä¸ºå®ƒæ²¡æœ‰ä¿å­˜æ•°æ®å’Œå±æ€§ï¼Œæ‰€ä»¥å®ƒå¸¸ç”¨äºä¼˜åŒ–ä¸€ä¸ªæœ‰å¾ˆå¤šèŠ‚ç‚¹çš„ç»„ä»¶ã€‚</li><li>å®¹æ˜“æ‰©å±•ï¼Œå¦‚æœä½ çš„ç»„ä»¶åªæ˜¯ç”¨æ¥æ¥æ”¶ propç„¶åæ˜¾ç¤ºæ•°æ®ï¼Œæˆ–è€…ä¸€ä¸ªæ²¡æœ‰çŠ¶æ€çš„æŒ‰é’®ï¼Œå»ºè®®ä½¿ç”¨å‡½æ•°ç»„ä»¶ã€‚</li><li>å‡½æ•°ç»„ä»¶æ²¡æœ‰thisï¼Œè·å–propå¯ä»¥é€šè¿‡renderå‡½æ•°çš„ç¬¬äºŒå‚æ•°å¾—åˆ°<code>render(h, context)</code></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Vue.component(<span class="string">&#x27;example&#x27;</span>, &#123;</span><br><span class="line">    functional: <span class="literal">true</span>, <span class="comment">// å£°æ˜æ˜¯å‡½æ•°ç»„ä»¶</span></span><br><span class="line">    <span class="comment">// å› ä¸ºå‡½æ•°ç»„ä»¶æ²¡æœ‰this,å¯ä»¥é€šè¿‡renderç¬¬äºŒå‚æ•°è·å–ç›¸å…³ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="title">render</span>(<span class="params">h, &#123; props: &#123; tags &#125; &#125;</span>)</span> &#123;</span><br><span class="line">        <span class="comment">// context.slots() é€šè¿‡slotsæ–¹æ³•è·å–å­èŠ‚ç‚¹</span></span><br><span class="line">        <span class="comment">// context.children è·å–å­ç»„ä»¶</span></span><br><span class="line">        <span class="comment">// context.parent çˆ¶ç»„ä»¶ï¼Œå› ä¸ºå‡½æ•°ç»„ä»¶å®æŒ‚è½½åˆ°æ ¹èŠ‚ç‚¹ä¸Šï¼Œä¹Ÿå°±æ˜¯&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span></span><br><span class="line">        <span class="comment">// context.props ç»„ä»¶å±æ€§ï¼Œè¿™é‡Œå¾—åˆ°tagså±æ€§</span></span><br><span class="line">        <span class="comment">// return h(&#x27;div&#x27;, this.tags.map((tag, i) =&gt; h(tag, i)))</span></span><br><span class="line">        <span class="comment">// é€šè¿‡å‡½æ•°ç»„ä»¶å®ç°æ ‡ç­¾åŠ¨æ€æ¸²æŸ“</span></span><br><span class="line">        <span class="keyword">return</span> h(<span class="string">&#x27;div&#x27;</span>, tags.map(<span class="function">(<span class="params">tag, i</span>) =&gt;</span> h(tag, i)))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="5-HOC-é«˜é˜¶ç»„ä»¶"><a href="#5-HOC-é«˜é˜¶ç»„ä»¶" class="headerlink" title="5.HOC é«˜é˜¶ç»„ä»¶"></a>5.HOC é«˜é˜¶ç»„ä»¶</h2><blockquote><p>é«˜é˜¶ç»„ä»¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶ä¸€ä¸ªç»„ä»¶ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œç±»ä¼¼è£…é¥°è€…æ¨¡å¼</p></blockquote><p>è¿™é‡Œä¸å±•å¼€è¯´äº†ï¼Œå¤§æ¦‚åˆ—ä¸€ä¸‹å†™æ³•ï¼Œä¸‹é¢æ¨¡æ‹Ÿäº†ä¸€ä¸ªå›¾ç‰‡éª¨æ¶</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// mock API</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetchURL</span> (<span class="params">username, cb</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// hard coded, bonus: exercise: make it fetch from gravatar!</span></span><br><span class="line">    cb(<span class="string">&#x27;https://avatars3.githubusercontent.com/u/6128107?v=4&amp;s=200&#x27;</span>)</span><br><span class="line">  &#125;, <span class="number">500</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Avatar = &#123;</span><br><span class="line">  props: [<span class="string">&#x27;src&#x27;</span>],</span><br><span class="line">  template: <span class="string">`&lt;img :src=&quot;src&quot;&gt;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">withAvatarURL</span> (<span class="params">InnerComponent</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    props: &#123;</span><br><span class="line">      attrs: <span class="built_in">this</span>.$attrs, <span class="comment">// 2.4 only</span></span><br><span class="line">      username: <span class="built_in">String</span></span><br><span class="line">    &#125;,</span><br><span class="line">    data () &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        url: <span class="string">&#x27;http://via.placeholder.com/200x200&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    created () &#123;</span><br><span class="line">      fetchURL(<span class="built_in">this</span>.username, <span class="function">(<span class="params">url</span>) =&gt;</span> &#123; <span class="built_in">this</span>.url = url &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    render (h) &#123;</span><br><span class="line">      <span class="keyword">return</span> h(InnerComponent, &#123; <span class="attr">props</span>: &#123; <span class="attr">src</span>: <span class="built_in">this</span>.url &#125; &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> SmartAvatar = withAvatarURL(Avatar)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">  components: &#123; SmartAvatar &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol><li><strong>é‡ç”¨æ€§</strong>ï¼šå› ä¸ºminxinå¯¹åŸç»„ä»¶å…·æœ‰ä¾µå…¥æ€§ï¼Œè¿™ä¼šå¯¼è‡´åŸæ¥ç»„ä»¶çš„å¯é‡ç”¨æ€§é™ä½ï¼Œè€Œé«˜é˜¶ç»„ä»¶ä¸ä¼šï¼Œé«˜é˜¶ç»„ä»¶å¯¹åŸç»„ä»¶åªæ˜¯ä¸€ä¸ªè°ƒç”¨å…³ç³»ï¼Œå¹¶æ²¡æœ‰ä¿®æ”¹åŸæ¥ç»„ä»¶ä»»ä½•å†…å®¹ã€‚</li><li><strong>å¯æµ‹è¯•æ€§</strong>ï¼šå› ä¸ºé«˜é˜¶ç»„ä»¶åªæ˜¯ä¸€ä¸ªåµŒå¥—å…³ç³»ï¼Œåœ¨ç»„ä»¶æµ‹è¯•çš„æ—¶å€™ï¼Œå¯ä»¥å•ç‹¬çš„æµ‹è¯•åŸå§‹ç»„ä»¶å’Œé«˜é˜¶ç»„ä»¶ã€‚</li><li><strong>å±‚çº§é—®é¢˜</strong>ï¼šé«˜é˜¶ç»„ä»¶ä¹Ÿæœ‰ä»–çš„å¼Šç«¯ï¼Œå¦‚æœä½ é«˜é˜¶ç»„ä»¶åµŒå¥—å±‚çº§å¤ªæ·±ï¼Œä¼šå¯¼è‡´å‡ºé”™çš„æ—¶å€™è°ƒè¯•å›°éš¾çš„é—®é¢˜ï¼Œæ‰€ä»¥åˆ°åº•ä½¿ç”¨é«˜é˜¶ç»„ä»¶å’Œminxinéœ€è¦çœ‹å®é™…åœºæ™¯ã€‚</li></ol><h2 id="6-è·¯ç”±"><a href="#6-è·¯ç”±" class="headerlink" title="6. è·¯ç”±"></a>6. è·¯ç”±</h2><p>å®ç°æ ¹æ®è·¯ç”±åŒ¹é…æ˜¾ç¤ºç»„ä»¶ï¼Œå¹¶è·¯ç”±åŒ¹é…å‚æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç»„ä»¶</span></span><br><span class="line"><span class="keyword">const</span> Foo = &#123;</span><br><span class="line">    props: [<span class="string">&#x27;id&#x27;</span>],</span><br><span class="line">    template: <span class="string">`&lt;div&gt;foo with id: &#123;&#123; id &#125;&#125;&lt;/div&gt;`</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> Bar = &#123; <span class="attr">template</span>: <span class="string">`&lt;div&gt;bar&lt;/div&gt;`</span> &#125;</span><br><span class="line"><span class="keyword">const</span> NotFound = &#123; <span class="attr">template</span>: <span class="string">`&lt;div&gt;not found!&lt;/div&gt;`</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·¯ç”±è¡¨</span></span><br><span class="line"><span class="keyword">const</span> routeTable = &#123;</span><br><span class="line">    <span class="string">&#x27;/foo/:id&#x27;</span>: Foo,</span><br><span class="line">    <span class="string">&#x27;/bar&#x27;</span>: Bar</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†è·¯ç”±è¡¨çš„é”®é€šè¿‡ path-to-regexpåº“ è¿›è¡Œæ­£åˆ™å°è£…</span></span><br><span class="line"><span class="comment">// ä¸‹é¢è¿™ä¸ªæ•°ç»„å‚¨å­˜ï¼šç»„ä»¶ã€æ­£åˆ™å¯¹è±¡ã€åŒ¹é…çš„name</span></span><br><span class="line"><span class="keyword">const</span> compiledRoutes = []</span><br><span class="line"><span class="built_in">Object</span>.keys(routeTable).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> dynamicSegments = []</span><br><span class="line">    <span class="keyword">const</span> regex = pathToRegexp(key, dynamicSegments)</span><br><span class="line">    <span class="keyword">const</span> component = routeTable[key]</span><br><span class="line">    compiledRoutes.push(&#123;</span><br><span class="line">        component,</span><br><span class="line">        regex,</span><br><span class="line">        dynamicSegments</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬hashchangeï¼Œå°†æ”¹å˜çš„è·¯ç”±èµ‹å€¼ç»™url</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&#x27;hashchange&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    app.url = <span class="built_in">window</span>.location.hash.slice(<span class="number">1</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        url: <span class="built_in">window</span>.location.hash.slice(<span class="number">1</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    render (h) &#123;</span><br><span class="line">        <span class="keyword">const</span> path = <span class="string">&#x27;/&#x27;</span> + <span class="built_in">this</span>.url</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> componentToRender <span class="comment">// è¦æ¸²æŸ“çš„ç»„ä»¶</span></span><br><span class="line">        <span class="keyword">let</span> props = &#123;&#125; <span class="comment">// è·¯ç”±åŒ¹é…åˆ°çš„å€¼</span></span><br><span class="line"></span><br><span class="line">        compiledRoutes.some(<span class="function"><span class="params">route</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> match = route.regex.exec(path) <span class="comment">// æ‰§è¡ŒåŒ¹é…</span></span><br><span class="line">            componentToRender = NotFound</span><br><span class="line">            <span class="keyword">if</span> (match) &#123;</span><br><span class="line">                componentToRender = route.component</span><br><span class="line">                <span class="comment">// è®¾ç½®å‚æ•°</span></span><br><span class="line">                route.dynamicSegments.forEach(<span class="function">(<span class="params">segment, index</span>) =&gt;</span> &#123;</span><br><span class="line">                    props[segment.name] = match[index + <span class="number">1</span>]</span><br><span class="line">                &#125;)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> h(<span class="string">&#x27;div&#x27;</span>, [</span><br><span class="line">            h(componentToRender, &#123; props &#125;),</span><br><span class="line">            h(<span class="string">&#x27;a&#x27;</span>, &#123; <span class="attr">attrs</span>: &#123; <span class="attr">href</span>: <span class="string">&#x27;#foo/123&#x27;</span> &#125;&#125;, <span class="string">&#x27;foo 123&#x27;</span>),</span><br><span class="line">            <span class="string">&#x27; | &#x27;</span>,</span><br><span class="line">            h(<span class="string">&#x27;a&#x27;</span>, &#123; <span class="attr">attrs</span>: &#123; <span class="attr">href</span>: <span class="string">&#x27;#foo/234&#x27;</span> &#125;&#125;, <span class="string">&#x27;foo 234&#x27;</span>),</span><br><span class="line">            <span class="string">&#x27; | &#x27;</span>,</span><br><span class="line">            h(<span class="string">&#x27;a&#x27;</span>, &#123; <span class="attr">attrs</span>: &#123; <span class="attr">href</span>: <span class="string">&#x27;#bar&#x27;</span> &#125;&#125;, <span class="string">&#x27;bar&#x27;</span>),</span><br><span class="line">            <span class="string">&#x27; | &#x27;</span>,</span><br><span class="line">            h(<span class="string">&#x27;a&#x27;</span>, &#123; <span class="attr">attrs</span>: &#123; <span class="attr">href</span>: <span class="string">&#x27;#garbage&#x27;</span> &#125;&#125;, <span class="string">&#x27;garbage&#x27;</span>)</span><br><span class="line">        ])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å°¤é›¨æºªFrontend-Masterè¯¾ç¨‹ç¬”è®°&quot;&gt;&lt;a href=&quot;#å°¤é›¨æºªFrontend-Masterè¯¾ç¨‹ç¬”è®°&quot; class=&quot;headerlink&quot; title=&quot;å°¤é›¨æºªFrontend Masterè¯¾ç¨‹ç¬”è®°&quot;&gt;&lt;/a&gt;å°¤é›¨æºªFrontend Masterè¯¾ç¨‹
      
    
    </summary>
    
    
      <category term="å‰ç«¯" scheme="https://liang5757.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="vue" scheme="https://liang5757.github.io/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>MPAé¦–å±åŠ è½½é€Ÿç‡ä¼˜åŒ–å®æˆ˜</title>
    <link href="https://liang5757.github.io/2021/02/14/Webpack/MPA%E9%A6%96%E5%B1%8F%E5%8A%A0%E8%BD%BD%E9%80%9F%E7%8E%87%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98/"/>
    <id>https://liang5757.github.io/2021/02/14/Webpack/MPA%E9%A6%96%E5%B1%8F%E5%8A%A0%E8%BD%BD%E9%80%9F%E7%8E%87%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98/</id>
    <published>2021-02-14T07:45:27.000Z</published>
    <updated>2021-02-14T07:48:02.536Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MPAé¦–å±åŠ è½½é€Ÿç‡ä¼˜åŒ–å®æˆ˜"><a href="#MPAé¦–å±åŠ è½½é€Ÿç‡ä¼˜åŒ–å®æˆ˜" class="headerlink" title="MPAé¦–å±åŠ è½½é€Ÿç‡ä¼˜åŒ–å®æˆ˜"></a>MPAé¦–å±åŠ è½½é€Ÿç‡ä¼˜åŒ–å®æˆ˜</h1><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>â€‹    å­¦æ ¡å®éªŒå®¤çš„é¡¹ç›®ï¼Œå› ä¸ºå­¦æ ¡åªå¼€æ”¾ç»™æˆ‘ä»¬ä¸€ä¸ªç«¯å£ï¼Œæ‰€ä»¥åªèƒ½æŠŠåå°ç®¡ç†å’Œå­¦ç”Ÿç«¯åˆå¹¶æˆå¤šé¡µåº”ç”¨ï¼Œæˆ‘æ˜¯åšåå°ç®¡ç†çš„ï¼Œè€å¸ˆè¦æ±‚æŸä¸ªåŠŸèƒ½è¦åŠ ä¸Šä»£ç é«˜äº®ï¼Œåœ¨å…¨å±€å¼•å…¥highlight.jsåå‘ç°é¦–å±åŠ è½½é€Ÿç‡ä¸è¡Œäº†ï¼Œè®°å½•ä¸€ä¸‹å‘ç°æ›´å¤šé—®é¢˜å¹¶ä¼˜åŒ–çš„è¿‡ç¨‹ã€‚</p><h2 id="æœ‰ç”¨çš„ä¼˜åŒ–"><a href="#æœ‰ç”¨çš„ä¼˜åŒ–" class="headerlink" title="æœ‰ç”¨çš„ä¼˜åŒ–"></a>æœ‰ç”¨çš„ä¼˜åŒ–</h2><h3 id="1-HighLight-jsè¢«æ”¾åœ¨é¦–å±åŠ è½½äº†"><a href="#1-HighLight-jsè¢«æ”¾åœ¨é¦–å±åŠ è½½äº†" class="headerlink" title="1. HighLight.jsè¢«æ”¾åœ¨é¦–å±åŠ è½½äº†"></a>1. HighLight.jsè¢«æ”¾åœ¨é¦–å±åŠ è½½äº†</h3><p>é¦–å…ˆç”¨<code>webpack-bundle-analyer</code>è¿›è¡Œæ„å»ºåˆ†æ</p><p><img src= "/img/loading.gif" data-lazy-src="/2021/02/14/Webpack/MPA%E9%A6%96%E5%B1%8F%E5%8A%A0%E8%BD%BD%E9%80%9F%E7%8E%87%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98/image-20210126203158808-1613288799701.png" alt="image-20210126203158808"></p><p>å‘ç°äº†ä¸¤ä¸ªå·¨å¤§çš„åŒ…<code>chunk-vendors.44cd6d2c.js</code>æœ‰2.4MBï¼Œ<code>chunk-94715762.bb0c42f0.js</code>æœ‰1.4MBï¼Œä¸å¹¸çš„æ˜¯cç«¯éœ€è¦åœ¨é¦–å±åŒæ—¶ä¸‹è½½ä¸¤ä¸ªå¤§åŒ…ï¼ˆæ­¤å¤„æœ‰è¯¯ï¼Œåé¢è®²è§£ï¼Œæ­£ç¡®çš„æ˜¯å·¦è¾¹è¿™ä¸ªåŒ…åŠ å…¥å£ï¼‰æ‰å¼€å§‹æ¸²æŸ“ï¼Œè€Œcç«¯å¹¶æ²¡æœ‰ç”¨åˆ°<code>highlight.js</code>ä½†æ˜¯ä»–ä¹Ÿå¾—ç­‰å¾…ä¸‹è½½ã€‚</p><p>ç„¶åæŠŠ<code>highlight.js</code>æ”¾åˆ°å°è£…çš„ç»„ä»¶é‡Œå¼•ç”¨ï¼Œç„¶åæ‰“åŒ…åˆ†æ</p><p><img src= "/img/loading.gif" data-lazy-src="/2021/02/14/Webpack/MPA%E9%A6%96%E5%B1%8F%E5%8A%A0%E8%BD%BD%E9%80%9F%E7%8E%87%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98/image-20210126204428302.png" alt="image-20210126204428302"></p><p>å‘ç°å°±åˆ†ç¦»äº†ï¼Œ<strong>2.4MBçš„åŒ…å˜æˆäº†1.5MB</strong></p><h3 id="2-ä¸¤ä¸ªåº”ç”¨ä½¿ç”¨çš„elementç»„ä»¶æ²¡æœ‰åˆ†ç¦»"><a href="#2-ä¸¤ä¸ªåº”ç”¨ä½¿ç”¨çš„elementç»„ä»¶æ²¡æœ‰åˆ†ç¦»" class="headerlink" title="2. ä¸¤ä¸ªåº”ç”¨ä½¿ç”¨çš„elementç»„ä»¶æ²¡æœ‰åˆ†ç¦»"></a>2. ä¸¤ä¸ªåº”ç”¨ä½¿ç”¨çš„elementç»„ä»¶æ²¡æœ‰åˆ†ç¦»</h3><p>ä½†æ˜¯åˆå‘ç°äº†æ–°çš„é—®é¢˜â€”â€”<code>element-ui</code>ä¸¤ä¸ªåº”ç”¨ä½¿ç”¨çš„ç»„ä»¶è¢«æ‰“åŒ…åˆ°äº†ä¸€èµ·ï¼Œå³æ—¶cç«¯æ²¡æœ‰ä½¿ç”¨åˆ°è¯¸å¦‚<code>el-upload</code>ã€<code>el-pagination</code>ç­‰ç»„ä»¶ï¼Œä½†æ˜¯ä¹Ÿè¦é¦–å±ä¹Ÿè¦ä¸‹è½½ï¼Œæƒ³äº†æƒ³<code>highlight.js</code>è¢«æ”¾åˆ°bç«¯å…¥å£æ–‡ä»¶å¼•å…¥å°±è¢«æ‰“è¿›è¿™ä¸ªåŒ…é‡Œã€‚</p><p>æ˜¯ä¸æ˜¯<strong>ä¸¤ä¸ªå…¥å£ä½¿ç”¨äº†åŒä¸€ä¸ªelementæŒ‰éœ€å¼•å…¥æ–‡ä»¶çš„åŸå› </strong>ï¼Œç„¶åæˆ‘ç»™<strong>ä¸¤ä¸ªåº”ç”¨å„å¼€äº†è‡ªå·±çš„æŒ‰éœ€å¼•å…¥æ–‡ä»¶</strong>ã€‚<strong>æ‰“åŒ…åˆ†ææ²¡å•¥å˜åŒ–</strong>ã€‚</p><p>é—®äº†å¤§å“¥ï¼Œå¤§å“¥ç”©æ‰‹å°±æ˜¯ä¸€ä¸ªè¿æ¥<a href="https://www.cnblogs.com/HYZhou2018/p/10419703.html">https://www.cnblogs.com/HYZhou2018/p/10419703.html</a></p><p>å¤§æ¦‚å°±æ˜¯<code>vue-cli3</code>çš„è„šæ‰‹æ¶é…ç½®è‡ªåŠ¨åˆ†åŒ…çš„æ—¶å€™æ˜¯é’ˆå¯¹å•é¡µåº”ç”¨çš„ï¼Œä¸‹é¢æ˜¯<code>vue-cli3</code>çš„é…ç½®é¡¹</p><p><img src= "/img/loading.gif" data-lazy-src="/2021/02/14/Webpack/MPA%E9%A6%96%E5%B1%8F%E5%8A%A0%E8%BD%BD%E9%80%9F%E7%8E%87%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98/image-20210126205853873.png" alt="image-20210126205853873"></p><p><code>splitChunks</code>é»˜è®¤<code>minChunks</code>æ˜¯1ï¼Œä½†æ˜¯æˆ‘ä»¬æ˜¯å¤šé¡µåº”ç”¨å•Šï¼Œæ‰€ä»¥ä¸¤ä¸ªåº”ç”¨ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“å…¨è¢«æŠ½ç¦»åˆ°ä¸€ä¸ª<code>chunk-vendor.js</code>äº†ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">config.optimization.splitChunks(&#123;</span><br><span class="line">    cacheGroups: &#123;</span><br><span class="line">        vendors: &#123;</span><br><span class="line">            name: <span class="string">&#x27;chunk-vendors&#x27;</span>,</span><br><span class="line">            minChunks: <span class="number">2</span>, <span class="comment">// è®¾ç½®ä¸º2ï¼Œä¸¤ä¸ªåº”ç”¨åŒæ—¶ä½¿ç”¨æ‰æŠ½ç¦»</span></span><br><span class="line">            test: <span class="regexp">/node_modules/</span>,</span><br><span class="line">            priority: -<span class="number">10</span>,</span><br><span class="line">            chunks: <span class="string">&#x27;initial&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        common: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å†æ¬¡æ‰“åŒ…åˆ†æ</p><p><img src= "/img/loading.gif" data-lazy-src="/2021/02/14/Webpack/MPA%E9%A6%96%E5%B1%8F%E5%8A%A0%E8%BD%BD%E9%80%9F%E7%8E%87%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98/image-20210126210625547.png" alt="image-20210126210625547"></p><p>ä¸ä»…åˆ†ç¦»äº†ä¸€äº›ç»„ä»¶ï¼Œè¿˜æŠŠä¸€äº›ä½¿ç”¨åˆ°çš„ç¬¬ä¸‰æ–¹åº“ç»™åˆ†ç¦»äº†ï¼Œè¿™ä¸ª2.4MBçš„æ‰“åŒ…åˆ°æ­¤ä¸ºæ­¢å°±å˜æˆäº†<strong>1.2MB</strong>çš„åŒ…ã€‚</p><h2 id="èµ°è¿‡çš„å‘"><a href="#èµ°è¿‡çš„å‘" class="headerlink" title="èµ°è¿‡çš„å‘"></a>èµ°è¿‡çš„å‘</h2><h3 id="1-æ€ä¹ˆcodingåŒ…è¿˜æ˜¯åœ¨é¦–å±ä¸‹è½½äº†"><a href="#1-æ€ä¹ˆcodingåŒ…è¿˜æ˜¯åœ¨é¦–å±ä¸‹è½½äº†" class="headerlink" title="1.æ€ä¹ˆcodingåŒ…è¿˜æ˜¯åœ¨é¦–å±ä¸‹è½½äº†"></a>1.æ€ä¹ˆcodingåŒ…è¿˜æ˜¯åœ¨é¦–å±ä¸‹è½½äº†</h3><p>å·²ç»ä½¿ç”¨äº†è·¯ç”±æ‡’åŠ è½½ï¼Œä¸ºä»€ä¹ˆcodingåŒ…è¿˜æ˜¯åœ¨é¦–å±ä¸‹è½½äº†ï¼Œæˆ‘æ›¾ä¸€åº¦ä»¥ä¸ºæ˜¯æ²¡æœ‰<a href="https://babeljs.io/docs/plugins/syntax-dynamic-import/"><code>syntax-dynamic-import</code></a>è¿™ä¸ªæ’ä»¶çš„åŸå› ï¼Œè¿˜è£…è¿‡äº†è¯•äº†ä¸‹ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œè€Œä¸”webpackå·²ç»ä½¿ç”¨åŠ¨æ€importæ¥åšåˆ°æ‡’åŠ è½½äº†ã€‚</p><p>æŸ¥é˜…<a href="https://blog.csdn.net/sinat_35538827/article/details/87969834">æ–‡ç« </a>å‘ç°</p><p>åŸæ¥ vue-cli3 é»˜è®¤ä¼šæŠŠæ‰€æœ‰é€šè¿‡<code>import()</code>æŒ‰éœ€åŠ è½½çš„javascriptæ–‡ä»¶åŠ ä¸Š prefetch ã€‚</p><p><strong>prefetchæ˜¯ä»€ä¹ˆï¼Ÿ</strong>åœ¨æ‰“åŒ…åçš„æ–‡ä»¶ä¸­ï¼ŒæŸ¥çœ‹index.htmlæˆ‘ä»¬ä¼šå‘ç°ç±»ä¼¼è¿™ä¸ª <link href="/js/chunk-118075e7.5725ab1a.js" rel="prefetch">ã€‚<link rel="prefetch">ä¼šåœ¨é¡µé¢åŠ è½½å®Œæˆåï¼Œåˆ©ç”¨ç©ºé—²æ—¶é—´æå‰åŠ è½½è·å–ç”¨æˆ·æœªæ¥å¯èƒ½ä¼šè®¿é—®çš„å†…å®¹ã€‚</p><p><strong>prefetché“¾æ¥ä¼šæ¶ˆè€—å®½å¸¦ï¼Œå¦‚æœæ˜¯åœ¨ç§»åŠ¨ç«¯ï¼Œè€Œä¸”å­˜åœ¨å¤§é‡çš„chunkï¼Œé‚£ä¹ˆå¯ä»¥å…³æ‰ prefetch é“¾æ¥ï¼Œæ‰‹åŠ¨é€‰æ‹©è¦æå‰è·å–çš„ä»£ç åŒºå—ã€‚</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ‰‹åŠ¨é€‰å®šè¦æå‰è·å–çš„ä»£ç </span></span><br><span class="line"><span class="keyword">import</span>(webpackPrefetch: <span class="literal">true</span>, <span class="string">&#x27;./someAsyncComponent.vue&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>å…³é—­prefetch:</strong> (å®˜ç½‘ç¤ºä¾‹)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ç§»é™¤ prefetch æ’ä»¶</span></span><br><span class="line">    config.plugins.delete(<span class="string">&#x27;prefetch&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// æˆ–è€…</span></span><br><span class="line">    <span class="comment">// ä¿®æ”¹å®ƒçš„é€‰é¡¹ï¼š</span></span><br><span class="line">    config.plugin(<span class="string">&#x27;prefetch&#x27;</span>).tap(<span class="function"><span class="params">options</span> =&gt;</span> &#123;</span><br><span class="line">      options[<span class="number">0</span>].fileBlacklist = options[<span class="number">0</span>].fileBlacklist || []</span><br><span class="line">      options[<span class="number">0</span>].fileBlacklist.push(<span class="regexp">/myasyncRoute(.)+?\.js$/</span>)</span><br><span class="line">      <span class="keyword">return</span> options</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-ç¬¬ä¸‰æ–¹åº“æ€ä¹ˆè¿™ä¹ˆå¤šé‡å¤çš„bn-js"><a href="#2-ç¬¬ä¸‰æ–¹åº“æ€ä¹ˆè¿™ä¹ˆå¤šé‡å¤çš„bn-js" class="headerlink" title="2. ç¬¬ä¸‰æ–¹åº“æ€ä¹ˆè¿™ä¹ˆå¤šé‡å¤çš„bn.js"></a>2. ç¬¬ä¸‰æ–¹åº“æ€ä¹ˆè¿™ä¹ˆå¤šé‡å¤çš„bn.js</h3><p><img src= "/img/loading.gif" data-lazy-src="/2021/02/14/Webpack/MPA%E9%A6%96%E5%B1%8F%E5%8A%A0%E8%BD%BD%E9%80%9F%E7%8E%87%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98/image-20210126212734717.png" alt="image-20210126212734717"></p><p>å¯ä»¥çœ‹åˆ°æœ‰8ä¸ªé‡å¤çš„<code>bn.js</code>ï¼Œä¸€ä¸ª40KBï¼Œgzipå10KBï¼Œç¦»è°±ã€‚</p><p>ä½†æ˜¯å¤§å°æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¯èƒ½<strong>ç”¨çš„ç‰ˆæœ¬ä¸åŒ</strong>ï¼Œç›®å‰æ²¡æœ‰å¥½çš„æ–¹æ³•æŠ½ç¦»ã€‚ã€‚</p><p>å…¶å®å¯ä»¥ç”¨cdnæ¥æï¼Œä½†æ˜¯ç¬¬ä¸‰æ–¹çš„cdnä¸ç¨³å®šï¼Œå°±æ²¡æã€‚</p><h3 id="3-æ‰“åŒ…åmini-css-extract-pluginè­¦å‘ŠConflicting-order"><a href="#3-æ‰“åŒ…åmini-css-extract-pluginè­¦å‘ŠConflicting-order" class="headerlink" title="3. æ‰“åŒ…åmini-css-extract-pluginè­¦å‘ŠConflicting order"></a>3. æ‰“åŒ…åmini-css-extract-pluginè­¦å‘ŠConflicting order</h3><p>å¯¹åº”çš„issusï¼š<a href="https://github.com/webpack-contrib/mini-css-extract-plugin/issues/250">https://github.com/webpack-contrib/mini-css-extract-plugin/issues/250</a></p><p>æ˜¯ç”±äºç»„ä»¶ä½¿ç”¨é¡ºåºä¸ä¸€è‡´å¯¼è‡´çš„ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;MPAé¦–å±åŠ è½½é€Ÿç‡ä¼˜åŒ–å®æˆ˜&quot;&gt;&lt;a href=&quot;#MPAé¦–å±åŠ è½½é€Ÿç‡ä¼˜åŒ–å®æˆ˜&quot; class=&quot;headerlink&quot; title=&quot;MPAé¦–å±åŠ è½½é€Ÿç‡ä¼˜åŒ–å®æˆ˜&quot;&gt;&lt;/a&gt;MPAé¦–å±åŠ è½½é€Ÿç‡ä¼˜åŒ–å®æˆ˜&lt;/h1&gt;&lt;h2 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; cla
      
    
    </summary>
    
    
      <category term="å‰ç«¯" scheme="https://liang5757.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="Webpack" scheme="https://liang5757.github.io/tags/Webpack/"/>
    
  </entry>
  
  <entry>
    <title>é€‚é…å™¨æ¨¡å¼</title>
    <link href="https://liang5757.github.io/2021/02/11/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
    <id>https://liang5757.github.io/2021/02/11/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/</id>
    <published>2021-02-11T07:38:26.000Z</published>
    <updated>2021-05-05T17:07:27.751Z</updated>
    
    <content type="html"><![CDATA[<h1 id="é€‚é…å™¨æ¨¡å¼"><a href="#é€‚é…å™¨æ¨¡å¼" class="headerlink" title="é€‚é…å™¨æ¨¡å¼"></a>é€‚é…å™¨æ¨¡å¼</h1><blockquote><p>é€‚é…å™¨æ¨¡å¼çš„ä½œç”¨æ˜¯è§£å†³ä¸¤ä¸ªè½¯ä»¶å®ä½“é—´çš„æ¥å£ä¸å…¼å®¹çš„é—®é¢˜ã€‚ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ä¹‹åï¼ŒåŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½å·¥ä½œçš„ä¸¤ä¸ªè½¯ä»¶å®ä½“å¯ä»¥ä¸€èµ·å·¥ä½œã€‚ é€‚é…å™¨çš„åˆ«åæ˜¯åŒ…è£…å™¨(wrapper)ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å¯¹ç®€å•çš„æ¨¡å¼</p></blockquote><p>åœ¨ç¨‹åºå¼€å‘ä¸­æœ‰è®¸å¤šè¿™æ ·çš„åœºæ™¯ï¼šå½“æˆ‘ä»¬è¯•å›¾è°ƒç”¨æ¨¡å—æˆ–è€…å¯¹è±¡çš„æŸä¸ªæ¥å£æ—¶ï¼Œå´å‘ç°è¿™ä¸ªæ¥å£çš„æ ¼å¼å¹¶ä¸ç¬¦åˆç›®å‰çš„éœ€æ±‚ã€‚ è¿™æ—¶å€™æœ‰ä¸¤ç§è§£å†³åŠæ³•ï¼Œç¬¬ä¸€ç§æ˜¯ä¿®æ”¹åŸæ¥çš„æ¥å£å®ç°ï¼Œä½†å¦‚æœåŸæ¥çš„æ¨¡å—å¾ˆå¤æ‚ï¼Œæˆ–è€…æˆ‘ä»¬æ‹¿åˆ°çš„æ¨¡å—æ˜¯ä¸€æ®µåˆ«äººç¼–å†™çš„ç»è¿‡å‹ç¼©çš„ä»£ç ï¼Œä¿®æ”¹åŸæ¥å£å°±æ˜¾å¾—ä¸å¤ªç°å®äº†ã€‚ç¬¬äºŒç§åŠæ³•æ˜¯åˆ›å»ºä¸€ä¸ªé€‚é…å™¨ï¼Œå°†åŸæ¥å£è½¬æ¢ä¸ºå®¢æˆ·å¸Œæœ›çš„å¦ä¸€ä¸ªæ¥å£ï¼Œå®¢æˆ·åªéœ€è¦å’Œé€‚é…å™¨æ‰“äº¤é“ã€‚</p><h2 id="æ•…äº‹èƒŒæ™¯"><a href="#æ•…äº‹èƒŒæ™¯" class="headerlink" title="æ•…äº‹èƒŒæ™¯"></a>æ•…äº‹èƒŒæ™¯</h2><p>ç°åœ¨ä½¿ç”¨ è°·æ­Œåœ°å›¾ å’Œ ç™¾åº¦åœ°å›¾ åœ¨é¡µé¢å±•ç°åœ°å›¾</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> googleMap = &#123;</span><br><span class="line">  show: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> baiduMap = &#123;</span><br><span class="line">  show: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> renderMap = <span class="function"><span class="keyword">function</span> (<span class="params">map</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (map.show <span class="keyword">instanceof</span> <span class="built_in">Function</span>) &#123;</span><br><span class="line">    map.show();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">renderMap(googleMap); <span class="comment">// è¾“å‡º:å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾</span></span><br><span class="line">renderMap(baiduMap); <span class="comment">// è¾“å‡º:å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç èƒ½å¤Ÿè¿è¡ŒæˆåŠŸæ˜¯å› ä¸ºä¸¤ä¸ªç¬¬ä¸‰æ–¹å‡ä¸ºshowæ–¹æ³•ï¼Œå¦‚æœä¸¤ä¸ªæ¥å£æä¾›è°ƒç”¨çš„æ–¹å¼ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆå°±ä¸èƒ½è¿è¡Œäº†</p><h2 id="é‡æ„"><a href="#é‡æ„" class="headerlink" title="é‡æ„"></a>é‡æ„</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> googleMap = &#123;</span><br><span class="line">  show: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> baiduMap = &#123;</span><br><span class="line">  display: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> baiduMapAdapter = &#123;</span><br><span class="line">  show: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> baiduMap.display();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> renderMap = <span class="function"><span class="keyword">function</span> (<span class="params">map</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (map.show <span class="keyword">instanceof</span> <span class="built_in">Function</span>) &#123;</span><br><span class="line">    map.show();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">renderMap(googleMap); <span class="comment">// è¾“å‡º:å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾</span></span><br><span class="line">renderMap(baiduMapAdapter); <span class="comment">// è¾“å‡º:å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾</span></span><br></pre></td></tr></table></figure><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><ul><li>é€‚é…å™¨æ¨¡å¼ä¸»è¦ç”¨æ¥è§£å†³ä¸¤ä¸ªå·²æœ‰æ¥å£ä¹‹é—´ä¸åŒ¹é…çš„é—®é¢˜ï¼Œå®ƒä¸è€ƒè™‘è¿™äº›æ¥å£æ˜¯æ€æ ·å®ç°çš„ï¼Œä¹Ÿä¸è€ƒè™‘å®ƒä»¬å°†æ¥å¯èƒ½ä¼šå¦‚ä½•æ¼”åŒ–ã€‚é€‚é…å™¨æ¨¡å¼ä¸éœ€è¦æ”¹å˜å·²æœ‰çš„æ¥å£ï¼Œå°±èƒ½å¤Ÿä½¿å®ƒä»¬ååŒä½œç”¨ã€‚</li><li>è£…é¥°è€…æ¨¡å¼å’Œä»£ç†æ¨¡å¼ä¹Ÿä¸ä¼šæ”¹å˜åŸæœ‰å¯¹è±¡çš„æ¥å£ï¼Œä½†è£…é¥°è€…æ¨¡å¼çš„ä½œç”¨æ˜¯ä¸ºäº†ç»™å¯¹è±¡å¢åŠ åŠŸèƒ½ã€‚è£…é¥°è€…æ¨¡å¼å¸¸å¸¸å½¢æˆä¸€æ¡é•¿çš„è£…é¥°é“¾ï¼Œè€Œé€‚é…å™¨æ¨¡å¼é€šå¸¸åªåŒ…è£…ä¸€æ¬¡ã€‚ä»£ç†æ¨¡å¼æ˜¯ä¸ºäº†æ§åˆ¶å¯¹å¯¹è±¡çš„è®¿é—®ï¼Œé€šå¸¸ä¹ŸåªåŒ…è£…ä¸€æ¬¡ã€‚</li><li>å¤–è§‚æ¨¡å¼çš„ä½œç”¨å€’æ˜¯å’Œé€‚é…å™¨æ¯”è¾ƒç›¸ä¼¼ï¼Œæœ‰äººæŠŠå¤–è§‚æ¨¡å¼çœ‹æˆä¸€ç»„å¯¹è±¡çš„é€‚é…å™¨ï¼Œä½†å¤–è§‚æ¨¡å¼æœ€æ˜¾è‘—çš„ç‰¹ç‚¹æ˜¯å®šä¹‰äº†ä¸€ä¸ªæ–°çš„æ¥å£ã€‚</li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;é€‚é…å™¨æ¨¡å¼&quot;&gt;&lt;a href=&quot;#é€‚é…å™¨æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;é€‚é…å™¨æ¨¡å¼&quot;&gt;&lt;/a&gt;é€‚é…å™¨æ¨¡å¼&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;é€‚é…å™¨æ¨¡å¼çš„ä½œç”¨æ˜¯è§£å†³ä¸¤ä¸ªè½¯ä»¶å®ä½“é—´çš„æ¥å£ä¸å…¼å®¹çš„é—®é¢˜ã€‚ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ä¹‹åï¼ŒåŸæœ¬ç”±äºæ¥å£ä¸
      
    
    </summary>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>çŠ¶æ€æ¨¡å¼</title>
    <link href="https://liang5757.github.io/2021/02/10/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/"/>
    <id>https://liang5757.github.io/2021/02/10/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/</id>
    <published>2021-02-10T07:38:03.000Z</published>
    <updated>2021-05-05T17:07:38.636Z</updated>
    
    <content type="html"><![CDATA[<h1 id="çŠ¶æ€æ¨¡å¼"><a href="#çŠ¶æ€æ¨¡å¼" class="headerlink" title="çŠ¶æ€æ¨¡å¼"></a>çŠ¶æ€æ¨¡å¼</h1><blockquote><p>å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»</p><p>çŠ¶æ€æ¨¡å¼çš„å…³é”®æ˜¯åŒºåˆ†äº‹ç‰©å†…éƒ¨çš„çŠ¶æ€ï¼Œäº‹ç‰©å†…éƒ¨çŠ¶æ€çš„æ”¹å˜å¾€å¾€ä¼šå¸¦æ¥äº‹ç‰©çš„è¡Œä¸ºæ”¹å˜</p></blockquote><h2 id="æ•…äº‹èƒŒæ™¯"><a href="#æ•…äº‹èƒŒæ™¯" class="headerlink" title="æ•…äº‹èƒŒæ™¯"></a>æ•…äº‹èƒŒæ™¯</h2><p>æˆ‘ä»¬æ¥æƒ³è±¡è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šæœ‰ä¸€ä¸ªç”µç¯ï¼Œç”µç¯ä¸Šé¢åªæœ‰ä¸€ä¸ªå¼€å…³ã€‚å½“ç”µç¯å¼€ç€çš„æ—¶å€™ï¼Œæ­¤æ—¶ æŒ‰ä¸‹å¼€å…³ï¼Œç”µç¯ä¼šåˆ‡æ¢åˆ°å…³é—­çŠ¶æ€;å†æŒ‰ä¸€æ¬¡å¼€å…³ï¼Œç”µç¯åˆå°†è¢«æ‰“å¼€ã€‚åŒä¸€ä¸ªå¼€å…³æŒ‰é’®ï¼Œåœ¨ä¸åŒ çš„çŠ¶æ€ä¸‹ï¼Œè¡¨ç°å‡ºæ¥çš„è¡Œä¸ºæ˜¯ä¸ä¸€æ ·çš„ </p><h2 id="æœªä½¿ç”¨çŠ¶æ€æ¨¡å¼"><a href="#æœªä½¿ç”¨çŠ¶æ€æ¨¡å¼" class="headerlink" title="æœªä½¿ç”¨çŠ¶æ€æ¨¡å¼"></a>æœªä½¿ç”¨çŠ¶æ€æ¨¡å¼</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Light = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.state = <span class="string">&quot;off&quot;</span>; <span class="comment">// ç»™ç”µç¯è®¾ç½®åˆå§‹çŠ¶æ€ off</span></span><br><span class="line">  <span class="built_in">this</span>.button = <span class="literal">null</span>;<span class="comment">// ç”µç¯å¼€å…³æŒ‰é’®</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Light.prototype.init = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> button = <span class="built_in">document</span>.createElement(<span class="string">&quot;button&quot;</span>),</span><br><span class="line">    self = <span class="built_in">this</span>;</span><br><span class="line">  button.innerHTML = <span class="string">&quot;å¼€å…³&quot;</span>;</span><br><span class="line">  <span class="built_in">this</span>.button = <span class="built_in">document</span>.body.appendChild(button);</span><br><span class="line">  <span class="built_in">this</span>.button.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    self.buttonWasPressed();</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Light.prototype.buttonWasPressed = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">this</span>.state === <span class="string">&quot;off&quot;</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;å¼€ç¯&quot;</span>);</span><br><span class="line">    <span class="built_in">this</span>.state = <span class="string">&quot;on&quot;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">this</span>.state === <span class="string">&quot;on&quot;</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;å…³ç¯&quot;</span>);</span><br><span class="line">    <span class="built_in">this</span>.state = <span class="string">&quot;off&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> light = <span class="keyword">new</span> Light();</span><br><span class="line">light.init();</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¦‚æœéœ€è¦åœ¨æ–°å¢çŠ¶æ€ï¼Œé‚£ä¹ˆå°±å¾—ç›´æ¥åœ¨buttonWasPressedé‡Œä¿®æ”¹ï¼Œä¸ç¬¦åˆå¼€é—­åŸåˆ™ã€‚</p><h2 id="çŠ¶æ€æ¨¡å¼é‡æ„"><a href="#çŠ¶æ€æ¨¡å¼é‡æ„" class="headerlink" title="çŠ¶æ€æ¨¡å¼é‡æ„"></a>çŠ¶æ€æ¨¡å¼é‡æ„</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> OffLightState = <span class="function"><span class="keyword">function</span> (<span class="params">light</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.light = light;</span><br><span class="line">&#125;;</span><br><span class="line">OffLightState.prototype.buttonWasPressed = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;å¼±å…‰&quot;</span>); <span class="comment">// offLightState å¯¹åº”çš„è¡Œä¸º</span></span><br><span class="line">  <span class="built_in">this</span>.light.setState(<span class="built_in">this</span>.light.weakLightState);<span class="comment">// åˆ‡æ¢çŠ¶æ€åˆ° weakLightState</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> WeakLightState = <span class="function"><span class="keyword">function</span> (<span class="params">light</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.light = light;</span><br><span class="line">&#125;;</span><br><span class="line">WeakLightState.prototype.buttonWasPressed = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;å¼ºå…‰&quot;</span>); <span class="comment">// weakLightState å¯¹åº”çš„è¡Œä¸º</span></span><br><span class="line">  <span class="built_in">this</span>.light.setState(<span class="built_in">this</span>.light.strongLightState); <span class="comment">//åˆ‡æ¢çŠ¶æ€åˆ° strongLightState</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> StrongLightState = <span class="function"><span class="keyword">function</span> (<span class="params">light</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.light = light;</span><br><span class="line">&#125;;</span><br><span class="line">StrongLightState.prototype.buttonWasPressed = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;å…³ç¯&quot;</span>); <span class="comment">// strongLightState å¯¹åº”çš„è¡Œä¸º</span></span><br><span class="line">  <span class="built_in">this</span>.light.setState(<span class="built_in">this</span>.light.offLightState); <span class="comment">// åˆ‡æ¢çŠ¶æ€åˆ° offLightState</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ”¹å†™ Light ç±»ï¼Œä½¿ç”¨çŠ¶æ€å¯¹è±¡è®°å½•å½“å‰çš„çŠ¶æ€</span></span><br><span class="line"><span class="keyword">let</span> Light = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.offLightState = <span class="keyword">new</span> OffLightState(<span class="built_in">this</span>);</span><br><span class="line">  <span class="built_in">this</span>.weakLightState = <span class="keyword">new</span> WeakLightState(<span class="built_in">this</span>);</span><br><span class="line">  <span class="built_in">this</span>.strongLightState = <span class="keyword">new</span> StrongLightState(<span class="built_in">this</span>);</span><br><span class="line">  <span class="built_in">this</span>.button = <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æä¾›ä¸€ä¸ª æ–¹æ³•æ¥åˆ‡æ¢ light å¯¹è±¡çš„çŠ¶æ€</span></span><br><span class="line">Light.prototype.init = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> button = <span class="built_in">document</span>.createElement(<span class="string">&quot;button&quot;</span>),</span><br><span class="line">    self = <span class="built_in">this</span>;</span><br><span class="line">  <span class="built_in">this</span>.button = <span class="built_in">document</span>.body.appendChild(button);</span><br><span class="line">  <span class="built_in">this</span>.button.innerHTML = <span class="string">&quot;å¼€å…³&quot;</span>;</span><br><span class="line">  <span class="built_in">this</span>.currState = <span class="built_in">this</span>.offLightState;</span><br><span class="line">  <span class="built_in">this</span>.button.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    self.currState.buttonWasPressed();</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line">Light.prototype.setState = <span class="function"><span class="keyword">function</span> (<span class="params">newState</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.currState = newState;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> light = <span class="keyword">new</span> Light();</span><br><span class="line">light.init();</span><br></pre></td></tr></table></figure><p>å®ƒå¯ä»¥ä½¿æ¯ä¸€ç§çŠ¶æ€å’Œå®ƒå¯¹åº”çš„è¡Œä¸ºä¹‹é—´çš„å…³ç³»å±€éƒ¨åŒ–ï¼Œè¿™äº›è¡Œä¸ºè¢«åˆ†æ•£å’Œå°è£…åœ¨å„è‡ªå¯¹åº”çš„çŠ¶æ€ç±»ä¹‹ä¸­ï¼Œä¾¿äºé˜…è¯»å’Œç®¡ç†ä»£ç ã€‚</p><p>çŠ¶æ€ä¹‹é—´çš„åˆ‡æ¢éƒ½è¢«åˆ†å¸ƒåœ¨çŠ¶æ€ç±»å†…éƒ¨ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬æ— éœ€ç¼–å†™è¿‡å¤šçš„ ifã€else æ¡ä»¶ åˆ†æ”¯è¯­è¨€æ¥æ§åˆ¶çŠ¶æ€ä¹‹é—´çš„è½¬æ¢</p><p>ç”¨å¯¹è±¡ä»£æ›¿å­—ç¬¦ä¸²æ¥è®°å½•å½“å‰çŠ¶æ€ï¼Œä½¿å¾—çŠ¶æ€çš„åˆ‡æ¢æ›´åŠ ä¸€ç›®äº†ç„¶ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;çŠ¶æ€æ¨¡å¼&quot;&gt;&lt;a href=&quot;#çŠ¶æ€æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;çŠ¶æ€æ¨¡å¼&quot;&gt;&lt;/a&gt;çŠ¶æ€æ¨¡å¼&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»&lt;/p&gt;
&lt;p&gt;çŠ¶æ€æ¨¡å¼çš„å…³
      
    
    </summary>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>è£…é¥°è€…æ¨¡å¼</title>
    <link href="https://liang5757.github.io/2021/02/09/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    <id>https://liang5757.github.io/2021/02/09/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/</id>
    <published>2021-02-09T07:37:36.000Z</published>
    <updated>2021-05-05T17:07:36.153Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è£…é¥°è€…æ¨¡å¼"><a href="#è£…é¥°è€…æ¨¡å¼" class="headerlink" title="è£…é¥°è€…æ¨¡å¼"></a>è£…é¥°è€…æ¨¡å¼</h1><blockquote><p>åœ¨ä¼ ç»Ÿçš„é¢å‘å¯¹è±¡è¯­è¨€ä¸­ï¼Œç»™å¯¹è±¡æ·»åŠ åŠŸèƒ½å¸¸å¸¸ä½¿ç”¨ç»§æ‰¿çš„æ–¹å¼ï¼Œä½†æ˜¯ç»§æ‰¿çš„æ–¹å¼å¹¶ä¸çµæ´»ï¼Œ è¿˜ä¼šå¸¦æ¥è®¸å¤šé—®é¢˜ï¼šä¸€æ–¹é¢ä¼šå¯¼è‡´è¶…ç±»å’Œå­ç±»ä¹‹é—´å­˜åœ¨å¼ºè€¦åˆæ€§ï¼Œå½“è¶…ç±»æ”¹å˜æ—¶ï¼Œå­ç±»ä¹Ÿä¼šéšä¹‹æ”¹å˜ï¼›å¦ä¸€æ–¹é¢ï¼Œç»§æ‰¿è¿™ç§åŠŸèƒ½å¤ç”¨æ–¹å¼é€šå¸¸è¢«ç§°ä¸ºâ€œç™½ç®±å¤ç”¨â€ï¼Œâ€œç™½ç®±â€æ˜¯ç›¸å¯¹å¯è§æ€§è€Œè¨€çš„ï¼Œ åœ¨ç»§æ‰¿æ–¹å¼ä¸­ï¼Œè¶…ç±»çš„å†…éƒ¨ç»†èŠ‚æ˜¯å¯¹å­ç±»å¯è§çš„ï¼Œç»§æ‰¿å¸¸å¸¸è¢«è®¤ä¸ºç ´åäº†å°è£…æ€§ã€‚è£…é¥°è€…æ¨¡å¼èƒ½å¤Ÿåœ¨ä¸æ”¹å˜å¯¹è±¡è‡ªèº«çš„åŸºç¡€ä¸Šï¼Œåœ¨ç¨‹åºè¿è¡ŒæœŸé—´ç»™å¯¹è±¡åŠ¨æ€åœ°æ·»åŠ èŒè´£ã€‚è·Ÿç»§æ‰¿ç›¸æ¯”ï¼Œè£…é¥°è€…æ˜¯ä¸€ç§æ›´è½»ä¾¿çµæ´»çš„åšæ³•ï¼Œè¿™æ˜¯ä¸€ç§â€œå³ç”¨å³ä»˜â€çš„æ–¹å¼</p></blockquote><h2 id="æ•…äº‹èƒŒæ™¯"><a href="#æ•…äº‹èƒŒæ™¯" class="headerlink" title="æ•…äº‹èƒŒæ™¯"></a>æ•…äº‹èƒŒæ™¯</h2><p>å‡è®¾æˆ‘ä»¬åœ¨ç¼–å†™ä¸€ä¸ªé£æœºå¤§æˆ˜çš„æ¸¸æˆï¼Œéšç€ç»éªŒå€¼çš„å¢åŠ ï¼Œæˆ‘ä»¬æ“ä½œçš„é£æœºå¯¹è±¡å¯ä»¥å‡çº§æˆæ›´å‰å®³çš„é£æœºï¼Œä¸€å¼€å§‹è¿™äº›é£æœºåªèƒ½å‘å°„æ™®é€šçš„å­å¼¹ï¼Œå‡åˆ°ç¬¬äºŒçº§æ—¶å¯ä»¥å‘å°„å¯¼å¼¹ï¼Œå‡åˆ°ç¬¬ä¸‰çº§æ—¶å¯ä»¥å‘å°„åŸå­å¼¹ã€‚</p><h2 id="ä¼ ç»Ÿé¢å‘å¯¹è±¡å®ç°"><a href="#ä¼ ç»Ÿé¢å‘å¯¹è±¡å®ç°" class="headerlink" title="ä¼ ç»Ÿé¢å‘å¯¹è±¡å®ç°"></a>ä¼ ç»Ÿé¢å‘å¯¹è±¡å®ç°</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Plane = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">Plane.prototype.fire = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;å‘å°„æ™®é€šå­å¼¹&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å¼¹ç±»</span></span><br><span class="line"><span class="keyword">let</span> MissileDecorator = <span class="function"><span class="keyword">function</span> (<span class="params">plane</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.plane = plane;</span><br><span class="line">&#125;;</span><br><span class="line">MissileDecorator.prototype.fire = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.plane.fire();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;å‘å°„å¯¼å¼¹&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŸå­å¼¹ç±»</span></span><br><span class="line"><span class="keyword">let</span> AtomDecorator = <span class="function"><span class="keyword">function</span> (<span class="params">plane</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.plane = plane;</span><br><span class="line">&#125;;</span><br><span class="line">AtomDecorator.prototype.fire = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.plane.fire();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;å‘å°„åŸå­å¼¹&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> plane = <span class="keyword">new</span> Plane();</span><br><span class="line">plane = <span class="keyword">new</span> MissileDecorator(plane);</span><br><span class="line">plane = <span class="keyword">new</span> AtomDecorator(plane);</span><br><span class="line">plane.fire();</span><br></pre></td></tr></table></figure><p>è£…é¥°è€…å¯¹è±¡å’Œå®ƒæ‰€è£…é¥°çš„å¯¹è±¡æ‹¥æœ‰ä¸€è‡´çš„æ¥å£ï¼Œé€šè¿‡ä¼ å…¥è¢«è£…é¥°å¯¹è±¡ï¼Œè°ƒç”¨å…¶å¯¹åº”æ–¹æ³•ï¼Œå¹¶æ·»åŠ èŒè´£å½¢æˆèšåˆå¯¹è±¡ã€‚</p><h2 id="åŠ¨æ€è¯­è¨€å®ç°"><a href="#åŠ¨æ€è¯­è¨€å®ç°" class="headerlink" title="åŠ¨æ€è¯­è¨€å®ç°"></a>åŠ¨æ€è¯­è¨€å®ç°</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> plane = &#123;</span><br><span class="line">  fire: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;å‘å°„æ™®é€šå­å¼¹&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> missileDecorator = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;å‘å°„å¯¼å¼¹&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> atomDecorator = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;å‘å°„åŸå­å¼¹&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> fire1 = plane.fire;</span><br><span class="line">plane.fire = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  fire1();</span><br><span class="line">  missileDecorator();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> fire2 = plane.fire;</span><br><span class="line">plane.fire = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  fire2();</span><br><span class="line">  atomDecorator();</span><br><span class="line">&#125;;</span><br><span class="line">plane.fire();</span><br></pre></td></tr></table></figure><p>å› ä¸ºjså¯ä»¥ç›´æ¥ä¿®æ”¹å¯¹è±¡æˆ–è€…å¯¹è±¡çš„æŸä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡ä¸€ä¸ªå˜é‡<code>a</code>æš‚å­˜è¢«è£…é¥°å‡½æ•°ï¼Œç„¶åæ›¿æ¢æ—§æ–¹æ³•ï¼Œåœ¨æ–°æ–¹æ³•å†…é€šè¿‡<code>a</code>è°ƒç”¨æ—§æ–¹æ³•ã€‚</p><p>ä½†æ˜¯<strong>ç›´æ¥æ›¿æ¢æœ‰thisæŒ‡å‘é—®é¢˜</strong>ã€‚</p><h2 id="AOPå®ç°"><a href="#AOPå®ç°" class="headerlink" title="AOPå®ç°"></a>AOPå®ç°</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.before = <span class="function"><span class="keyword">function</span> (<span class="params">beforefn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> _self = <span class="built_in">this</span>; <span class="comment">// ä¿å­˜åŸå‡½æ•°çš„å¼•ç”¨</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// è¿”å›åŒ…å«äº†åŸå‡½æ•°å’Œæ–°å‡½æ•°çš„&quot;ä»£ç†&quot;å‡½æ•°</span></span><br><span class="line">    beforefn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>); <span class="comment">// æ‰§è¡Œæ–°å‡½æ•°ï¼Œä¸”ä¿è¯ this ä¸è¢«åŠ«æŒï¼Œæ–°å‡½æ•°æ¥å—çš„å‚æ•° </span></span><br><span class="line">                                     <span class="comment">// ä¹Ÿä¼šè¢«åŸå°ä¸åŠ¨åœ°ä¼ å…¥åŸå‡½æ•°ï¼Œæ–°å‡½æ•°åœ¨åŸå‡½æ•°ä¹‹å‰æ‰§è¡Œ</span></span><br><span class="line">    <span class="keyword">return</span> _self.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>); <span class="comment">// æ‰§è¡ŒåŸå‡½æ•°å¹¶è¿”å›åŸå‡½æ•°çš„æ‰§è¡Œç»“æœï¼Œ  // å¹¶ä¸”ä¿è¯ this ä¸è¢«åŠ«æŒ</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">Function</span>.prototype.after = <span class="function"><span class="keyword">function</span> (<span class="params">afterfn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> _self = <span class="built_in">this</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> ret = _self.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    afterfn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>é€šè¿‡AOPå®é™…ä¸Šæ”¾å›çš„æ˜¯æ–°å‡½æ•°ï¼Œåœ¨åŸå‡½æ•°ä¸Šä¿å­˜çš„å±æ€§åˆ™ä¼šä¸¢å¤±</li><li>å åŠ äº†ä½œç”¨åŸŸï¼Œå¦‚æœè£…é¥°çš„é“¾æ¡è¿‡é•¿ï¼Œæ€§èƒ½ä¸Šä¼šå—åˆ°å½±å“</li></ul><h2 id="ä¸ä»£ç†æ¨¡å¼çš„åŒºåˆ«"><a href="#ä¸ä»£ç†æ¨¡å¼çš„åŒºåˆ«" class="headerlink" title="ä¸ä»£ç†æ¨¡å¼çš„åŒºåˆ«"></a>ä¸ä»£ç†æ¨¡å¼çš„åŒºåˆ«</h2><p>ä»£ç†æ¨¡å¼çš„ç›®çš„ï¼šå½“ç›´æ¥è®¿é—®æœ¬ä½“ä¸æ–¹ä¾¿æˆ–è€…ä¸ç¬¦åˆéœ€è¦æ—¶ï¼Œä¸ºè¿™ä¸ªæœ¬ä½“æä¾›ä¸€ä¸ªæ›¿ä»£è€…ã€‚æœ¬ä½“å®šä¹‰äº†å…³é”®åŠŸèƒ½ï¼Œè€Œä»£ç†æä¾›æˆ–æ‹’ç»å¯¹å®ƒçš„è®¿é—®ï¼Œæˆ–è€…åœ¨è®¿é—®æœ¬ä½“ä¹‹å‰åšä¸€äº›é¢å¤–çš„äº‹æƒ…ã€‚</p><p>è£…é¥°è€…æ¨¡å¼çš„ä½œç”¨ï¼šä¸ºå¯¹è±¡åŠ¨æ€çš„åŠ å…¥è¡Œä¸ºã€‚</p><p>æ¢å¥è¯è¯´ï¼Œä»£ç†æ¨¡å¼çš„å…³ç³»ä¸€å¼€å§‹å°±å¯ä»¥è¢«ç¡®å®šï¼Œè€Œè£…é¥°è€…æ¨¡å¼ç”¨äºä¸€å¼€å§‹ä¸èƒ½ç¡®å®šå¯¹è±¡çš„å…¨éƒ¨åŠŸèƒ½æ—¶</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;è£…é¥°è€…æ¨¡å¼&quot;&gt;&lt;a href=&quot;#è£…é¥°è€…æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;è£…é¥°è€…æ¨¡å¼&quot;&gt;&lt;/a&gt;è£…é¥°è€…æ¨¡å¼&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;åœ¨ä¼ ç»Ÿçš„é¢å‘å¯¹è±¡è¯­è¨€ä¸­ï¼Œç»™å¯¹è±¡æ·»åŠ åŠŸèƒ½å¸¸å¸¸ä½¿ç”¨ç»§æ‰¿çš„æ–¹å¼ï¼Œä½†æ˜¯ç»§æ‰¿çš„æ–¹å¼å¹¶ä¸çµæ´»ï¼Œ è¿˜ä¼šå¸¦
      
    
    </summary>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>ä¸­ä»‹è€…æ¨¡å¼</title>
    <link href="https://liang5757.github.io/2021/02/08/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    <id>https://liang5757.github.io/2021/02/08/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/</id>
    <published>2021-02-08T07:37:14.000Z</published>
    <updated>2021-05-05T17:07:34.055Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸­ä»‹è€…æ¨¡å¼"><a href="#ä¸­ä»‹è€…æ¨¡å¼" class="headerlink" title="ä¸­ä»‹è€…æ¨¡å¼"></a>ä¸­ä»‹è€…æ¨¡å¼</h1><blockquote><p>ä¸­ä»‹è€…æ¨¡å¼çš„ä½œç”¨å°±æ˜¯è§£é™¤å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„ç´§è€¦åˆå…³ç³»ã€‚å¢åŠ ä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡åï¼Œæ‰€æœ‰çš„ç›¸å…³å¯¹è±¡éƒ½é€šè¿‡ä¸­ä»‹è€…å¯¹è±¡æ¥é€šä¿¡ï¼Œè€Œä¸æ˜¯äº’ç›¸å¼•ç”¨ï¼Œæ‰€ä»¥å½“ä¸€ä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜æ—¶ï¼Œåªéœ€è¦é€šçŸ¥ä¸­ä»‹è€…å¯¹è±¡å³å¯ã€‚ä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¹‹é—´è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚ä¸­ä»‹è€…æ¨¡å¼ä½¿ç½‘çŠ¶çš„å¤šå¯¹å¤šå…³ç³»å˜æˆäº†ç›¸å¯¹ç®€å•çš„ä¸€å¯¹å¤šå…³ç³»</p></blockquote><h2 id="æ•…äº‹èƒŒæ™¯"><a href="#æ•…äº‹èƒŒæ™¯" class="headerlink" title="æ•…äº‹èƒŒæ™¯"></a>æ•…äº‹èƒŒæ™¯</h2><p>å‡å¦‚åœ¨ç©æ³¡æ³¡å ‚çš„æ¸¸æˆï¼Œä½¿ç”¨æ³¡æ³¡å‡»è´¥å¯¹æ–¹æ‰€æœ‰ç©å®¶æ‰èƒ½è·å¾—èƒœåˆ©ã€‚ç°åœ¨å°†é˜Ÿä¼åˆ†æˆä¸¤ä¸ªç»„è¿›è¡Œæ¸¸æˆ</p><h2 id="ä»£ç å®ç°-æœªä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼"><a href="#ä»£ç å®ç°-æœªä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼" class="headerlink" title="ä»£ç å®ç°(æœªä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼)"></a>ä»£ç å®ç°(æœªä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼)</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç©å®¶</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Player</span>(<span class="params">name, teamColor</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.partners = []; <span class="comment">// é˜Ÿå‹åˆ—è¡¨</span></span><br><span class="line">  <span class="built_in">this</span>.enemies = []; <span class="comment">// æ•Œäººåˆ—è¡¨</span></span><br><span class="line">  <span class="built_in">this</span>.state = <span class="string">&quot;live&quot;</span>; <span class="comment">// ç©å®¶çŠ¶æ€</span></span><br><span class="line">  <span class="built_in">this</span>.name = name; <span class="comment">// è§’è‰²åå­—</span></span><br><span class="line">  <span class="built_in">this</span>.teamColor = teamColor; <span class="comment">// é˜Ÿä¼é¢œè‰²</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Player.prototype.win = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// ç©å®¶å›¢é˜Ÿèƒœåˆ©</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;winner: &quot;</span> + <span class="built_in">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line">Player.prototype.lose = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// ç©å®¶å›¢é˜Ÿå¤±è´¥</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;loser: &quot;</span> + <span class="built_in">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç©å®¶æ­»äº¡çš„æ–¹æ³•</span></span><br><span class="line">Player.prototype.die = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// ç©å®¶æ­»äº¡</span></span><br><span class="line">  <span class="keyword">let</span> all_dead = <span class="literal">true</span>;</span><br><span class="line">  <span class="built_in">this</span>.state = <span class="string">&quot;dead&quot;</span>; <span class="comment">// è®¾ç½®ç©å®¶çŠ¶æ€ä¸ºæ­»äº¡</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, partner; partner = <span class="built_in">this</span>.partners[i++];) &#123; <span class="comment">// éå†é˜Ÿå‹åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">if</span> (partner.state !== <span class="string">&quot;dead&quot;</span>) &#123; <span class="comment">// å¦‚æœè¿˜æœ‰ä¸€ä¸ªé˜Ÿå‹æ²¡æœ‰æ­»äº¡ï¼Œåˆ™æ¸¸æˆè¿˜æœªå¤±è´¥</span></span><br><span class="line">      all_dead = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (all_dead === <span class="literal">true</span>) &#123; <span class="comment">// å¦‚æœé˜Ÿå‹å…¨éƒ¨æ­»äº¡</span></span><br><span class="line">    <span class="built_in">this</span>.lose(); <span class="comment">// é€šçŸ¥è‡ªå·±æ¸¸æˆå¤±è´¥</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, partner; partner = <span class="built_in">this</span>.partners[i++];) &#123;</span><br><span class="line">      partner.lose();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, enemy; enemy = <span class="built_in">this</span>.enemies[i++];) &#123;</span><br><span class="line">      enemy.win();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªå·¥å‚æ¥åˆ›å»ºç©å®¶</span></span><br><span class="line"><span class="keyword">let</span> playerFactory = <span class="function"><span class="keyword">function</span> (<span class="params">name, teamColor</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> newPlayer = <span class="keyword">new</span> Player(name, teamColor);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, player; player = players[i++];) &#123; <span class="comment">// é€šçŸ¥æ‰€æœ‰çš„ç©å®¶ï¼Œæœ‰æ–°è§’è‰²åŠ å…¥</span></span><br><span class="line">    <span class="keyword">if</span> (player.teamColor === newPlayer.teamColor) &#123; <span class="comment">// å¦‚æœæ˜¯åŒä¸€é˜Ÿçš„ç©å®¶</span></span><br><span class="line">      player.partners.push(newPlayer); <span class="comment">// ç›¸äº’æ·»åŠ åˆ°é˜Ÿå‹åˆ—è¡¨</span></span><br><span class="line">      newPlayer.partners.push(player);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      player.enemies.push(newPlayer); <span class="comment">// ç›¸äº’æ·»åŠ åˆ°æ•Œäººåˆ—è¡¨</span></span><br><span class="line">      newPlayer.enemies.push(player);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  players.push(newPlayer);</span><br><span class="line">  <span class="keyword">return</span> newPlayer;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> players = [];</span><br><span class="line"><span class="comment">//çº¢é˜Ÿ:</span></span><br><span class="line"><span class="keyword">let</span> player1 = playerFactory(<span class="string">&quot;çš®è›‹&quot;</span>, <span class="string">&quot;red&quot;</span>),</span><br><span class="line">  player2 = playerFactory(<span class="string">&quot;å°ä¹–&quot;</span>, <span class="string">&quot;red&quot;</span>),</span><br><span class="line">  player3 = playerFactory(<span class="string">&quot;å®å®&quot;</span>, <span class="string">&quot;red&quot;</span>),</span><br><span class="line">  player4 = playerFactory(<span class="string">&quot;å°å¼º&quot;</span>, <span class="string">&quot;red&quot;</span>);</span><br><span class="line"><span class="comment">//è“é˜Ÿ:</span></span><br><span class="line"><span class="keyword">let</span> player5 = playerFactory(<span class="string">&quot;é»‘å¦&quot;</span>, <span class="string">&quot;blue&quot;</span>),</span><br><span class="line">  player6 = playerFactory(<span class="string">&quot;è‘±å¤´&quot;</span>, <span class="string">&quot;blue&quot;</span>),</span><br><span class="line">  player7 = playerFactory(<span class="string">&quot;èƒ–å¢©&quot;</span>, <span class="string">&quot;blue&quot;</span>),</span><br><span class="line">  player8 = playerFactory(<span class="string">&quot;æµ·ç›—&quot;</span>, <span class="string">&quot;blue&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®©çº¢é˜Ÿç©å®¶å…¨éƒ¨æ­»äº¡:</span></span><br><span class="line">player1.die();</span><br><span class="line">player2.die();</span><br><span class="line">player4.die();</span><br><span class="line">player3.die();</span><br></pre></td></tr></table></figure><p>æ¯ä¸ªç©å®¶æ·»åŠ æˆ–è€…æ­»äº¡ï¼Œéƒ½å¿…é¡»ä¿®æ”¹æ‰€æœ‰å…¶ä»–ç©å®¶å†…éƒ¨çš„é˜Ÿå‹åˆ—è¡¨å’Œæ•Œäººåˆ—è¡¨ã€‚è€¦åˆåº¦å¾ˆé«˜ã€‚</p><h2 id="ä»£ç é‡æ„-ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼"><a href="#ä»£ç é‡æ„-ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼" class="headerlink" title="ä»£ç é‡æ„(ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼)"></a>ä»£ç é‡æ„(ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼)</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç©å®¶</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Player</span>(<span class="params">name, teamColor</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.state = <span class="string">&quot;live&quot;</span>; <span class="comment">// ç©å®¶çŠ¶æ€</span></span><br><span class="line">  <span class="built_in">this</span>.name = name; <span class="comment">// è§’è‰²åå­—</span></span><br><span class="line">  <span class="built_in">this</span>.teamColor = teamColor; <span class="comment">// é˜Ÿä¼é¢œè‰²</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Player.prototype.win = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="built_in">this</span>.name + <span class="string">&#x27; won &#x27;</span> );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Player.prototype.lose = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="built_in">this</span>.name +<span class="string">&#x27; lost&#x27;</span> );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*******************ç©å®¶æ­»äº¡*****************/</span></span><br><span class="line">Player.prototype.die = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.state = <span class="string">&quot;dead&quot;</span>;</span><br><span class="line">  playerDirector.receiveMessage(<span class="string">&quot;playerDead&quot;</span>, <span class="built_in">this</span>);<span class="comment">// ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œç©å®¶æ­»äº¡</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*******************ç§»é™¤ç©å®¶*****************/</span></span><br><span class="line">Player.prototype.remove = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œç§»é™¤ä¸€ä¸ªç©å®¶</span></span><br><span class="line">  playerDirector.receiveMessage(<span class="string">&quot;removePlayer&quot;</span>, <span class="built_in">this</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*******************ç©å®¶æ¢é˜Ÿ*****************/</span></span><br><span class="line">Player.prototype.changeTeam = <span class="function"><span class="keyword">function</span> (<span class="params">color</span>) </span>&#123;</span><br><span class="line">  playerDirector.receiveMessage(<span class="string">&quot;changeTeam&quot;</span>, <span class="built_in">this</span>, color); <span class="comment">// ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œç©å®¶æ¢é˜Ÿ</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*******************å®šä¹‰ä¸­ä»‹è€…å¯¹è±¡*****************/</span></span><br><span class="line"><span class="keyword">let</span> playerDirector = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> players = &#123;&#125;, <span class="comment">// ä¿å­˜æ‰€æœ‰ç©å®¶</span></span><br><span class="line">    operations = &#123;&#125;; <span class="comment">// ä¸­ä»‹è€…å¯ä»¥æ‰§è¡Œçš„æ“ä½œ</span></span><br><span class="line">  <span class="comment">/****************æ–°å¢ä¸€ä¸ªç©å®¶***************************/</span></span><br><span class="line">  operations.addPlayer = <span class="function"><span class="keyword">function</span> (<span class="params">player</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> teamColor = player.teamColor; <span class="comment">// ç©å®¶çš„é˜Ÿä¼é¢œè‰²</span></span><br><span class="line">    players[teamColor] = players[teamColor] || []; <span class="comment">// å¦‚æœè¯¥é¢œè‰²çš„ç©å®¶è¿˜æ²¡æœ‰æˆç«‹é˜Ÿä¼ï¼Œåˆ™æ–°æˆç«‹ä¸€ä¸ªé˜Ÿä¼</span></span><br><span class="line">    players[teamColor].push(player); <span class="comment">// æ·»åŠ ç©å®¶è¿›é˜Ÿä¼</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">/****************ç§»é™¤ä¸€ä¸ªç©å®¶***************************/</span></span><br><span class="line">  operations.removePlayer = <span class="function"><span class="keyword">function</span> (<span class="params">player</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> teamColor = player.teamColor, <span class="comment">// ç©å®¶çš„é˜Ÿä¼é¢œè‰²</span></span><br><span class="line">      teamPlayers = players[teamColor] || []; <span class="comment">// è¯¥é˜Ÿä¼æ‰€æœ‰æˆå‘˜</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = teamPlayers.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123; <span class="comment">// éå†åˆ é™¤</span></span><br><span class="line">      <span class="keyword">if</span> (teamPlayers[i] === player) &#123;</span><br><span class="line">        teamPlayers.splice(i, <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">/****************ç©å®¶æ¢é˜Ÿ***************************/</span></span><br><span class="line">  operations.changeTeam = <span class="function"><span class="keyword">function</span> (<span class="params">player, newTeamColor</span>) </span>&#123; <span class="comment">// ç©å®¶æ¢é˜Ÿ</span></span><br><span class="line">    operations.removePlayer(player); <span class="comment">// ä»åŸé˜Ÿä¼ä¸­åˆ é™¤</span></span><br><span class="line">    player.teamColor = newTeamColor; <span class="comment">// æ”¹å˜é˜Ÿä¼é¢œè‰²</span></span><br><span class="line">    operations.addPlayer(player);<span class="comment">// å¢åŠ åˆ°æ–°é˜Ÿä¼ä¸­</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">/****************ç©å®¶æ­»äº¡***************************/</span></span><br><span class="line">  operations.playerDead = <span class="function"><span class="keyword">function</span> (<span class="params">player</span>) </span>&#123; <span class="comment">// ç©å®¶æ­»äº¡</span></span><br><span class="line">    <span class="keyword">let</span> teamColor = player.teamColor,</span><br><span class="line">      teamPlayers = players[teamColor]; <span class="comment">// ç©å®¶æ‰€åœ¨é˜Ÿä¼</span></span><br><span class="line">    <span class="keyword">let</span> all_dead = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, player; player = teamPlayers[i++];) &#123;</span><br><span class="line">      <span class="keyword">if</span> (player.state !== <span class="string">&quot;dead&quot;</span>) &#123;</span><br><span class="line">        all_dead = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (all_dead === <span class="literal">true</span>) &#123;<span class="comment">// å…¨éƒ¨æ­»äº¡</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, player; player = teamPlayers[i++];) &#123;</span><br><span class="line">        player.lose(); <span class="comment">// æœ¬é˜Ÿæ‰€æœ‰ç©å®¶ lose</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> color <span class="keyword">in</span> players) &#123;</span><br><span class="line">        <span class="keyword">if</span> (color !== teamColor) &#123;</span><br><span class="line">          <span class="keyword">let</span> teamPlayers = players[color];  <span class="comment">// å…¶ä»–é˜Ÿä¼çš„ç©å®¶</span></span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, player; player = teamPlayers[i++];) &#123;</span><br><span class="line">            player.win(); <span class="comment">// å…¶ä»–é˜Ÿä¼æ‰€æœ‰ç©å®¶ win</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> receiveMessage = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> message = <span class="built_in">Array</span>.prototype.shift.call(<span class="built_in">arguments</span>);</span><br><span class="line">    operations[message].apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    receiveMessage: receiveMessage,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*******************è®¾ç½®å·¥å‚å‡½æ•°*****************/</span></span><br><span class="line"><span class="keyword">let</span> playerFactory = <span class="function"><span class="keyword">function</span> (<span class="params">name, teamColor</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> newPlayer = <span class="keyword">new</span> Player(name, teamColor); <span class="comment">// åˆ›é€ ä¸€ä¸ªæ–°çš„ç©å®¶å¯¹è±¡</span></span><br><span class="line">  playerDirector.receiveMessage(<span class="string">&quot;addPlayer&quot;</span>, newPlayer); <span class="comment">// ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œæ–°å¢ç©å®¶</span></span><br><span class="line">  <span class="keyword">return</span> newPlayer;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//çº¢é˜Ÿ</span></span><br><span class="line"><span class="keyword">let</span> player1 = playerFactory(<span class="string">&quot;çš®è›‹&quot;</span>, <span class="string">&quot;red&quot;</span>),</span><br><span class="line">  player2 = playerFactory(<span class="string">&quot;å°ä¹–&quot;</span>, <span class="string">&quot;red&quot;</span>),</span><br><span class="line">  player3 = playerFactory(<span class="string">&quot;å®å®&quot;</span>, <span class="string">&quot;red&quot;</span>),</span><br><span class="line">  player4 = playerFactory(<span class="string">&quot;å°å¼º&quot;</span>, <span class="string">&quot;red&quot;</span>);</span><br><span class="line"><span class="comment">// è“é˜Ÿ:</span></span><br><span class="line"><span class="keyword">let</span> player5 = playerFactory(<span class="string">&quot;é»‘å¦&quot;</span>, <span class="string">&quot;blue&quot;</span>),</span><br><span class="line">  player6 = playerFactory(<span class="string">&quot;è‘±å¤´&quot;</span>, <span class="string">&quot;blue&quot;</span>),</span><br><span class="line">  player7 = playerFactory(<span class="string">&quot;èƒ–å¢©&quot;</span>, <span class="string">&quot;blue&quot;</span>),</span><br><span class="line">  player8 = playerFactory(<span class="string">&quot;æµ·ç›—&quot;</span>, <span class="string">&quot;blue&quot;</span>);</span><br><span class="line"></span><br><span class="line">player1.die();</span><br><span class="line">player2.die();</span><br><span class="line">player3.die();</span><br><span class="line">player4.die();</span><br></pre></td></tr></table></figure><p>ç°åœ¨ç©å®¶ä¸ç©å®¶ä¹‹é—´çš„è€¦åˆæ¶ˆé™¤äº†ï¼Œæ‰€æœ‰æ“ä½œé€»è¾‘åœ¨ä¸­ä»‹è€…å¯¹è±¡ä¸­å®ç°ï¼Œç©å®¶åªéœ€è¦å‘ä¸­ä»‹è€…å‘ç”Ÿæ¶ˆæ¯ï¼Œä¸­ä»‹è€…ä¼šæŠŠå¤„ç†ç»“æœåé¦ˆç»™å…¶ä»–ç©å®¶å¯¹è±¡ã€‚</p><h2 id="ä½¿ç”¨æ—¶æœº"><a href="#ä½¿ç”¨æ—¶æœº" class="headerlink" title="ä½¿ç”¨æ—¶æœº"></a>ä½¿ç”¨æ—¶æœº</h2><p>ä¸­ä»‹è€…æ¨¡å¼å¯ä»¥éå¸¸æ–¹ä¾¿åœ°å¯¹æ¨¡å—æˆ–è€…å¯¹è±¡è¿›è¡Œè§£è€¦ï¼Œä½†å¯¹è±¡ä¹‹é—´å¹¶éä¸€å®šéœ€è¦è§£è€¦ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæ¨¡å—æˆ–å¯¹è±¡ä¹‹é—´æœ‰ä¸€äº›ä¾èµ–å…³ç³»æ˜¯å¾ˆæ­£å¸¸çš„ã€‚æ¯•ç«Ÿæˆ‘ä»¬å†™ç¨‹åºæ˜¯ä¸ºäº†å¿«é€Ÿå®Œæˆé¡¹ç›®äº¤ä»˜ç”Ÿäº§ï¼Œè€Œä¸æ˜¯å †ç Œæ¨¡å¼å’Œè¿‡åº¦è®¾è®¡ã€‚å…³é”®å°±åœ¨äºå¦‚ä½•å»è¡¡é‡å¯¹è±¡ä¹‹é—´çš„è€¦åˆç¨‹åº¦ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œ å¦‚æœå¯¹è±¡ä¹‹é—´çš„å¤æ‚è€¦åˆç¡®å®å¯¼è‡´è°ƒç”¨å’Œç»´æŠ¤å‡ºç°äº†å›°éš¾ï¼Œè€Œä¸”è¿™äº›è€¦åˆåº¦éšé¡¹ç›®çš„å˜åŒ–å‘ˆæŒ‡æ•°å¢é•¿æ›²çº¿ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘ç”¨ä¸­ä»‹è€…æ¨¡å¼æ¥é‡æ„ä»£ç ã€‚</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>ä¸­ä»‹è€…æ¨¡å¼æ˜¯è¿åˆè¿ªç±³ç‰¹æ³•åˆ™çš„ä¸€ç§å®ç°ã€‚è¿ªç±³ç‰¹æ³•åˆ™ä¹Ÿå«æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼Œæ˜¯æŒ‡ä¸€ä¸ªå¯¹è±¡åº”è¯¥å°½å¯èƒ½å°‘åœ°äº†è§£å¦å¤–çš„å¯¹è±¡ã€‚å¦‚æœå¯¹è±¡ä¹‹é—´çš„è€¦åˆæ€§å¤ªé«˜ï¼Œä¸€ä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜ä¹‹åï¼Œéš¾å…ä¼šå½±å“åˆ°å…¶ä»–çš„å¯¹è±¡ï¼Œè€Œåœ¨ä¸­ä»‹è€…æ¨¡å¼é‡Œï¼Œå¯¹è±¡ä¹‹é—´å‡ ä¹ä¸çŸ¥é“å½¼æ­¤çš„å­˜åœ¨ï¼Œå®ƒä»¬åªèƒ½é€šè¿‡ä¸­ä»‹è€…å¯¹è±¡æ¥äº’ç›¸å½±å“å¯¹æ–¹ã€‚</p><p>ä¸­ä»‹è€…æ¨¡å¼ä¹Ÿå­˜åœ¨ä¸€äº›ç¼ºç‚¹ã€‚å…¶ä¸­æœ€å¤§çš„ç¼ºç‚¹æ˜¯ç³»ç»Ÿä¸­ä¼šæ–°å¢ä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡ï¼Œå›  ä¸ºå¯¹è±¡ä¹‹é—´äº¤äº’çš„å¤æ‚æ€§ï¼Œè½¬ç§»æˆäº†ä¸­ä»‹è€…å¯¹è±¡çš„å¤æ‚æ€§ï¼Œä½¿å¾—ä¸­ä»‹è€…å¯¹è±¡ç»å¸¸æ˜¯å·¨å¤§çš„ã€‚ä¸­ä»‹è€…å¯¹è±¡è‡ªèº«å¾€å¾€å°±æ˜¯ä¸€ä¸ªéš¾ä»¥ç»´æŠ¤çš„å¯¹è±¡ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ä¸­ä»‹è€…æ¨¡å¼&quot;&gt;&lt;a href=&quot;#ä¸­ä»‹è€…æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;ä¸­ä»‹è€…æ¨¡å¼&quot;&gt;&lt;/a&gt;ä¸­ä»‹è€…æ¨¡å¼&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;ä¸­ä»‹è€…æ¨¡å¼çš„ä½œç”¨å°±æ˜¯è§£é™¤å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„ç´§è€¦åˆå…³ç³»ã€‚å¢åŠ ä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡åï¼Œæ‰€æœ‰çš„ç›¸å…³å¯¹è±¡éƒ½
      
    
    </summary>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>èŒè´£é“¾æ¨¡å¼</title>
    <link href="https://liang5757.github.io/2021/02/07/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F/"/>
    <id>https://liang5757.github.io/2021/02/07/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F/</id>
    <published>2021-02-07T07:36:10.000Z</published>
    <updated>2021-05-05T17:07:31.647Z</updated>
    
    <content type="html"><![CDATA[<h1 id="èŒè´£é“¾æ¨¡å¼"><a href="#èŒè´£é“¾æ¨¡å¼" class="headerlink" title="èŒè´£é“¾æ¨¡å¼"></a>èŒè´£é“¾æ¨¡å¼</h1><blockquote><p>èŒè´£é“¾æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼Œå°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p><p>èŒè´£é“¾æ¨¡å¼çš„åå­—éå¸¸å½¢è±¡ï¼Œä¸€ç³»åˆ—å¯èƒ½ä¼šå¤„ç†è¯·æ±‚çš„å¯¹è±¡è¢«è¿æ¥æˆä¸€æ¡é“¾ï¼Œè¯·æ±‚åœ¨è¿™äº›å¯¹ è±¡ä¹‹é—´ä¾æ¬¡ä¼ é€’ï¼Œç›´åˆ°é‡åˆ°ä¸€ä¸ªå¯ä»¥å¤„ç†å®ƒçš„å¯¹è±¡ï¼Œæˆ‘ä»¬æŠŠè¿™äº›å¯¹è±¡ç§°ä¸ºé“¾ä¸­çš„èŠ‚ç‚¹</p></blockquote><h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h2><p>â€‹    å‡è®¾æˆ‘ä»¬è´Ÿè´£ä¸€ä¸ªå”®å–æ‰‹æœºçš„ç”µå•†ç½‘ç«™ï¼Œç»è¿‡åˆ†åˆ«äº¤çº³ 500 å…ƒå®šé‡‘å’Œ 200 å…ƒå®šé‡‘çš„ä¸¤è½®é¢„å®šå(è®¢å•å·²åœ¨æ­¤æ—¶ç”Ÿæˆ)ï¼Œç°åœ¨å·²ç»åˆ°äº†æ­£å¼è´­ä¹°çš„é˜¶æ®µã€‚</p><p>â€‹    åœ¨æ­£å¼è´­ä¹°åï¼Œå·²ç»æ”¯ä»˜è¿‡ 500 å…ƒå®šé‡‘çš„ç”¨æˆ·ä¼šæ”¶åˆ° 100 å…ƒçš„å•†åŸä¼˜æƒ åˆ¸ï¼Œ200 å…ƒå®šé‡‘çš„ç”¨æˆ·å¯ä»¥æ”¶åˆ° 50 å…ƒçš„ä¼˜æƒ åˆ¸ï¼Œè€Œä¹‹å‰æ²¡æœ‰æ”¯ä»˜å®šé‡‘çš„ç”¨æˆ·åªèƒ½è¿›å…¥æ™®é€šè´­ä¹°æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ä¼˜æƒ åˆ¸ï¼Œä¸”åœ¨åº“å­˜æœ‰é™çš„æƒ…å†µä¸‹ä¸ä¸€å®šä¿è¯èƒ½ä¹°åˆ°ã€‚</p><ul><li>orderTypeï¼šè®¢å•ç±»å‹</li><li>payï¼šç”¨æˆ·æ˜¯å¦å·²ç»æ”¯ä»˜å®šé‡‘</li><li>stockï¼šç”¨äºæ™®é€šç”¨æˆ·ï¼Œæ™®é€šè´­ä¹°çš„æ‰‹æœºåº“å­˜æ•°é‡</li></ul><h2 id="ä»£ç å®ç°ï¼ˆæœªä½¿ç”¨èŒè´£é“¾æ¨¡å¼ï¼‰"><a href="#ä»£ç å®ç°ï¼ˆæœªä½¿ç”¨èŒè´£é“¾æ¨¡å¼ï¼‰" class="headerlink" title="ä»£ç å®ç°ï¼ˆæœªä½¿ç”¨èŒè´£é“¾æ¨¡å¼ï¼‰"></a>ä»£ç å®ç°ï¼ˆæœªä½¿ç”¨èŒè´£é“¾æ¨¡å¼ï¼‰</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> order = <span class="function"><span class="keyword">function</span> (<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (orderType === <span class="number">1</span>) &#123; <span class="comment">// 500 å…ƒå®šé‡‘è´­ä¹°æ¨¡å¼</span></span><br><span class="line">    <span class="keyword">if</span> (pay === <span class="literal">true</span>) &#123; <span class="comment">// å·²æ”¯ä»˜å®šé‡‘</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 100 ä¼˜æƒ åˆ¸&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// æœªæ”¯ä»˜å®šé‡‘ï¼Œé™çº§åˆ°æ™®é€šè´­ä¹°æ¨¡å¼</span></span><br><span class="line">      <span class="keyword">if</span> (stock &gt; <span class="number">0</span>) &#123; <span class="comment">// ç”¨äºæ™®é€šè´­ä¹°çš„æ‰‹æœºè¿˜æœ‰åº“å­˜</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;æ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸&quot;</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;æ‰‹æœºåº“å­˜ä¸è¶³&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (orderType === <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (pay === <span class="literal">true</span>) &#123; <span class="comment">// 200 å…ƒå®šé‡‘è´­ä¹°æ¨¡å¼</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;200 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 50 ä¼˜æƒ åˆ¸&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (stock &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;æ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸&quot;</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;æ‰‹æœºåº“å­˜ä¸è¶³&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (orderType === <span class="number">3</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (stock &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;æ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;æ‰‹æœºåº“å­˜ä¸è¶³&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">order(<span class="number">1</span>, <span class="literal">true</span>, <span class="number">500</span>); <span class="comment">// è¾“å‡º: 500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 100 ä¼˜æƒ åˆ¸</span></span><br></pre></td></tr></table></figure><h2 id="ç”¨èŒè´£é“¾æ¨¡å¼é‡æ„ä»£ç "><a href="#ç”¨èŒè´£é“¾æ¨¡å¼é‡æ„ä»£ç " class="headerlink" title="ç”¨èŒè´£é“¾æ¨¡å¼é‡æ„ä»£ç "></a>ç”¨èŒè´£é“¾æ¨¡å¼é‡æ„ä»£ç </h2><p>â€‹    å…ˆæŠŠ 500 å…ƒè®¢å•ã€200 å…ƒè®¢å•ä»¥åŠæ™®é€šè´­ä¹°åˆ†æˆ 3 ä¸ªå‡½æ•°ã€‚</p><p>â€‹    æ¥ä¸‹æ¥æŠŠ orderTypeã€payã€stock è¿™ 3 ä¸ªå­—æ®µå½“ä½œå‚æ•°ä¼ é€’ç»™ 500 å…ƒè®¢å•å‡½æ•°ï¼Œå¦‚æœè¯¥å‡½æ•°ä¸ç¬¦åˆå¤„ç†æ¡ä»¶ï¼Œåˆ™æŠŠè¿™ä¸ªè¯·æ±‚ä¼ é€’ç»™åé¢çš„ 200 å…ƒè®¢å•å‡½æ•°ï¼Œå¦‚æœ 200 å…ƒè®¢å•å‡½æ•°ä¾ç„¶ä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œåˆ™ç»§ç»­ä¼ é€’è¯·æ±‚ç»™æ™®é€šè´­ä¹°å‡½æ•°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> order500 = <span class="function"><span class="keyword">function</span> (<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (orderType === <span class="number">1</span> &amp;&amp; pay === <span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;500 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 100 ä¼˜æƒ åˆ¸&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;nextSuccessor&quot;</span>; <span class="comment">// æˆ‘ä¸çŸ¥é“ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯è°ï¼Œåæ­£æŠŠè¯·æ±‚å¾€åé¢ä¼ é€’</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> order200 = <span class="function"><span class="keyword">function</span> (<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (orderType === <span class="number">2</span> &amp;&amp; pay === <span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;200 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 50 ä¼˜æƒ åˆ¸&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;nextSuccessor&quot;</span>; <span class="comment">// æˆ‘ä¸çŸ¥é“ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯è°ï¼Œåæ­£æŠŠè¯·æ±‚å¾€åé¢ä¼ é€’</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> orderNormal = <span class="function"><span class="keyword">function</span> (<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (stock &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;æ‰‹æœºåº“å­˜ä¸è¶³&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Chain.prototype.setNextSuccessor æŒ‡å®šåœ¨é“¾ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">// Chain.prototype.passRequest ä¼ é€’è¯·æ±‚ç»™æŸä¸ªèŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">let</span> Chain = <span class="function"><span class="keyword">function</span> (<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.fn = fn;</span><br><span class="line">  <span class="built_in">this</span>.successor = <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Chain.prototype.setNextSuccessor = <span class="function"><span class="keyword">function</span> (<span class="params">successor</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.successor = successor;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Chain.prototype.passRequest = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> ret = <span class="built_in">this</span>.fn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">  <span class="keyword">if</span> (ret === <span class="string">&quot;nextSuccessor&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.successor &amp;&amp; <span class="built_in">this</span>.successor.passRequest.apply(<span class="built_in">this</span>.successor, <span class="built_in">arguments</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> chainOrder500 = <span class="keyword">new</span> Chain(order500);</span><br><span class="line"><span class="keyword">let</span> chainOrder200 = <span class="keyword">new</span> Chain(order200);</span><br><span class="line"><span class="keyword">let</span> chainOrderNormal = <span class="keyword">new</span> Chain(orderNormal);</span><br><span class="line"></span><br><span class="line">chainOrder500.setNextSuccessor(chainOrder200);</span><br><span class="line">chainOrder200.setNextSuccessor(chainOrderNormal);</span><br><span class="line"></span><br><span class="line">chainOrder500.passRequest(<span class="number">1</span>, <span class="literal">true</span>, <span class="number">500</span>);   <span class="comment">// è¾“å‡º:500 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 100 ä¼˜æƒ åˆ¸</span></span><br><span class="line">chainOrder500.passRequest(<span class="number">2</span>, <span class="literal">true</span>, <span class="number">500</span>);   <span class="comment">// è¾“å‡º:200 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 50 ä¼˜æƒ åˆ¸</span></span><br><span class="line">chainOrder500.passRequest(<span class="number">3</span>, <span class="literal">true</span>, <span class="number">500</span>);   <span class="comment">// è¾“å‡º:æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸</span></span><br><span class="line">chainOrder500.passRequest(<span class="number">1</span>, <span class="literal">false</span>, <span class="number">0</span>);    <span class="comment">// è¾“å‡º:æ‰‹æœºåº“å­˜ä¸è¶³</span></span><br></pre></td></tr></table></figure><h2 id="å¼‚æ­¥çš„èŒè´£é“¾"><a href="#å¼‚æ­¥çš„èŒè´£é“¾" class="headerlink" title="å¼‚æ­¥çš„èŒè´£é“¾"></a>å¼‚æ­¥çš„èŒè´£é“¾</h2><p>â€‹    åœ¨ç°å®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸€äº›å¼‚æ­¥çš„é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦åœ¨èŠ‚ç‚¹å‡½æ•°ä¸­å‘èµ·ä¸€ä¸ª ajax å¼‚æ­¥è¯·æ±‚ï¼Œå¼‚æ­¥è¯·æ±‚è¿”å›çš„ç»“æœæ‰èƒ½å†³å®šæ˜¯å¦ç»§ç»­åœ¨èŒè´£é“¾ä¸­ passRequestã€‚ è¿™æ—¶å€™è®©èŠ‚ç‚¹å‡½æ•°åŒæ­¥è¿”å› â€œnextSuccessorâ€ å·²ç»æ²¡æœ‰æ„ä¹‰äº†ï¼Œæ‰€ä»¥è¦ç»™ Chain ç±»å†å¢åŠ ä¸€ä¸ªåŸå‹æ–¹æ³• Chain.prototype.nextï¼Œè¡¨ç¤ºæ‰‹åŠ¨ä¼ é€’è¯·æ±‚ç»™èŒè´£é“¾ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Chain.prototype.next = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.successor &amp;&amp; <span class="built_in">this</span>.successor.passRequest.apply(<span class="built_in">this</span>.successor, <span class="built_in">arguments</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼‚æ­¥èŒè´£é“¾</span></span><br><span class="line"><span class="keyword">let</span> fn1 = <span class="keyword">new</span> Chain(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;nextSuccessor&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> fn2 = <span class="keyword">new</span> Chain(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">  <span class="keyword">let</span> self = <span class="built_in">this</span>;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    self.next();</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> fn3 = <span class="keyword">new</span> Chain(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line">&#125;);</span><br><span class="line">fn1.setNextSuccessor(fn2).setNextSuccessor(fn3);</span><br><span class="line">fn1.passRequest();</span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªç‰¹æ®Šçš„é“¾æ¡ï¼Œè¯·æ±‚åœ¨é“¾ä¸­çš„èŠ‚ç‚¹é‡Œä¼ é€’ï¼Œä½†èŠ‚ç‚¹æœ‰æƒåˆ©å†³å®šä»€ä¹ˆæ—¶å€™æŠŠ è¯·æ±‚äº¤ç»™ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚å¯ä»¥æƒ³è±¡ï¼Œå¼‚æ­¥çš„èŒè´£é“¾åŠ ä¸Šå‘½ä»¤æ¨¡å¼(æŠŠ ajax è¯·æ±‚å°è£…æˆå‘½ä»¤å¯¹è±¡)ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åˆ›å»ºä¸€ä¸ªå¼‚æ­¥ ajax é˜Ÿåˆ—åº“ã€‚</p><h2 id="AOPå®ç°èŒè´£é“¾"><a href="#AOPå®ç°èŒè´£é“¾" class="headerlink" title="AOPå®ç°èŒè´£é“¾"></a>AOPå®ç°èŒè´£é“¾</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.after = <span class="function"><span class="keyword">function</span> (<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> self = <span class="built_in">this</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> ret = self.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    <span class="keyword">if</span> (ret === <span class="string">&quot;nextSuccessor&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> fn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> order = order500.after(order200).after(orderNormal);</span><br><span class="line">order(<span class="number">1</span>, <span class="literal">true</span>, <span class="number">500</span>);    <span class="comment">// è¾“å‡º:500 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 100 ä¼˜æƒ åˆ¸</span></span><br><span class="line">order(<span class="number">2</span>, <span class="literal">true</span>, <span class="number">500</span>);    <span class="comment">// è¾“å‡º:200 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 50 ä¼˜æƒ åˆ¸</span></span><br><span class="line">order(<span class="number">1</span>, <span class="literal">false</span>, <span class="number">500</span>);   <span class="comment">// è¾“å‡º:æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸</span></span><br></pre></td></tr></table></figure><h2 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h2><p>ä½†æ˜¯èŒè´£é“¾æ¨¡å¼å¹¶ä¸èƒ½ä¿è¯æŸä¸ªè¯·æ±‚ä¸€å®šä¼šè¢«é“¾ä¸­çš„èŠ‚ç‚¹å¤„ç†ï¼Œè€Œæ˜¯å¾„ç›´çš„ä»é“¾å°¾ç¦»å¼€ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é“¾å°¾<strong>å¢åŠ ä¸€ä¸ªä¿åº•çš„æ¥å—è€…èŠ‚ç‚¹æ¥å¤„ç†è¿™ç§å³å°†ç¦»å¼€é“¾å°¾çš„è¯·æ±‚</strong>ã€‚</p><p>å¹¶ä¸”èŒè´£é“¾æ¨¡å¼ä½¿å¾—ç¨‹åºä¸­å¤šäº†ä¸€äº›èŠ‚ç‚¹å¯¹è±¡ï¼Œå¯èƒ½åœ¨æŸä¸€æ¬¡çš„è¯·æ±‚ä¼ é€’è¿‡ç¨‹ä¸­ï¼Œå¹¶æ²¡æœ‰èµ·åˆ°å®è´¨æ€§çš„ä½œç”¨ï¼Œå®ƒä»¬çš„ä½œç”¨ä»…ä»…æ˜¯è®©è¯·æ±‚ä¼ é€’ä¸‹å»ï¼Œä»æ€§èƒ½æ–¹é¢è€ƒè™‘ï¼Œæˆ‘ä»¬è¦<strong>é¿å…è¿‡é•¿çš„èŒè´£é“¾</strong></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;èŒè´£é“¾æ¨¡å¼&quot;&gt;&lt;a href=&quot;#èŒè´£é“¾æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;èŒè´£é“¾æ¨¡å¼&quot;&gt;&lt;/a&gt;èŒè´£é“¾æ¨¡å¼&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;èŒè´£é“¾æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»
      
    
    </summary>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>äº«å…ƒæ¨¡å¼</title>
    <link href="https://liang5757.github.io/2021/02/06/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/"/>
    <id>https://liang5757.github.io/2021/02/06/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/</id>
    <published>2021-02-06T07:35:23.000Z</published>
    <updated>2021-05-05T17:07:29.754Z</updated>
    
    <content type="html"><![CDATA[<h1 id="äº«å…ƒæ¨¡å¼"><a href="#äº«å…ƒæ¨¡å¼" class="headerlink" title="äº«å…ƒæ¨¡å¼"></a>äº«å…ƒæ¨¡å¼</h1><blockquote><p>äº«å…ƒ(flyweight)æ¨¡å¼æ˜¯ä¸€ç§ç”¨äºæ€§èƒ½ä¼˜åŒ–çš„æ¨¡å¼ï¼Œâ€œflyâ€åœ¨è¿™é‡Œæ˜¯è‹è‡çš„æ„æ€ï¼Œæ„ä¸ºâ€œè‡é‡çº§â€ã€‚äº«å…ƒæ¨¡å¼çš„æ ¸å¿ƒæ˜¯è¿ç”¨å…±äº«æŠ€æœ¯æ¥æœ‰æ•ˆæ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚</p><p>å¦‚æœç³»ç»Ÿä¸­å› ä¸ºåˆ›å»ºäº†å¤§é‡ç±»ä¼¼çš„å¯¹è±¡è€Œå¯¼è‡´å†…å­˜å ç”¨è¿‡é«˜ï¼Œäº«å…ƒæ¨¡å¼å°±éå¸¸æœ‰ç”¨äº†ã€‚åœ¨ JavaScript ä¸­ï¼Œæµè§ˆå™¨ç‰¹åˆ«æ˜¯ç§»åŠ¨ç«¯çš„æµè§ˆå™¨åˆ†é…çš„å†…å­˜å¹¶ä¸ç®—å¤šï¼Œå¦‚ä½•èŠ‚çœå†…å­˜å°±æˆäº†ä¸€ä»¶éå¸¸æœ‰æ„ä¹‰çš„äº‹æƒ…ã€‚</p></blockquote><h2 id="æ•…äº‹èƒŒæ™¯"><a href="#æ•…äº‹èƒŒæ™¯" class="headerlink" title="æ•…äº‹èƒŒæ™¯"></a>æ•…äº‹èƒŒæ™¯</h2><p>â€‹    å‡è®¾æœ‰ä¸ªå†…è¡£å·¥å‚ï¼Œç›®å‰çš„äº§å“æœ‰ 50 ç§ç”·å¼å†…è¡£å’Œ 50 ç§å¥³å£«å†…è¡£ï¼Œä¸ºäº†æ¨é”€äº§å“ï¼Œå·¥å‚å†³å®šç”Ÿäº§ä¸€äº›å¡‘æ–™æ¨¡ç‰¹æ¥ç©¿ä¸Šä»–ä»¬çš„å†…è¡£æ‹æˆå¹¿å‘Šç…§ç‰‡ã€‚ æ­£å¸¸æƒ…å†µä¸‹éœ€è¦ 50ä¸ªç”·æ¨¡ç‰¹å’Œ50ä¸ªå¥³æ¨¡ç‰¹ï¼Œç„¶åè®©ä»–ä»¬æ¯äººåˆ†åˆ«ç©¿ä¸Šä¸€ä»¶å†…è¡£æ¥æ‹ç…§ã€‚</p><h2 id="ä»£ç å®ç°-æœªä½¿ç”¨äº«å…ƒæ¨¡å¼"><a href="#ä»£ç å®ç°-æœªä½¿ç”¨äº«å…ƒæ¨¡å¼" class="headerlink" title="ä»£ç å®ç°(æœªä½¿ç”¨äº«å…ƒæ¨¡å¼)"></a>ä»£ç å®ç°(æœªä½¿ç”¨äº«å…ƒæ¨¡å¼)</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Model</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">sex, underwear</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.sex = sex;</span><br><span class="line">    <span class="built_in">this</span>.underwear = underwear;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">takePhoto</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;sex= &#x27;</span> + <span class="built_in">this</span>.sex + <span class="string">&#x27; underwear=&#x27;</span> + <span class="built_in">this</span>.underwear);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= <span class="number">50</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">let</span> maleModel = <span class="keyword">new</span> Model(<span class="string">&#x27;male&#x27;</span>, <span class="string">&#x27;underwear&#x27;</span> + i);</span><br><span class="line">  maleModel.takePhoto();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">1</span>; j &lt;= <span class="number">50</span>; j++) &#123;</span><br><span class="line">  <span class="keyword">let</span> femaleModel = <span class="keyword">new</span> Model(<span class="string">&#x27;female&#x27;</span>, <span class="string">&#x27;underwear&#x27;</span> + j);</span><br><span class="line">  femaleModel.takePhoto();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€è€ƒï¼šçœŸçš„éœ€è¦å¦‚æ­¤å¤šæ•°é‡çš„å¯¹è±¡å—ï¼Ÿ"><a href="#æ€è€ƒï¼šçœŸçš„éœ€è¦å¦‚æ­¤å¤šæ•°é‡çš„å¯¹è±¡å—ï¼Ÿ" class="headerlink" title="æ€è€ƒï¼šçœŸçš„éœ€è¦å¦‚æ­¤å¤šæ•°é‡çš„å¯¹è±¡å—ï¼Ÿ"></a>æ€è€ƒï¼šçœŸçš„éœ€è¦å¦‚æ­¤å¤šæ•°é‡çš„å¯¹è±¡å—ï¼Ÿ</h2><p>â€‹    å¦‚ä¸Šæ‰€è¿°ï¼Œç°åœ¨ä¸€å…±æœ‰ 50 ç§ç”·å†… è¡£å’Œ 50 ç§å¥³å†…è¡£ï¼Œæ‰€ä»¥ä¸€å…±ä¼šäº§ç”Ÿ 100 ä¸ªå¯¹è±¡ã€‚å¦‚æœå°†æ¥ç”Ÿäº§äº† 10000 ç§å†…è¡£ï¼Œé‚£è¿™ä¸ªç¨‹åºå¯èƒ½ä¼šå› ä¸ºå­˜åœ¨å¦‚æ­¤å¤šçš„å¯¹è±¡å·²ç»æå‰å´©æºƒã€‚ ä¸‹é¢æˆ‘ä»¬æ¥è€ƒè™‘ä¸€ä¸‹å¦‚ä½•ä¼˜åŒ–è¿™ä¸ªåœºæ™¯ã€‚è™½ç„¶æœ‰ 100 ç§å†…è¡£ï¼Œä½†å¾ˆæ˜¾ç„¶å¹¶ä¸éœ€è¦ 50 ä¸ªç”·æ¨¡ç‰¹å’Œ 50 ä¸ªå¥³æ¨¡ç‰¹ã€‚å…¶å®ç”·æ¨¡ç‰¹å’Œå¥³æ¨¡ç‰¹å„è‡ªæœ‰ä¸€ä¸ªå°±è¶³å¤Ÿäº†ï¼Œä»–ä»¬å¯ä»¥åˆ†åˆ«ç©¿ä¸Šä¸åŒçš„å†…è¡£æ¥æ‹ç…§ã€‚</p><h2 id="ä»£ç é‡æ„-äº«å…ƒæ¨¡å¼"><a href="#ä»£ç é‡æ„-äº«å…ƒæ¨¡å¼" class="headerlink" title="ä»£ç é‡æ„(äº«å…ƒæ¨¡å¼)"></a>ä»£ç é‡æ„(äº«å…ƒæ¨¡å¼)</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åªéœ€è¦åŒºåˆ«ç”·å¥³æ¨¡ç‰¹</span></span><br><span class="line"><span class="comment">//  é‚£æˆ‘ä»¬å…ˆæŠŠ underwear å‚æ•°ä»æ„é€ å‡½æ•°ä¸­ ç§»é™¤ï¼Œæ„é€ å‡½æ•°åªæ¥æ”¶ sex å‚æ•°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Model</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">sex</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.sex = sex;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">takePhoto</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;sex= &#x27;</span> + <span class="built_in">this</span>.sex + <span class="string">&#x27; underwear=&#x27;</span> + <span class="built_in">this</span>.underwear);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ†åˆ«åˆ›å»ºä¸€ä¸ªç”·æ¨¡ç‰¹å¯¹è±¡å’Œä¸€ä¸ªå¥³æ¨¡ç‰¹å¯¹è±¡</span></span><br><span class="line"><span class="keyword">let</span> maleModel = <span class="keyword">new</span> Model(<span class="string">&#x27;male&#x27;</span>),</span><br><span class="line">  femaleModel = <span class="keyword">new</span> Model(<span class="string">&#x27;female&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™ç”·æ¨¡ç‰¹ä¾æ¬¡ç©¿ä¸Šæ‰€æœ‰çš„ç”·è£…ï¼Œå¹¶è¿›è¡Œæ‹ç…§</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= <span class="number">50</span>; i++) &#123;</span><br><span class="line">  maleModel.underwear = <span class="string">&#x27;underwear&#x27;</span> + i; <span class="comment">// è®¾ç½®å¤–éƒ¨çŠ¶æ€</span></span><br><span class="line">  maleModel.takePhoto();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™å¥³æ¨¡ç‰¹ä¾æ¬¡ç©¿ä¸Šæ‰€æœ‰çš„å¥³è£…ï¼Œå¹¶è¿›è¡Œæ‹ç…§</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">1</span>; j &lt;= <span class="number">50</span>; j++) &#123;</span><br><span class="line">  femaleModel.underwear = <span class="string">&#x27;underwear&#x27;</span> + j; <span class="comment">// è®¾ç½®å¤–éƒ¨çŠ¶æ€</span></span><br><span class="line">  femaleModel.takePhoto();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åªéœ€è¦ä¸¤ä¸ªå¯¹è±¡ä¾¿å®Œæˆäº†åŒæ ·çš„åŠŸèƒ½</p><h2 id="å¦‚ä½•ä½¿ç”¨äº«å…ƒæ¨¡å¼"><a href="#å¦‚ä½•ä½¿ç”¨äº«å…ƒæ¨¡å¼" class="headerlink" title="å¦‚ä½•ä½¿ç”¨äº«å…ƒæ¨¡å¼"></a>å¦‚ä½•ä½¿ç”¨äº«å…ƒæ¨¡å¼</h2><p>äº«å…ƒæ¨¡å¼è¦æ±‚å°†å¯¹è±¡çš„å±æ€§åˆ’åˆ†ä¸º<strong>å†…éƒ¨çŠ¶æ€</strong>ä¸<strong>å¤–éƒ¨çŠ¶æ€</strong>(çŠ¶æ€åœ¨è¿™é‡Œé€šå¸¸æŒ‡å±æ€§)ã€‚äº«å…ƒæ¨¡å¼çš„ç›®æ ‡æ˜¯å°½é‡å‡å°‘å…±äº«å¯¹è±¡çš„æ•°é‡ï¼Œå…³äºå¦‚ä½•åˆ’åˆ†å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€ï¼Œä¸‹é¢çš„å‡ æ¡ç»éªŒæä¾›äº†ä¸€äº›æŒ‡å¼•</p><ul><li>å†…éƒ¨çŠ¶æ€å¯ä»¥è¢«ä¸€äº›å¯¹è±¡å…±äº«</li><li>å†…éƒ¨çŠ¶æ€ç‹¬ç«‹äºå…·ä½“çš„åœºæ™¯ï¼Œé€šå¸¸ä¸ä¼šæ”¹å˜</li><li>å¤–éƒ¨çŠ¶æ€å–å†³äºå…·ä½“çš„åœºæ™¯ï¼Œå¹¶æ ¹æ®åœºæ™¯è€Œå˜åŒ–ï¼Œå¤–éƒ¨çŠ¶æ€ä¸èƒ½è¢«å…±äº«</li></ul><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<strong>æ€§åˆ«æ˜¯å†…éƒ¨çŠ¶æ€ï¼Œå†…è¡£æ˜¯å¤–éƒ¨çŠ¶æ€</strong>ï¼Œé€šè¿‡åŒºåˆ†è¿™ä¸¤ç§çŠ¶æ€ï¼Œå¤§å¤§å‡å°‘äº†ç³»ç»Ÿä¸­çš„å¯¹è±¡æ•°é‡ã€‚é€šå¸¸æ¥è®²ï¼Œå†…éƒ¨çŠ¶æ€æœ‰å¤šå°‘ç§ç»„åˆï¼Œç³»ç»Ÿä¸­ä¾¿æœ€å¤šå­˜åœ¨å¤šå°‘ä¸ªå¯¹è±¡ï¼Œå› ä¸ºæ€§åˆ«é€šå¸¸åªæœ‰ç”·å¥³ä¸¤ç§ï¼Œæ‰€ä»¥è¯¥å†…è¡£å‚å•†æœ€å¤šåªéœ€è¦ 2 ä¸ªå¯¹è±¡ã€‚</p><h2 id="äº«å…ƒæ¨¡å¼çš„é€šç”¨ç»“æ„"><a href="#äº«å…ƒæ¨¡å¼çš„é€šç”¨ç»“æ„" class="headerlink" title="äº«å…ƒæ¨¡å¼çš„é€šç”¨ç»“æ„"></a>äº«å…ƒæ¨¡å¼çš„é€šç”¨ç»“æ„</h2><h3 id="é—®é¢˜å¼•å…¥"><a href="#é—®é¢˜å¼•å…¥" class="headerlink" title="é—®é¢˜å¼•å…¥"></a>é—®é¢˜å¼•å…¥</h3><ol><li>æˆ‘ä»¬é€šè¿‡æ„é€ å‡½æ•°æ˜¾ç¤º<code>new</code>å‡ºäº†ç”·å¥³ä¸¤ä¸ªmodelå¯¹è±¡ï¼Œåœ¨å…¶ä»–ç³»ç»Ÿä¸­ï¼Œ<strong>ä¹Ÿè®¸å¹¶ä¸æ˜¯ä¸€å¼€å§‹å°±éœ€è¦æ‰€æœ‰çš„å…±äº«å¯¹è±¡</strong></li><li>ç»™<code>model</code>å¯¹è±¡æ‰‹åŠ¨è®¾ç½®äº†<code>underwear</code>å¤–éƒ¨çŠ¶æ€ï¼Œåœ¨æ›´å¤æ‚çš„ç³»ç»Ÿä¸­ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªæœ€å¥½çš„æ–¹å¼ï¼Œå› ä¸º<strong>å¤–éƒ¨çŠ¶æ€å¯èƒ½ç›¸å½“å¤æ‚ï¼Œå®ƒä»¬ä¸å…±äº«å¯¹è±¡çš„è”ç³»ä¼šå˜å¾—å›°éš¾</strong></li></ol><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>ç¬¬ä¸€ä¸ªé—®é¢˜å¯ä»¥ç”¨<strong>å·¥å‚æ¨¡å¼</strong>è§£å†³ï¼Œå¦‚æœæŸç§å†…éƒ¨çŠ¶æ€å¯¹åº”çš„å…±äº«å¯¹è±¡å·²ç»è¢«åˆ›å»ºè¿‡ï¼Œé‚£ä¹ˆç›´æ¥è¿”å›è¿™ä¸ªå¯¹è±¡</p><p>ç¬¬äºŒä¸ªé—®é¢˜å¯ä»¥<strong>ç”¨ä¸€ä¸ªç®¡ç†å™¨è®°å½•å¯¹è±¡ç›¸å…³çš„å¤–éƒ¨çŠ¶æ€</strong>ï¼Œä½¿è¿™äº›å¤–éƒ¨çŠ¶æ€é€šè¿‡æŸä¸ªé’©å­å’Œå…±äº«å¯¹è±¡è”ç³»èµ·æ¥</p><h2 id="äº«å…ƒæ¨¡å¼çš„æ›¿ä»£æ–¹æ¡ˆ-â€”â€”-å¯¹è±¡æ± "><a href="#äº«å…ƒæ¨¡å¼çš„æ›¿ä»£æ–¹æ¡ˆ-â€”â€”-å¯¹è±¡æ± " class="headerlink" title="äº«å…ƒæ¨¡å¼çš„æ›¿ä»£æ–¹æ¡ˆ â€”â€” å¯¹è±¡æ± "></a>äº«å…ƒæ¨¡å¼çš„æ›¿ä»£æ–¹æ¡ˆ â€”â€” å¯¹è±¡æ± </h2><p>â€‹    å¯¹è±¡æ± æ˜¯å¦å¤–ä¸€ç§æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆï¼Œå®ƒè·Ÿäº«å…ƒæ¨¡å¼æœ‰ä¸€äº›ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†æ²¡æœ‰åˆ†ç¦»å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€è¿™ä¸ªè¿‡ç¨‹ã€‚å¯¹è±¡æ± ç»´æŠ¤ä¸€ä¸ªè£…è½½ç©ºé—²å¯¹è±¡çš„æ± å­ï¼Œå¦‚æœéœ€è¦å¯¹è±¡çš„æ—¶å€™ï¼Œä¸æ˜¯ç›´æ¥ newï¼Œè€Œæ˜¯è½¬ä»å¯¹è±¡æ± é‡Œè·å–ã€‚å¦‚æœå¯¹è±¡æ± é‡Œæ²¡æœ‰ç©ºé—²å¯¹è±¡ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå½“è·å–å‡ºçš„å¯¹è±¡å®Œæˆå®ƒçš„èŒè´£ä¹‹åï¼Œ å†è¿›å…¥æ± å­ç­‰å¾…è¢«ä¸‹æ¬¡è·å–ã€‚</p><h3 id="é€šç”¨çš„å¯¹è±¡æ± å®ç°"><a href="#é€šç”¨çš„å¯¹è±¡æ± å®ç°" class="headerlink" title="é€šç”¨çš„å¯¹è±¡æ± å®ç°"></a>é€šç”¨çš„å¯¹è±¡æ± å®ç°</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é€šç”¨çš„å¯¹è±¡æ± </span></span><br><span class="line"><span class="keyword">let</span> objectPoolFactory = <span class="function"><span class="keyword">function</span> (<span class="params">createObjFn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> objectPool = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    create: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> objectPool.length === <span class="number">0</span> ?</span><br><span class="line">        createObjFn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>) : objectPool.shift();</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    recover: <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">      objectPool.push(obj);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç°åœ¨åˆ©ç”¨<code>objectPoolFactory</code>æ¥åˆ›å»ºä¸€ä¸ªè£…è½½ä¸€äº› iframe çš„å¯¹è±¡æ± </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> iframeFactory = objectPoolFactory(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> iframe = <span class="built_in">document</span>.createElement(<span class="string">&quot;iframe&quot;</span>);</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(iframe);</span><br><span class="line">  iframe.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    iframe.onload = <span class="literal">null</span>; <span class="comment">// é˜²æ­¢ iframe é‡å¤åŠ è½½çš„ bug</span></span><br><span class="line">    iframeFactory.recover(iframe);<span class="comment">// iframe åŠ è½½å®Œæˆä¹‹åå›æ”¶èŠ‚ç‚¹</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> iframe;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> iframe1 = iframeFactory.create();</span><br><span class="line">iframe1.src = <span class="string">&quot;http:// baidu.com&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> iframe2 = iframeFactory.create();</span><br><span class="line">iframe2.src = <span class="string">&quot;http:// QQ.com&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> iframe3 = iframeFactory.create();</span><br><span class="line">  iframe3.src = <span class="string">&quot;http:// 163.com&quot;</span>;</span><br><span class="line">&#125;, <span class="number">3000</span>);</span><br></pre></td></tr></table></figure><p>å¯¹è±¡æ± çš„åº”ç”¨éå¸¸å¹¿æ³›ï¼ŒHTTPè¿æ¥æ± å’Œæ•°æ®åº“è¿æ¥æ± éƒ½æ˜¯å…¶ä»£è¡¨åº”ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨åœ¨domçš„é‡å¤åˆ©ç”¨ä¸Šã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;äº«å…ƒæ¨¡å¼&quot;&gt;&lt;a href=&quot;#äº«å…ƒæ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;äº«å…ƒæ¨¡å¼&quot;&gt;&lt;/a&gt;äº«å…ƒæ¨¡å¼&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;äº«å…ƒ(flyweight)æ¨¡å¼æ˜¯ä¸€ç§ç”¨äºæ€§èƒ½ä¼˜åŒ–çš„æ¨¡å¼ï¼Œâ€œflyâ€åœ¨è¿™é‡Œæ˜¯è‹è‡çš„æ„æ€ï¼Œæ„ä¸ºâ€œè‡é‡çº§
      
    
    </summary>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</title>
    <link href="https://liang5757.github.io/2021/02/05/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/"/>
    <id>https://liang5757.github.io/2021/02/05/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/</id>
    <published>2021-02-05T07:34:10.000Z</published>
    <updated>2021-05-05T17:07:23.639Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ¨¡æ¿æ–¹æ³•æ¨¡å¼"><a href="#æ¨¡æ¿æ–¹æ³•æ¨¡å¼" class="headerlink" title="æ¨¡æ¿æ–¹æ³•æ¨¡å¼"></a>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</h1><blockquote><p>åœ¨æ¨¡æ¿æ¨¡å¼ï¼ˆTemplate Patternï¼‰ä¸­ï¼Œä¸€ä¸ªæŠ½è±¡ç±»å…¬å¼€å®šä¹‰äº†æ‰§è¡Œå®ƒçš„æ–¹æ³•çš„æ–¹å¼/æ¨¡æ¿ã€‚å®ƒçš„å­ç±»å¯ä»¥æŒ‰éœ€è¦é‡å†™æ–¹æ³•å®ç°ï¼Œä½†è°ƒç”¨å°†ä»¥æŠ½è±¡ç±»ä¸­å®šä¹‰çš„æ–¹å¼è¿›è¡Œ</p></blockquote><h2 id="Coffee-or-Tea"><a href="#Coffee-or-Tea" class="headerlink" title="Coffee or Tea"></a>Coffee or Tea</h2><p>æˆ‘ä»¬ç°åœ¨éœ€è¦å†²æ³¡ä¸€æ¯å’–å•¡å’Œä¸€å£¶èŒ¶ï¼Œå®ƒä»¬çš„æ“ä½œæ­¥éª¤åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œå¦‚ä¸‹æ‰€ç¤º</p><table><thead><tr><th>æ³¡å’–å•¡</th><th>æ³¡èŒ¶</th></tr></thead><tbody><tr><td>æŠŠæ°´ç…®æ²¸</td><td>æŠŠæ°´ç…®æ²¸</td></tr><tr><td>ç”¨æ²¸æ°´å†²æ³¡<strong>å’–å•¡</strong></td><td>ç”¨æ²¸æ°´æµ¸æ³¡<strong>èŒ¶å¶</strong></td></tr><tr><td>æŠŠ<strong>å’–å•¡</strong>å€’è¿›æ¯å­</td><td>æŠŠ<strong>èŒ¶æ°´</strong>å€’è¿›æ¯å­</td></tr><tr><td><strong>åŠ ç³–å’Œç‰›å¥¶</strong></td><td><strong>åŠ æŸ æª¬</strong></td></tr></tbody></table><p> åŸºæœ¬çš„æ­¥éª¤æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æŠ½è±¡ç±»çš„å½¢å¼ï¼ŒæŠŠæ­¥éª¤æ¡†æ¶æŠ½è±¡å‡ºæ¥ï¼ŒCoffeeç±»å’ŒTeaç±»ç»§æ‰¿è¿™ä¸ªæŠ½è±¡ç±»ï¼Œå†å„è‡ªå®ç°æŠ½è±¡çˆ¶ç±»ä¸Šçš„æ–¹æ³•ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªæŠ½è±¡çˆ¶ç±»æ¥è¡¨ç¤ºæ³¡ä¸€æ¯é¥®æ–™çš„æ•´ä¸ªè¿‡ç¨‹ã€‚</span></span><br><span class="line"><span class="comment">// ä¸è®ºæ˜¯ Coffee,è¿˜æ˜¯ Tea,éƒ½è¢«æˆ‘ä»¬ç”¨Beverageæ¥è¡¨ç¤º</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Beverage</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">boilWater</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;æŠŠæ°´ç…®æ²¸&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">brew</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;å­ç±»å¿…é¡»é‡å†™ brew æ–¹æ³•&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">pourInCup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;å­ç±»å¿…é¡»é‡å†™ pourInCup æ–¹æ³•&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">addCondiments</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;å­ç±»å¿…é¡»é‡å†™ addCondiments æ–¹æ³•&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">init</span>(<span class="params"></span>)</span> &#123; <span class="comment">// æ¨¡æ¿æ–¹æ³•</span></span><br><span class="line">    <span class="built_in">this</span>.boilWater();</span><br><span class="line">    <span class="built_in">this</span>.brew();</span><br><span class="line">    <span class="built_in">this</span>.pourInCup();</span><br><span class="line">    <span class="built_in">this</span>.addCondiments();</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºCoffeeç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Coffee</span> <span class="keyword">extends</span> <span class="title">Beverage</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">brew</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;ç”¨æ²¸æ°´å†²æ³¡å’–å•¡&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">pourInCup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;æŠŠå’–å•¡å€’è¿›æ¯å­&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">addCondiments</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;åŠ ç³–å’Œç‰›å¥¶&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> coffee = <span class="keyword">new</span> Coffee();</span><br><span class="line">coffee.init();</span><br><span class="line"><span class="comment">// æŠŠæ°´ç…®æ²¸</span></span><br><span class="line"><span class="comment">// ç”¨æ²¸æ°´å†²æ³¡å’–å•¡</span></span><br><span class="line"><span class="comment">// æŠŠå’–å•¡å€’è¿›æ¯å­</span></span><br><span class="line"><span class="comment">// åŠ ç³–å’Œç‰›å¥¶</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºTeaç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tea</span> <span class="keyword">extends</span> <span class="title">Beverage</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">brew</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">pourInCup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;æŠŠèŒ¶å€’è¿›æ¯å­&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">addCondiments</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;åŠ æŸ æª¬&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> tea = <span class="keyword">new</span> Tea();</span><br><span class="line">tea.init();</span><br><span class="line"><span class="comment">// æŠŠæ°´ç…®æ²¸</span></span><br><span class="line"><span class="comment">// ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶</span></span><br><span class="line"><span class="comment">// æŠŠèŒ¶å€’è¿›æ¯å­</span></span><br><span class="line"><span class="comment">// åŠ æŸ æª¬</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼ŒBeverageçˆ¶ç±»é‡Œçš„<code>init</code>æ–¹æ³•å³ä¸º<strong>æ¨¡æ¿æ–¹æ³•</strong>ï¼Œinitå°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æ¶ï¼Œä½œä¸ºç®—æ³•çš„æ¨¡æ¿ï¼ŒæŒ‡å¯¼å­ç±»ä»¥ä½•ç§é¡ºåºå»æ‰§è¡Œå“ªäº›æ–¹æ³•ã€‚</p><h2 id="å¥½è±ååŸåˆ™"><a href="#å¥½è±ååŸåˆ™" class="headerlink" title="å¥½è±ååŸåˆ™"></a>å¥½è±ååŸåˆ™</h2><p>â€‹    å¥½è±åæ— ç–‘æ˜¯æ¼”å‘˜çš„å¤©å ‚ï¼Œä½†å¥½è±åä¹Ÿæœ‰å¾ˆå¤šæ‰¾ä¸åˆ°å·¥ä½œçš„æ–°äººæ¼”å‘˜ï¼Œè®¸å¤šæ–°äººæ¼”å‘˜åœ¨å¥½è±åæŠŠç®€å†é€’ç»™æ¼”è‰ºå…¬å¸ä¹‹åå°±åªæœ‰å›å®¶ç­‰å¾…ç”µè¯ã€‚æœ‰æ—¶å€™è¯¥æ¼”å‘˜ç­‰å¾—ä¸è€çƒ¦äº†ï¼Œç»™æ¼”è‰ºå…¬å¸æ‰“ç”µè¯è¯¢é—®æƒ…å†µï¼Œæ¼”è‰ºå…¬å¸å¾€å¾€è¿™æ ·å›ç­”ï¼šâ€œä¸è¦æ¥æ‰¾æˆ‘ï¼Œæˆ‘ä¼šç»™ä½ æ‰“ç”µè¯ã€‚â€ åœ¨è®¾è®¡ä¸­ï¼Œè¿™æ ·çš„è§„åˆ™å°±ç§°ä¸ºå¥½è±ååŸåˆ™ã€‚åœ¨è¿™ä¸€åŸåˆ™çš„æŒ‡å¯¼ä¸‹ï¼Œæˆ‘ä»¬å…è®¸åº•å±‚ç»„ä»¶å°†è‡ªå·±æŒ‚é’©åˆ°é«˜å±‚ç»„ä»¶ä¸­ï¼Œè€Œé«˜å±‚ç»„ä»¶ä¼šå†³å®šä»€ä¹ˆæ—¶å€™ã€ä»¥ä½•ç§æ–¹å¼å»ä½¿ç”¨è¿™äº›åº•å±‚ç»„ä»¶ï¼Œé«˜å±‚ç»„ä»¶å¯¹ å¾…åº•å±‚ç»„ä»¶çš„æ–¹å¼ï¼Œè·Ÿæ¼”è‰ºå…¬å¸å¯¹å¾…æ–°äººæ¼”å‘˜ä¸€æ ·ï¼Œéƒ½æ˜¯â€œåˆ«è°ƒç”¨æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨ä½ â€ã€‚<br>â€‹    æ¯”å¦‚å‘å¸ƒè®¢é˜…æ¨¡å¼å’Œå›è°ƒå‡½æ•°</p><h2 id="æ˜¯å¦çœŸçš„éœ€è¦ç»§æ‰¿"><a href="#æ˜¯å¦çœŸçš„éœ€è¦ç»§æ‰¿" class="headerlink" title="æ˜¯å¦çœŸçš„éœ€è¦ç»§æ‰¿"></a>æ˜¯å¦çœŸçš„éœ€è¦ç»§æ‰¿</h2><p>åœ¨JavaScriptè¿™ç§çµæ´»çš„è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬æ˜¯å¦çœŸçš„éœ€è¦ä½¿ç”¨ç»§æ‰¿è¿™ç§é‡æ­¦å™¨å‘¢ã€‚åœ¨å¥½è±ååŸåˆ™çš„æŒ‡å¯¼ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é‡æ„ä¸Šé¢çš„ä»£ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Beverage = <span class="function"><span class="keyword">function</span> (<span class="params">param</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> boilWater = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;æŠŠæ°´ç…®æ²¸&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">let</span> brew = param.brew || <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;å¿…é¡»ä¼ é€’ brew æ–¹æ³•&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">let</span> pourInCup = param.pourInCup || <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;å¿…é¡»ä¼ é€’ pourInCup æ–¹æ³•&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">let</span> addCondiments = param.addCondiments || <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;å¿…é¡»ä¼ é€’ addCondiments æ–¹æ³•&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">let</span> F = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">  F.prototype.init = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    boilWater();</span><br><span class="line">    brew();</span><br><span class="line">    pourInCup();</span><br><span class="line">    addCondiments();</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> F;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> Coffee = Beverage(&#123;</span><br><span class="line">  <span class="function"><span class="title">brew</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;ç”¨æ²¸æ°´å†²æ³¡å’–å•¡&#x27;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">pourInCup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;æŠŠå’–å•¡å€’è¿›æ¯å­&#x27;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">addCondiments</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;åŠ ç³–å’Œç‰›å¥¶&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> Tea = Beverage(&#123;</span><br><span class="line">  <span class="function"><span class="title">brew</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶&#x27;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">pourInCup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;æŠŠèŒ¶å€’è¿›æ¯å­&#x27;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">addCondiments</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;åŠ æŸ æª¬&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>â€‹    æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ˜¯ä¸€ç§å…¸å‹çš„é€šè¿‡å°è£…å˜åŒ–æé«˜ç³»ç»Ÿæ‰©å±•æ€§çš„è®¾è®¡æ¨¡å¼ã€‚åœ¨ä¼ ç»Ÿçš„é¢å‘å¯¹è±¡è¯­è¨€ä¸­ï¼Œä¸€ä¸ªè¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ç¨‹åºä¸­ï¼Œå­ç±»çš„æ–¹æ³•ç§ç±»å’Œæ‰§è¡Œé¡ºåºéƒ½æ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¿™éƒ¨åˆ†é€»è¾‘æŠ½è±¡åˆ°çˆ¶ç±»çš„æ¨¡æ¿æ–¹æ³•é‡Œé¢ã€‚è€Œå­ç±»çš„æ–¹æ³•å…·ä½“æ€ä¹ˆå®ç°åˆ™æ˜¯å¯å˜çš„ï¼Œäºæ˜¯æˆ‘ä»¬æŠŠè¿™éƒ¨åˆ†å˜åŒ–çš„é€»è¾‘å°è£…åˆ°å­ç±»ä¸­ã€‚é€šè¿‡å¢åŠ æ–°çš„å­ç±»ï¼Œæˆ‘ä»¬ä¾¿èƒ½ç»™ç³»ç»Ÿå¢åŠ æ–°çš„åŠŸèƒ½ï¼Œå¹¶ä¸éœ€è¦æ”¹åŠ¨æŠ½è±¡çˆ¶ç±»ä»¥åŠå…¶ä»–å­ç±»ï¼Œè¿™ä¹Ÿæ˜¯ç¬¦åˆå¼€æ”¾-å°é—­åŸåˆ™çš„ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;æ¨¡æ¿æ–¹æ³•æ¨¡å¼&quot;&gt;&lt;a href=&quot;#æ¨¡æ¿æ–¹æ³•æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;æ¨¡æ¿æ–¹æ³•æ¨¡å¼&quot;&gt;&lt;/a&gt;æ¨¡æ¿æ–¹æ³•æ¨¡å¼&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;åœ¨æ¨¡æ¿æ¨¡å¼ï¼ˆTemplate Patternï¼‰ä¸­ï¼Œä¸€ä¸ªæŠ½è±¡ç±»å…¬å¼€å®šä¹‰äº†æ‰§è¡Œå®ƒçš„æ–¹æ³•
      
    
    </summary>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>ç»„åˆæ¨¡å¼</title>
    <link href="https://liang5757.github.io/2021/02/04/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/"/>
    <id>https://liang5757.github.io/2021/02/04/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/</id>
    <published>2021-02-04T07:32:50.000Z</published>
    <updated>2021-05-05T17:07:41.444Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç»„åˆæ¨¡å¼"><a href="#ç»„åˆæ¨¡å¼" class="headerlink" title="ç»„åˆæ¨¡å¼"></a>ç»„åˆæ¨¡å¼</h1><blockquote><p>ç»„åˆæ¨¡å¼å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ï¼Œä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ã€‚ é™¤äº†ç”¨æ¥è¡¨ç¤ºæ ‘å½¢ç»“æ„ä¹‹å¤–ï¼Œç»„åˆæ¨¡å¼çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯é€šè¿‡å¯¹è±¡çš„å¤šæ€æ€§è¡¨ç°ï¼Œä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§</p></blockquote><p>â€‹    åœ¨ç»„åˆæ¨¡å¼ä¸­ï¼Œè¯·æ±‚åœ¨æ ‘ä¸­ä¼ é€’çš„è¿‡ç¨‹æ€»æ˜¯éµå¾ªä¸€ç§é€»è¾‘ã€‚è¯·æ±‚ä»æ ‘æœ€é¡¶ç«¯çš„å¯¹è±¡å¾€ä¸‹ä¼ é€’ï¼Œå¦‚æœå½“å‰å¤„ç†è¯·æ±‚çš„å¯¹è±¡æ˜¯å¶å¯¹è±¡(æ™®é€šå­å‘½ä»¤)ï¼Œå¶å¯¹è±¡è‡ªèº«ä¼šå¯¹è¯·æ±‚ä½œå‡ºç›¸åº”çš„å¤„ç†ï¼Œå¦‚æœå½“å‰å¤„ç†è¯·æ±‚çš„å¯¹è±¡æ˜¯ç»„åˆå¯¹è±¡(å®å‘½ä»¤)ï¼Œ ç»„åˆå¯¹è±¡åˆ™ä¼šéå†å®ƒå±ä¸‹çš„å­èŠ‚ç‚¹ï¼Œå°†è¯·æ±‚ç»§ç»­ä¼ é€’ç»™è¿™äº›å­èŠ‚ç‚¹ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="/2021/02/04/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/167b6de69881f746" alt="ç»„åˆæ¨¡å¼è¯·æ±‚ä¼ é€’æ–¹å¼"></p><h2 id="ç»„åˆæ¨¡å¼ä¸‹æ›´ä¸ºå¼ºå¤§çš„å®å‘½ä»¤"><a href="#ç»„åˆæ¨¡å¼ä¸‹æ›´ä¸ºå¼ºå¤§çš„å®å‘½ä»¤" class="headerlink" title="ç»„åˆæ¨¡å¼ä¸‹æ›´ä¸ºå¼ºå¤§çš„å®å‘½ä»¤"></a>ç»„åˆæ¨¡å¼ä¸‹æ›´ä¸ºå¼ºå¤§çš„å®å‘½ä»¤</h2><p>â€‹    ç›®å‰çš„ä¸‡èƒ½é¥æ§å™¨ï¼ŒåŒ…å«äº†å…³é—¨ã€å¼€ç”µè„‘ã€ç™»å½• QQ è¿™ 3 ä¸ªå‘½ä»¤ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦ä¸€ä¸ªâ€œè¶…çº§ä¸‡èƒ½é¥æ§å™¨â€ï¼Œå¯ä»¥æ§åˆ¶å®¶é‡Œæ‰€æœ‰çš„ç”µå™¨ï¼Œè¿™ä¸ªé¥æ§å™¨æ‹¥æœ‰ä»¥ä¸‹åŠŸèƒ½</p><ul><li>æ‰“å¼€ç©ºè°ƒ</li><li>æ‰“å¼€ç”µè§†å’ŒéŸ³å“</li><li>å…³é—¨ã€å¼€ç”µè„‘ã€ç™»å½• QQ</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> MacroCommand = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    commandsList: [],</span><br><span class="line">    add: <span class="function"><span class="keyword">function</span> (<span class="params">command</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">this</span>.commandsList.push(command);</span><br><span class="line">    &#125;,</span><br><span class="line">    execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, command; command = <span class="built_in">this</span>.commandsList[i++];) &#123;</span><br><span class="line">        command.execute();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> openAcCommand = &#123;</span><br><span class="line">  execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;æ‰“å¼€ç©ºè°ƒ&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// å®¶é‡Œçš„ç”µè§†å’ŒéŸ³å“æ˜¯è¿æ¥åœ¨ä¸€èµ·çš„ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ä¸€ä¸ªå®å‘½ä»¤æ¥ç»„åˆæ‰“å¼€ç”µè§†å’Œæ‰“å¼€éŸ³å“çš„å‘½ä»¤</span></span><br><span class="line"><span class="keyword">let</span> openTvCommand = &#123;</span><br><span class="line">  execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;æ‰“å¼€ç”µè§†&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> openSoundCommand = &#123;</span><br><span class="line">  execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;æ‰“å¼€éŸ³å“&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> macroCommand1 = MacroCommand();</span><br><span class="line">macroCommand1.add(openTvCommand);</span><br><span class="line">macroCommand1.add(openSoundCommand);</span><br><span class="line"><span class="comment">// å…³é—¨ã€æ‰“å¼€ç”µè„‘å’Œæ‰“ç™»å½• QQ çš„å‘½ä»¤</span></span><br><span class="line"><span class="keyword">let</span> closeDoorCommand = &#123;</span><br><span class="line">  execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;å…³é—¨&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> openPcCommand = &#123;</span><br><span class="line">  execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;å¼€ç”µè„‘&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> openQQCommand = &#123;</span><br><span class="line">  execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;ç™»å½• QQ&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> macroCommand2 = MacroCommand();</span><br><span class="line">macroCommand2.add(closeDoorCommand);</span><br><span class="line">macroCommand2.add(openPcCommand);</span><br><span class="line">macroCommand2.add(openQQCommand);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç°åœ¨æŠŠæ‰€æœ‰çš„å‘½ä»¤ç»„åˆæˆä¸€ä¸ªâ€œè¶…çº§å‘½ä»¤â€</span></span><br><span class="line"><span class="keyword">let</span> macroCommand = MacroCommand();</span><br><span class="line">macroCommand.add(openAcCommand);</span><br><span class="line">macroCommand.add(macroCommand1);</span><br><span class="line">macroCommand.add(macroCommand2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ€åç»™é¥æ§å™¨ç»‘å®šâ€œè¶…çº§å‘½ä»¤â€</span></span><br><span class="line"><span class="keyword">let</span> setCommand = (<span class="function"><span class="keyword">function</span> (<span class="params">command</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">&#x27;button&#x27;</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    command.execute();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)(macroCommand);</span><br></pre></td></tr></table></figure><p>â€‹    <strong>ä¸ç®¡æ˜¯å®å‘½ä»¤å¯¹è±¡ï¼Œè¿˜æ˜¯å­å‘½ä»¤å¯¹è±¡ï¼Œéƒ½æœ‰ä¸€ä¸ªexecuteæ–¹æ³•è´Ÿè´£æ‰§è¡Œå‘½ä»¤</strong>ã€‚<br>â€‹    è¿™åœ¨é™æ€ç±»å‹è¯­è¨€ä¸­å®ç°æ˜¾çš„å°¤ä¸ºä¾¿åˆ©ï¼Œæ¯”å¦‚åœ¨JAVAä¸­ï¼Œ<code>Composite</code>ç±»å’Œ<code>Leaf</code>ç±»éƒ½å¿…é¡»ç»§æ‰¿è‡ªä¸€ä¸ª<code>Compenent</code>æŠ½è±¡ç±»ï¼Œè¿™ä¸ªCompenentæŠ½è±¡å³è¡¨ç¤ºç»„åˆå¯¹è±¡ï¼Œåˆä»£è¡¨å¶å¯¹è±¡ï¼Œå®ƒä¹Ÿèƒ½ä¿è¯ä¸¤è€…å‡æœ‰<code>execute</code>æ–¹æ³•ï¼Œä»è€Œåšå‡ºåé¦ˆã€‚</p><p>â€‹    ä½†æ˜¯åœ¨JavaScriptè¿™ç§åŠ¨æ€è¯­è¨€ä¸­å®ç°ç»„åˆæ¨¡å¼ï¼Œç”±äºé¸­å­ç±»å‹ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦æœ‰ä¸€ä¸ª<code>Compenent</code>æŠ½è±¡ç±»ï¼Œä½†æ˜¯è¿™ä¹Ÿå¯¼è‡´äº†ä¸€å®šçš„ä¸¥è°¨æ€§ã€‚</p><h2 id="é€æ˜æ€§å¸¦æ¥çš„å®‰å…¨é—®é¢˜"><a href="#é€æ˜æ€§å¸¦æ¥çš„å®‰å…¨é—®é¢˜" class="headerlink" title="é€æ˜æ€§å¸¦æ¥çš„å®‰å…¨é—®é¢˜"></a>é€æ˜æ€§å¸¦æ¥çš„å®‰å…¨é—®é¢˜</h2><p>æˆ‘ä»¬å¯ä»¥ç»™å¶å­èŠ‚ç‚¹ä¹Ÿå¢åŠ <code>add</code>æ–¹æ³•ï¼Œå¹¶åœ¨è°ƒç”¨çš„æ—¶å€™ï¼ŒæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸æ¥æé†’å®¢æˆ·ã€‚æ¯”å¦‚ä¸Šé¢çš„æ‰“å¼€ç”µè§†çš„å‘½ä»¤å¯¹è±¡ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> openTvCommand = &#123;</span><br><span class="line">  execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;æ‰“å¼€ç”µè§†&#x27;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  add: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// åŒæ ·çš„æ·»åŠ addæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;å¶å¯¹è±¡ä¸èƒ½æ·»åŠ å­èŠ‚ç‚¹&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="åº”ç”¨åœºæ™¯-â€”-æ‰«ææ–‡ä»¶å¤¹"><a href="#åº”ç”¨åœºæ™¯-â€”-æ‰«ææ–‡ä»¶å¤¹" class="headerlink" title="åº”ç”¨åœºæ™¯ â€” æ‰«ææ–‡ä»¶å¤¹"></a>åº”ç”¨åœºæ™¯ â€” æ‰«ææ–‡ä»¶å¤¹</h2><p>â€‹    æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ä¹‹é—´çš„å…³ç³»ï¼Œéå¸¸é€‚åˆç”¨ç»„åˆæ¨¡å¼æ¥æè¿°ã€‚æ–‡ä»¶å¤¹é‡Œæ—¢å¯ä»¥åŒ…å«æ–‡ä»¶ï¼Œåˆå¯ä»¥åŒ…å«å…¶ä»–æ–‡ä»¶å¤¹ï¼Œæœ€ç»ˆå¯èƒ½ç»„åˆæˆä¸€æ£µæ ‘ å½“ä½¿ç”¨ç”¨æ€æ¯’è½¯ä»¶æ‰«æè¯¥æ–‡ä»¶å¤¹æ—¶ï¼Œå¾€å¾€ä¸ä¼šå…³å¿ƒé‡Œé¢æœ‰å¤šå°‘æ–‡ä»¶å’Œå­æ–‡ä»¶å¤¹ï¼Œç»„åˆæ¨¡å¼ä½¿å¾—æˆ‘ä»¬åªéœ€è¦æ“ä½œæœ€å¤–å±‚çš„æ–‡ä»¶å¤¹è¿›è¡Œæ‰«æã€‚</p><h2 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h2><h3 id="ç»„åˆæ¨¡å¼ä¸æ˜¯çˆ¶å­å…³ç³»"><a href="#ç»„åˆæ¨¡å¼ä¸æ˜¯çˆ¶å­å…³ç³»" class="headerlink" title="ç»„åˆæ¨¡å¼ä¸æ˜¯çˆ¶å­å…³ç³»"></a>ç»„åˆæ¨¡å¼ä¸æ˜¯çˆ¶å­å…³ç³»</h3><p>â€‹    ç»„åˆæ¨¡å¼æ˜¯ä¸€ç§HAS-Aï¼ˆèšåˆï¼‰çš„å…³ç³»ï¼Œè€Œä¸æ˜¯IS-Aï¼›Leafå¹¶ä¸æ˜¯Compositeçš„å­ç±»ã€‚</p><h3 id="å¯¹å¶å¯¹è±¡æ“ä½œçš„ä¸€è‡´æ€§"><a href="#å¯¹å¶å¯¹è±¡æ“ä½œçš„ä¸€è‡´æ€§" class="headerlink" title="å¯¹å¶å¯¹è±¡æ“ä½œçš„ä¸€è‡´æ€§"></a>å¯¹å¶å¯¹è±¡æ“ä½œçš„ä¸€è‡´æ€§</h3><p>â€‹    ç»„åˆæ¨¡å¼é™¤äº†è¦æ±‚ç»„åˆå¯¹è±¡å’Œå¶å­å¯¹è±¡æ‹¥æœ‰ç›¸åŒçš„æ¥å£ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå¿…è¦æ¡ä»¶ï¼Œå°±æ˜¯å¯¹ä¸€ç»„å¶å¯¹è±¡çš„æ“ä½œçš„ä¸€è‡´æ€§ã€‚</p><p>â€‹    æ¯”å¦‚å…¬å¸è¦ç»™å…¨ä½“å‘˜å·¥å‘å…ƒæ—¦çš„è¿‡èŠ‚è´¹1000å…ƒï¼Œè¿™ä¸ªåœºæ™¯å¯ä»¥è¿ç”¨ç»„åˆæ¨¡å¼ï¼Œä½†å¦‚æœå…¬å¸è¦ç»™ä»Šå¤©è¿‡ç”Ÿæ—¥çš„å‘˜å·¥å‘é€ä¸€å°ç”Ÿæ—¥ç¥ç¦çš„é‚®ä»¶ï¼Œç»„åˆæ¨¡å¼å°±åšä¸åˆ°äº†ï¼Œé™¤éå…ˆæŠŠä»Šå¤©è¿‡ç”Ÿæ—¥çš„å‘˜å·¥æŒ‘é€‰å‡ºæ¥ã€‚åªæœ‰ç”¨ä¸€è‡´çš„æ–¹å¼å¯¹å¾…åˆ—è¡¨ä¸­çš„æ¯ä¸€ä¸ªå¶å­å¯¹è±¡çš„æ—¶å€™ï¼Œæ‰é€‚åˆä½¿ç”¨ç»„åˆæ¨¡å¼ã€‚</p><h3 id="åŒå‘æ˜ å°„å…³ç³»"><a href="#åŒå‘æ˜ å°„å…³ç³»" class="headerlink" title="åŒå‘æ˜ å°„å…³ç³»"></a>åŒå‘æ˜ å°„å…³ç³»</h3><p>â€‹    å‘æ”¾è¿‡èŠ‚è´¹çš„é€šçŸ¥æ­¥éª¤æ˜¯ä»å…¬å¸åˆ°å„ä¸ªéƒ¨é—¨ï¼Œå†åˆ°å„ä¸ªå°ç»„ï¼Œæœ€ååˆ°æ¯ä¸ªå‘˜å·¥çš„é‚®ç®±é‡Œã€‚è¿™æœ¬èº«æ˜¯ä¸€ä¸ªç»„åˆæ¨¡å¼çš„å¥½ä¾‹å­ï¼Œä½†æŸäº›å‘˜å·¥å¯èƒ½éš¶å±äºå¤šä¸ªç»„ç»‡ï¼Œå¯¹è±¡ä¹‹é—´çš„å…³ç³»å¹¶ä¸æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šçš„å±‚æ¬¡ç»“æ„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯ä¸é€‚åˆä½¿ç”¨ç»„åˆæ¨¡å¼çš„ï¼Œè¯¥å‘˜å·¥å¯èƒ½æ”¶åˆ°å¤šä»½è¿‡èŠ‚è´¹ã€‚</p><p>â€‹    è¿™ç§å¤åˆæƒ…å†µä¸‹æˆ‘ä»¬å¿…é¡»ç»™çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹å»ºç«‹åŒå‘æ˜ å°„å…³ç³»ï¼Œä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯ç»™å°ç»„å’Œå‘˜å·¥å¯¹è±¡éƒ½å¢åŠ é›†åˆæ¥ä¿å­˜å¯¹æ–¹çš„å¼•ç”¨ã€‚<br>ä½†æ˜¯è¿™ç§ç›¸äº’é—´çš„å¼•ç”¨ç›¸å½“å¤æ‚ï¼Œè€Œä¸”å¯¹è±¡ä¹‹é—´äº§ç”Ÿäº†è¿‡å¤šçš„è€¦åˆæ€§ï¼Œä¿®æ”¹æˆ–è€…åˆ é™¤ä¸€ä¸ªå¯¹è±¡éƒ½å˜å¾—å›°éš¾ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥å¼•å…¥ä¸­ä»‹è€…æ¨¡å¼æ¥ç®¡ç†è¿™äº›å¯¹è±¡ã€‚</p><h3 id="ç”¨èŒè´£é“¾æ¨¡å¼æé«˜ç»„åˆæ¨¡å¼æ€§èƒ½"><a href="#ç”¨èŒè´£é“¾æ¨¡å¼æé«˜ç»„åˆæ¨¡å¼æ€§èƒ½" class="headerlink" title="ç”¨èŒè´£é“¾æ¨¡å¼æé«˜ç»„åˆæ¨¡å¼æ€§èƒ½"></a>ç”¨èŒè´£é“¾æ¨¡å¼æé«˜ç»„åˆæ¨¡å¼æ€§èƒ½</h3><p>â€‹    åœ¨ç»„åˆæ¨¡å¼ä¸­ï¼Œå¦‚æœæ ‘çš„ç»“æ„æ¯”è¾ƒå¤æ‚ï¼ŒèŠ‚ç‚¹æ•°é‡å¾ˆå¤šï¼Œåœ¨éå†æ ‘çš„è¿‡ç¨‹ä¸­ï¼Œæ€§èƒ½æ–¹é¢ä¹Ÿè®¸è¡¨ç°çš„ä¸å¤Ÿç†æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©èŒè´£é“¾æ¨¡å¼é¿å…éå†æ•´æ£µæ ‘ã€‚èŒè´£é“¾æ¨¡å¼ä¸€èˆ¬éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å»è®¾ç½®é“¾æ¡ï¼Œä½†åœ¨ç»„åˆæ¨¡å¼ä¸­ï¼Œçˆ¶å¯¹è±¡å’Œå­å¯¹è±¡ä¹‹é—´å®é™…å½¢æˆäº†å¤©ç„¶çš„èŒè´£é“¾ã€‚è®©è¯·æ±‚é¡ºç€é“¾æ¡ä»çˆ¶å¯¹è±¡å¾€å­å¯¹è±¡ä¼ é€’ï¼Œæˆ–è€…æ˜¯åè¿‡æ¥ä»å­å¯¹è±¡å¾€çˆ¶å¯¹è±¡ä¼ é€’ï¼Œç›´åˆ°é‡åˆ°å¯ä»¥å¤„ç†è¯¥è¯·æ±‚çš„å¯¹è±¡ä½ç½®ã€‚</p><h2 id="å¼•ç”¨çˆ¶å¯¹è±¡"><a href="#å¼•ç”¨çˆ¶å¯¹è±¡" class="headerlink" title="å¼•ç”¨çˆ¶å¯¹è±¡"></a>å¼•ç”¨çˆ¶å¯¹è±¡</h2><p>åœ¨ç»„åˆæ¨¡å¼ä¸­ä½¿ç”¨èŒè´£é“¾æ—¶ï¼Œæœ‰å¯èƒ½éœ€è¦è®©è¯·æ±‚ä»å­èŠ‚ç‚¹å¾€çˆ¶èŠ‚ç‚¹ä¸Šå†’æ³¡ä¼ é€’</p><p>åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå½“æˆ‘ä»¬åˆ é™¤æŸä¸ªæ–‡ä»¶å¤¹çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯ä»è¿™ä¸ªæ–‡ä»¶å¤¹æ‰€åœ¨çš„ä¸Šå±‚æ–‡ä»¶å¤¹ä¸­åˆ é™¤æ”¹æ–‡ä»¶çš„ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Folder</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.parent = <span class="literal">null</span>; <span class="comment">// å¢åŠ  this.parent å±æ€§</span></span><br><span class="line">    <span class="built_in">this</span>.files = [];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">add</span>(<span class="params">file</span>)</span> &#123;</span><br><span class="line">    file.parent = <span class="built_in">this</span>; <span class="comment">// è®¾ç½®çˆ¶å¯¹è±¡</span></span><br><span class="line">    <span class="built_in">this</span>.files.push(file);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">scan</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;å¼€å§‹æ‰«ææ–‡ä»¶å¤¹: &#x27;</span> + <span class="built_in">this</span>.name);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, file, files = <span class="built_in">this</span>.files; file = files[i++];) &#123;</span><br><span class="line">      file.scan();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">remove</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">this</span>.parent) &#123; <span class="comment">// æ ¹èŠ‚ç‚¹æˆ–è€…æ ‘å¤–çš„æ¸¸ç¦»èŠ‚ç‚¹</span></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> files = <span class="built_in">this</span>.parent.files, l = files.length - <span class="number">1</span>; l &gt;= <span class="number">0</span>; l--) &#123; <span class="comment">// ä»çˆ¶ç›®å½•ä¸‹æœç´¢åˆ é™¤å½“å‰æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹</span></span><br><span class="line">      <span class="keyword">let</span> file = files[l];</span><br><span class="line">      <span class="keyword">if</span> (file === <span class="built_in">this</span>) &#123;</span><br><span class="line">        files.splice(l, <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.parent = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">add</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;ä¸èƒ½æ·»åŠ åœ¨æ–‡ä»¶ä¸‹é¢&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">scan</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;å¼€å§‹æ‰«ææ–‡ä»¶: &#x27;</span> + <span class="built_in">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">remove</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">this</span>.parent) &#123; <span class="comment">//æ ¹èŠ‚ç‚¹æˆ–è€…æ ‘å¤–çš„æ¸¸ç¦»èŠ‚ç‚¹</span></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> files = <span class="built_in">this</span>.parent.files, l = files.length - <span class="number">1</span>; l &gt;= <span class="number">0</span>; l--) &#123;</span><br><span class="line">      <span class="keyword">let</span> file = files[l];</span><br><span class="line">      <span class="keyword">if</span> (file === <span class="built_in">this</span>) &#123;</span><br><span class="line">        files.splice(l, <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä½•æ—¶ä½¿ç”¨ç»„åˆæ¨¡å¼"><a href="#ä½•æ—¶ä½¿ç”¨ç»„åˆæ¨¡å¼" class="headerlink" title="ä½•æ—¶ä½¿ç”¨ç»„åˆæ¨¡å¼"></a>ä½•æ—¶ä½¿ç”¨ç»„åˆæ¨¡å¼</h2><ul><li>è¡¨ç¤ºå¯¹è±¡çš„éƒ¨åˆ†-æ•´ä½“å±‚æ¬¡ç»“æ„ã€‚ç»„åˆæ¨¡å¼å¯ä»¥æ–¹ä¾¿çš„æ„é€ ä¸€æ£µæ ‘æ¥è¡¨ç¤ºå¯¹è±¡çš„éƒ¨åˆ†-æ•´ä½“ç»“æ„ã€‚<strong>ç‰¹åˆ«æ˜¯æˆ‘ä»¬ä¸ç¡®å®šè¯¥æ ‘åˆ°åº•å­˜åœ¨å¤šå°‘å±‚æ¬¡çš„æ—¶å€™</strong></li><li>ç”¨æˆ·å¸Œæœ›ä»¥ç»Ÿä¸€çš„æ–¹å¼å¯¹å¾…æ ‘ä¸­çš„æ‰€æœ‰å¯¹è±¡</li></ul><h2 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h2><p>â€‹    ç»„åˆæ¨¡å¼å¹¶ä¸æ˜¯å®Œç¾çš„ï¼Œå®ƒå¯èƒ½ä¼šäº§ç”Ÿä¸€ä¸ªè¿™æ ·çš„ç³»ç»Ÿ:ç³»ç»Ÿä¸­çš„æ¯ä¸ªå¯¹è±¡çœ‹èµ·æ¥éƒ½ä¸å…¶ä»–å¯¹è±¡å·®ä¸å¤šã€‚å®ƒä»¬çš„åŒºåˆ«åªæœ‰åœ¨è¿è¡Œçš„æ—¶å€™ä¼šæ‰ä¼šæ˜¾ç°å‡ºæ¥ï¼Œè¿™ä¼šä½¿ä»£ç éš¾ä»¥ç†è§£ã€‚æ­¤å¤–,å¦‚æœé€šè¿‡ç»„åˆæ¨¡å¼åˆ›å»ºäº†å¤ªå¤šçš„å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™äº›å¯¹è±¡å¯èƒ½ä¼šè®©ç³»ç»Ÿè´Ÿæ‹…ä¸èµ·ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ç»„åˆæ¨¡å¼&quot;&gt;&lt;a href=&quot;#ç»„åˆæ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;ç»„åˆæ¨¡å¼&quot;&gt;&lt;/a&gt;ç»„åˆæ¨¡å¼&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;ç»„åˆæ¨¡å¼å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ï¼Œä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ã€‚ é™¤äº†ç”¨æ¥è¡¨ç¤ºæ ‘å½¢ç»“æ„ä¹‹å¤–ï¼Œç»„åˆæ¨¡å¼
      
    
    </summary>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>å‘½ä»¤æ¨¡å¼</title>
    <link href="https://liang5757.github.io/2021/02/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/"/>
    <id>https://liang5757.github.io/2021/02/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/</id>
    <published>2021-02-03T07:32:07.000Z</published>
    <updated>2021-05-05T17:07:21.412Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‘½ä»¤æ¨¡å¼"><a href="#å‘½ä»¤æ¨¡å¼" class="headerlink" title="å‘½ä»¤æ¨¡å¼"></a>å‘½ä»¤æ¨¡å¼</h1><blockquote><p>å°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿ä½ å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼›å¯¹è¯·æ±‚æ’é˜Ÿæˆ–è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒå¯æ’¤é”€çš„æ“ä½œ</p></blockquote><h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h2><p>â€‹    æœ‰æ—¶å€™éœ€è¦å‘æŸäº›å¯¹è±¡å‘é€è¯·æ±‚ï¼Œä½†æ˜¯å¹¶ä¸çŸ¥é“è¯·æ±‚çš„æ¥æ”¶è€…æ˜¯è°ï¼Œä¹Ÿä¸çŸ¥é“è¢«è¯·æ±‚çš„æ“ä½œæ˜¯ä»€ä¹ˆã€‚æ­¤æ—¶å¸Œæœ›ç”¨ä¸€ç§æ¾è€¦åˆçš„æ–¹å¼æ¥è®¾è®¡ç¨‹åºï¼Œä½¿å¾—è¯·æ±‚å‘é€è€…å’Œè¯·æ±‚æ¥æ”¶è€…èƒ½å¤Ÿæ¶ˆé™¤å½¼æ­¤ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚</p><h3 id="èœå•æ¡ˆä¾‹"><a href="#èœå•æ¡ˆä¾‹" class="headerlink" title="èœå•æ¡ˆä¾‹"></a>èœå•æ¡ˆä¾‹</h3><h4 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h4><p>  å‡è®¾æˆ‘ä»¬æ­£åœ¨ç¼–å†™ä¸€ä¸ªç”¨æˆ·ç•Œé¢ç¨‹åºï¼Œè¯¥ç”¨æˆ·ç•Œé¢ä¸Šè‡³å°‘æœ‰æ•°åä¸ª Button æŒ‰é’®ã€‚å› ä¸ºé¡¹ç›®æ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬å†³å®šè®©æŸä¸ªç¨‹åºå‘˜è´Ÿè´£ç»˜åˆ¶è¿™äº›æŒ‰é’®ï¼Œè€Œå¦å¤–ä¸€äº›ç¨‹åºå‘˜åˆ™è´Ÿè´£ç¼–å†™ç‚¹å‡»æŒ‰é’®åçš„å…·ä½“è¡Œä¸ºï¼Œè¿™äº›è¡Œä¸ºéƒ½å°†è¢«å°è£…åœ¨å¯¹è±¡é‡Œã€‚</p><p>  åœ¨å¤§å‹é¡¹ç›®å¼€å‘ä¸­ï¼Œè¿™æ˜¯å¾ˆæ­£å¸¸çš„åˆ†å·¥ã€‚å¯¹äºç»˜åˆ¶æŒ‰é’®çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œä»–å®Œå…¨ä¸çŸ¥é“æŸä¸ªæŒ‰é’®æœªæ¥å°†ç”¨æ¥åšä»€ä¹ˆï¼Œå¯èƒ½ç”¨æ¥åˆ·æ–°èœå•ç•Œé¢ï¼Œä¹Ÿå¯èƒ½ç”¨æ¥å¢åŠ ä¸€äº›å­èœå•ï¼Œä»–åªçŸ¥é“ç‚¹å‡»è¿™ä¸ª æŒ‰é’®ä¼šå‘ç”ŸæŸäº›äº‹æƒ…ã€‚é‚£ä¹ˆå½“å®Œæˆè¿™ä¸ªæŒ‰é’®çš„ç»˜åˆ¶ä¹‹åï¼Œåº”è¯¥å¦‚ä½•ç»™å®ƒç»‘å®š<code>onclick</code> äº‹ä»¶å‘¢?</p><p>  æˆ‘ä»¬å¾ˆå¿«å¯ä»¥æ‰¾åˆ°åœ¨è¿™é‡Œè¿ç”¨å‘½ä»¤æ¨¡å¼çš„ç†ç”±:ç‚¹å‡»äº†æŒ‰é’®ä¹‹åï¼Œå¿…é¡»å‘æŸäº›è´Ÿè´£å…·ä½“è¡Œä¸ºçš„å¯¹è±¡å‘é€è¯·æ±‚ï¼Œè¿™äº›å¯¹è±¡å°±æ˜¯è¯·æ±‚çš„æ¥æ”¶è€…ã€‚ä½†æ˜¯ç›®å‰å¹¶ä¸çŸ¥é“æ¥æ”¶è€…æ˜¯ä»€ä¹ˆå¯¹è±¡ï¼Œä¹Ÿä¸çŸ¥é“æ¥æ”¶è€…ç©¶ç«Ÿä¼šåšä»€ä¹ˆã€‚æ­¤æ—¶æˆ‘ä»¬éœ€è¦å€ŸåŠ©å‘½ä»¤å¯¹è±¡çš„å¸®åŠ©ï¼Œä»¥ä¾¿è§£å¼€æŒ‰é’®å’Œè´Ÿè´£å…·ä½“è¡Œä¸ºå¯¹è±¡ä¹‹é—´çš„è€¦åˆã€‚</p><h4 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> RefreshMenuBarCommand = <span class="function"><span class="keyword">function</span> (<span class="params">receiver</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            receiver.refresh();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> setCommand = <span class="function"><span class="keyword">function</span> (<span class="params">button, command</span>) </span>&#123;</span><br><span class="line">    button.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        command.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> refreshMenuBarCommand = RefreshMenuBarCommand(MenuBar);</span><br><span class="line">setCommand(button1, refreshMenuBarCommand);</span><br></pre></td></tr></table></figure><h3 id="æ’¤é”€å’Œé‡åšå‘½ä»¤"><a href="#æ’¤é”€å’Œé‡åšå‘½ä»¤" class="headerlink" title="æ’¤é”€å’Œé‡åšå‘½ä»¤"></a>æ’¤é”€å’Œé‡åšå‘½ä»¤</h3><h4 id="åœºæ™¯-1"><a href="#åœºæ™¯-1" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h4><p>  å‘½ä»¤æ¨¡å¼çš„ä½œç”¨ä¸ä»…æ˜¯å°è£…è¿ç®—å—ï¼Œè€Œä¸”å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ç»™å‘½ä»¤å¯¹è±¡å¢åŠ æ’¤é”€æ“ä½œã€‚ç°åœ¨é¡µé¢ä¸Šæœ‰æ¸¸æˆéœ€è¦å¯¹å·²ç»è¿›è¡Œçš„æ“ä½œè¿›è¡Œ<strong>å›æ”¾</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Ryu = &#123;</span><br><span class="line">    <span class="function"><span class="title">attack</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;æ”»å‡»&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">defense</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;é˜²å¾¡&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">jump</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;è·³è·ƒ&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">crouch</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;è¹²ä¸‹&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> makeCommand = <span class="function"><span class="keyword">function</span> (<span class="params">receiver, state</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> receiver[state];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> commands = &#123;</span><br><span class="line">    <span class="string">&quot;119&quot;</span>: <span class="string">&quot;jump&quot;</span>, <span class="comment">// w</span></span><br><span class="line">    <span class="string">&quot;115&quot;</span>: <span class="string">&quot;crouch&quot;</span>, <span class="comment">// s</span></span><br><span class="line">    <span class="string">&quot;97&quot;</span>: <span class="string">&quot;defense&quot;</span>, <span class="comment">// a</span></span><br><span class="line">    <span class="string">&quot;100&quot;</span>: <span class="string">&quot;attack&quot;</span>, <span class="comment">// d</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> commandStack = []; <span class="comment">// ä¿å­˜å‘½ä»¤çš„å †æ ˆ</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.onkeypress = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> keyCode = e.keyCode;</span><br><span class="line">    <span class="keyword">let</span> command = makeCommand(Ryu, commands[keyCode]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (command) &#123;</span><br><span class="line">        command();</span><br><span class="line">        commandStack.push(command);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&quot;replay&quot;</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// ç‚¹å‡»æ’­æ”¾å½•åƒ</span></span><br><span class="line">    <span class="keyword">let</span> command;</span><br><span class="line">    <span class="keyword">while</span> (command = commandStack.shift()) &#123; <span class="comment">// ä»å †æ ˆè·å–æ­¤å‰çš„å‘½ä»¤å¹¶æ‰§è¡Œ</span></span><br><span class="line">        command();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ä¹¦ä¸Šçš„è¿™ä¸ªä¾‹å­å†™çš„æ›´åƒæ˜¯ç­–ç•¥æ¨¡å¼ï¼Œä¹¦ä¸Šä¸ºäº†å’Œç­–ç•¥æ¨¡å¼åŒºåˆ†è¿˜æŠŠ<code>receiver[state]()</code>ç”¨ä¸€ä¸ªåŒ¿åå‡½æ•°ç»™åŒ…èµ·æ¥ï¼Œè¢«æˆ‘ç»™åˆ äº†ï¼Œä¸è¦ä¸ºäº†ç”¨è®¾è®¡æ¨¡å¼è€Œç”¨è®¾è®¡æ¨¡å¼ã€‚å…¶å®<strong>ç­–ç•¥æ¨¡å¼æ˜¯å¯¹ä¸€ç³»åˆ—ç®—æ³•çš„å°è£…ï¼Œä½¿ä»–ä»¬äº’ç›¸å¯æ›¿æ¢</strong>ï¼Œä½†<strong>å‘½ä»¤æ¨¡å¼æ˜¯å¯¹ä¸€ç³»åˆ—å‘½ä»¤å¯¹è±¡çš„å°è£…ï¼Œä½¿æ¥å—è€…å’Œå‘é€è€…è§£è€¦</strong>ã€‚</p><h3 id="å®å‘½ä»¤"><a href="#å®å‘½ä»¤" class="headerlink" title="å®å‘½ä»¤"></a>å®å‘½ä»¤</h3><p>â€‹    å®å‘½ä»¤æ˜¯ä¸€ç»„å‘½ä»¤çš„é›†åˆï¼Œé€šè¿‡æ‰§è¡Œå®å‘½ä»¤çš„æ–¹å¼ï¼Œå¯ä»¥ä¸€æ¬¡æ‰§è¡Œä¸€æ‰¹å‘½ä»¤ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå®¶é‡Œæœ‰ä¸€ä¸ªä¸‡èƒ½é¥æ§å™¨ï¼Œæ¯å¤©å›å®¶çš„æ—¶å€™ï¼Œåªè¦æŒ‰ä¸€ä¸ªç‰¹åˆ«çš„æŒ‰é’®ï¼Œå®ƒå°±ä¼šå¸®æˆ‘ä»¬å…³ä¸Šæˆ¿é—´é—¨ï¼Œé¡ºä¾¿æ‰“å¼€ç”µè„‘å¹¶ç™»å½• QQã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> closeDoorCommand = &#123;</span><br><span class="line">  execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;å…³é—¨&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> openPcCommand = &#123;</span><br><span class="line">  execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;å¼€ç”µè„‘&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> openQQCommand = &#123;</span><br><span class="line">  execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;ç™»å½• QQ&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> MacroCommand = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    commandsList: [],</span><br><span class="line">    add: <span class="function"><span class="keyword">function</span> (<span class="params">command</span>) </span>&#123; <span class="comment">// ç»™å®å‘½ä»¤æ·»åŠ æŒ‡ä»¤</span></span><br><span class="line">      <span class="built_in">this</span>.commandsList.push(command);</span><br><span class="line">    &#125;,</span><br><span class="line">    execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// æ‰§è¡Œå®å‘½ä»¤</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, command; command = <span class="built_in">this</span>.commandsList[i++];) &#123;</span><br><span class="line">        command.execute();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> macroCommand = MacroCommand();</span><br><span class="line"></span><br><span class="line">macroCommand.add(closeDoorCommand); </span><br><span class="line">macroCommand.add(openPcCommand);</span><br><span class="line">macroCommand.add(openQQCommand);</span><br><span class="line"></span><br><span class="line">macroCommand.execute();</span><br></pre></td></tr></table></figure><h3 id="æ™ºèƒ½å‘½ä»¤ä¸å‚»ç“œå‘½ä»¤"><a href="#æ™ºèƒ½å‘½ä»¤ä¸å‚»ç“œå‘½ä»¤" class="headerlink" title="æ™ºèƒ½å‘½ä»¤ä¸å‚»ç“œå‘½ä»¤"></a>æ™ºèƒ½å‘½ä»¤ä¸å‚»ç“œå‘½ä»¤</h3><p>â€‹    ä¸Šä¸€ä¸ªä¾‹å­çš„å‘½ä»¤æ²¡ç”¨åŒ…å«ä»»ä½•<code>receiver</code>çš„ä¿¡æ¯ï¼Œå®ƒæœ¬èº«å°±åŒ…æ½äº†æ‰§è¡Œè¯·æ±‚çš„è¡Œä¸ºï¼Œè¿™è·Ÿæˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„å‘½ä»¤å¯¹è±¡éƒ½åŒ…å«äº†ä¸€ä¸ª<code>receiver</code>æ˜¯çŸ›ç›¾çš„ã€‚</p><p>â€‹    ä¸€èˆ¬æ¥è¯´ï¼Œå‘½ä»¤æ¨¡å¼éƒ½ä¼šåœ¨commandå¯¹è±¡ä¸­ä¿å­˜ä¸€ä¸ªæ¥å—è€…æ¥è´Ÿè´£çœŸæ­£æ‰§è¡Œå®¢æˆ·çš„è¯·æ±‚ï¼Œè¿™ç§æƒ…å†µä¸‹å‘½ä»¤å¯¹è±¡æ˜¯â€œ<strong>å‚»ç“œå¼</strong>â€çš„ï¼Œå®ƒåªè´Ÿè´£æŠŠå®¢æˆ·çš„è¯·æ±‚è½¬äº¤ç»™æ¥å—è€…æ¥æ‰§è¡Œï¼Œè¿™ç§æ¨¡å¼çš„å¥½å¤„æ˜¯è¯·æ±‚çš„å‘èµ·è€…å’Œè¯·æ±‚çš„æ¥å—è€…ä¹‹é—´å°½å¯èƒ½çš„è§£è€¦ã€‚</p><p>â€‹    â€œèªæ˜â€çš„å‘½ä»¤å¯¹è±¡å¯ä»¥ç›´æ¥å®ç°è¯·æ±‚ï¼Œè¿™æ ·ä¸€æ¥å°±ä¸éœ€è¦æ¥æ”¶è€…çš„å­˜åœ¨ï¼Œå’Œç­–ç•¥æ¨¡å¼éå¸¸æ¥è¿‘ï¼Œä½†å‘½ä»¤æ¨¡å¼è§£å†³çš„é—®é¢˜æ›´å…·å‘æ•£æ€§ã€‚</p><p>â€‹    å‘½ä»¤æ¨¡å¼è¿˜å¯ä»¥å®Œæˆæ’¤é”€ã€æ’é˜Ÿç­‰åŠŸèƒ½</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‘½ä»¤æ¨¡å¼&quot;&gt;&lt;a href=&quot;#å‘½ä»¤æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;å‘½ä»¤æ¨¡å¼&quot;&gt;&lt;/a&gt;å‘½ä»¤æ¨¡å¼&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;å°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿ä½ å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼›å¯¹è¯·æ±‚æ’é˜Ÿæˆ–è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯
      
    
    </summary>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</title>
    <link href="https://liang5757.github.io/2021/02/02/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%8F%91%E5%B8%83-%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F/"/>
    <id>https://liang5757.github.io/2021/02/02/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%8F%91%E5%B8%83-%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F/</id>
    <published>2021-02-02T07:31:09.000Z</published>
    <updated>2021-05-05T17:07:19.140Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‘å¸ƒ-è®¢é˜…æ¨¡å¼"><a href="#å‘å¸ƒ-è®¢é˜…æ¨¡å¼" class="headerlink" title="å‘å¸ƒ-è®¢é˜…æ¨¡å¼"></a>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</h1><blockquote><p>åˆå«è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå®ƒå®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å°†å¾—åˆ°é€šçŸ¥</p></blockquote><p>åœ¨jsä¸­ï¼Œæœ‰ä¸€ç§å¾ˆç®€å•å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯DOMäº‹ä»¶ï¼Œ<code>addEventListener</code>å°±å¯ä»¥å®ç°è®¢é˜…domèŠ‚ç‚¹ä¸Šçš„äº‹ä»¶ï¼Œè§¦å‘äº‹ä»¶åå°±æ‰§è¡Œå›è°ƒ</p><h2 id="1-è‡ªå®šä¹‰äº‹ä»¶"><a href="#1-è‡ªå®šä¹‰äº‹ä»¶" class="headerlink" title="1. è‡ªå®šä¹‰äº‹ä»¶"></a>1. è‡ªå®šä¹‰äº‹ä»¶</h2><p><strong>å®ç°å‘å¸ƒè®¢é˜…çš„æ­¥éª¤</strong></p><ol><li>æŒ‡å®šå¥½å‘å¸ƒè€…</li><li>ä¸ºå‘å¸ƒè€…æ·»åŠ ä¸€ä¸ªç¼“å­˜åˆ—è¡¨ï¼Œç”¨ä»¥å­˜æ”¾å›è°ƒå‡½æ•°ä»¥é€šçŸ¥è®¢é˜…è€…</li><li>å‘å¸ƒæ¶ˆæ¯çš„æ—¶å€™ï¼Œå‘å¸ƒè€…ä¼šéå†è¿™ä¸ªç¼“å­˜åˆ—è¡¨ï¼Œä¾æ¬¡è§¦å‘è®¢é˜…è€…å›è°ƒå‡½æ•°ã€‚</li></ol><p>ä¸‹é¢ç”¨ä»£ç å®ç°ä¸€ä¸‹å‘å¸ƒ-è®¢é˜…æ¨¡å¼</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¢é˜…è€…å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="keyword">interface</span> Observers &#123;</span><br><span class="line">  [event: <span class="built_in">string</span>]: <span class="built_in">Array</span>&lt;<span class="built_in">Function</span>&gt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å¸ƒè€…</span></span><br><span class="line"><span class="keyword">let</span> publisher = &#123;</span><br><span class="line">  observers: &lt;Observers&gt;&#123;&#125;, <span class="comment">// å­˜æ”¾è®¢é˜…è€…å›è°ƒå‡½æ•°</span></span><br><span class="line">  <span class="comment">// å¢åŠ è®¢é˜…è€…</span></span><br><span class="line">  <span class="function"><span class="title">add</span>(<span class="params">event, fn</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">this</span>.observers[event]) &#123;</span><br><span class="line">      <span class="built_in">this</span>.observers[event] = [];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">this</span>.observers[event].push(fn); <span class="comment">// æ·»åŠ è®¢é˜…è€…åˆ°ç¼“å­˜åˆ—è¡¨</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ç§»é™¤è®¢é˜…è€…</span></span><br><span class="line">  <span class="function"><span class="title">remove</span>(<span class="params">event, fn</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> fns = <span class="built_in">this</span>.observers[event];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!fns) &#123; <span class="comment">// å¦‚æœè¯¥äº‹ä»¶æ²¡æœ‰è®¢é˜…è€…ï¼Œåˆ™è¿”å›</span></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!fn) &#123; <span class="comment">// å¦‚æœæ²¡æœ‰ä¼ å…¥è®¢é˜…è€…å›è°ƒå‡½æ•°ï¼Œåˆ™è¡¨ç¤ºå–æ¶ˆè¯¥äº‹ä»¶çš„æ‰€æœ‰è®¢é˜…è€…</span></span><br><span class="line">      fns &amp;&amp; (fns.length = <span class="number">0</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> l = fns.length - <span class="number">1</span>; l &gt;= <span class="number">0</span>; l--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (fns[l] === fn) &#123;</span><br><span class="line">          fns.splice(l, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// å‘å¸ƒæ¶ˆæ¯ï¼Œé€šçŸ¥æ‰€æœ‰è®¢é˜…è€…</span></span><br><span class="line">  <span class="function"><span class="title">trigger</span>(<span class="params">event, ...args</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> fns = <span class="built_in">this</span>.observers[event];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!fns || fns.length === <span class="number">0</span>) &#123; <span class="comment">// å¦‚æœæ²¡æœ‰è®¢é˜…è€…ï¼Œè¿”å›false</span></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, fn; fn = fns[i++];) &#123;</span><br><span class="line">      fn.apply(<span class="built_in">this</span>, args); <span class="comment">// è§¦å‘è®¢é˜…è€…å›è°ƒå‡½æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœè¦å®ç°ä¸€ä¸ªé€šç”¨çš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> installEvent = <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> publisher) &#123;</span><br><span class="line">    obj[i] = publisher[i];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å°è¯•ä½¿ç”¨ä¸€ä¸‹</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> salesOffices: <span class="built_in">any</span> = &#123;&#125;;</span><br><span class="line">installEvent(salesOffices);</span><br><span class="line"></span><br><span class="line">salesOffices.add(<span class="string">&#x27;squareMeter88&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">price</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;å°ç¾&#x27;</span>)</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;ä»·æ ¼=&#x27;</span> + price);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">salesOffices.add(<span class="string">&#x27;squareMeter100&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">price</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;å°æ˜&#x27;</span>)</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;ä»·æ ¼=&#x27;</span> + price);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">salesOffices.trigger(<span class="string">&#x27;squareMeter88&#x27;</span>, <span class="number">20000</span>); <span class="comment">// å°æ˜ 20000</span></span><br><span class="line">salesOffices.trigger(<span class="string">&#x27;squareMeter100&#x27;</span>, <span class="number">30000</span>); <span class="comment">// å°ç¾ 30000</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™æ ·<code>salesOffices</code>å¯¹è±¡ä¾æ—§å…·æœ‰è€¦åˆåº¦ï¼Œ<strong>è®¢é˜…è€…å¿…é¡»çŸ¥é“å‘å¸ƒè€…çš„åå­—ï¼Œæ‰èƒ½è®¢é˜…åˆ°äº‹ä»¶</strong>ï¼Œå¯ä»¥<strong>ä½¿ç”¨å…¨å±€çš„å‘å¸ƒè€…Eventå¯¹è±¡</strong>è¿›è¡Œå‘å¸ƒï¼Œå°±åƒvueä¸­çš„<code>eventBus</code>ï¼Œè¿™æ ·åšè™½ç„¶å‡å°‘äº†è€¦åˆåº¦ï¼Œä½†æ˜¯<strong>æ¶ˆæ¯æ¥è‡ªå“ªä¸ªæ¨¡å—ï¼Œä»¥åŠä¼šæµå‘å“ªä¸ªæ¨¡å—éƒ½æ˜¯ä¸ç›´è§‚çš„</strong>ï¼Œå®¹æ˜“å¸¦æ¥ç»´æŠ¤æ€§ä¸Šçš„é—®é¢˜ï¼Œå¹¶ä¸”é€šè¿‡å…¨å±€çš„æ¥è®¢é˜…å‘å¸ƒæ¶ˆæ¯ï¼Œå®¹æ˜“é€ æˆ<strong>å‘½åå†²çª</strong>ã€‚</p><h2 id="2-å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„ä¸¤ç§æ¨¡å‹"><a href="#2-å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„ä¸¤ç§æ¨¡å‹" class="headerlink" title="2.å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„ä¸¤ç§æ¨¡å‹"></a>2.å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„ä¸¤ç§æ¨¡å‹</h2><ol><li>æ¨æ¨¡å‹ï¼šå½“ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿåå°†é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…ï¼Œå¹¶æŠŠæ‰€æœ‰çš„æ–°æ•°æ®ä¼ ç»™ä»–ä»¬</li><li>æ‹‰æ¨¡å‹ï¼šå½“ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿåå°†é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…ï¼Œæ¯ä¸ªè®¢é˜…è€…å°†æ‹‰å–è‡ªå·±éœ€è¦çš„æ•°æ®<ul><li>å¯ä»¥è®©è®¢é˜…è€…æŒ‰éœ€è·å–</li><li>ä½†æœ‰å¯èƒ½è®©å‘å¸ƒè€…å˜æˆä¸€ä¸ªâ€œé—¨æˆ·å¤§å¼€â€çš„å¯¹è±¡ï¼ŒåŒæ—¶å¢åŠ ä»£ç é‡å’Œå¤æ‚åº¦</li></ul></li></ol><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‘å¸ƒ-è®¢é˜…æ¨¡å¼&quot;&gt;&lt;a href=&quot;#å‘å¸ƒ-è®¢é˜…æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;å‘å¸ƒ-è®¢é˜…æ¨¡å¼&quot;&gt;&lt;/a&gt;å‘å¸ƒ-è®¢é˜…æ¨¡å¼&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;åˆå«è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå®ƒå®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹
      
    
    </summary>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>è¿­ä»£å™¨æ¨¡å¼</title>
    <link href="https://liang5757.github.io/2021/02/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
    <id>https://liang5757.github.io/2021/02/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/</id>
    <published>2021-02-01T07:29:36.000Z</published>
    <updated>2021-05-05T17:07:15.362Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è¿­ä»£å™¨æ¨¡å¼"><a href="#è¿­ä»£å™¨æ¨¡å¼" class="headerlink" title="è¿­ä»£å™¨æ¨¡å¼"></a>è¿­ä»£å™¨æ¨¡å¼</h1><blockquote><p>æ˜¯æŒ‡æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚</p></blockquote><p>jsæœ‰è®¸å¤šè¿­ä»£å™¨æ¨¡å¼å®ç°ï¼Œæ¯”å¦‚è¯´forEachï¼Œes6çš„yield</p><h2 id="1-å†…éƒ¨è¿­ä»£å™¨å’Œå¤–éƒ¨è¿­ä»£å™¨"><a href="#1-å†…éƒ¨è¿­ä»£å™¨å’Œå¤–éƒ¨è¿­ä»£å™¨" class="headerlink" title="1. å†…éƒ¨è¿­ä»£å™¨å’Œå¤–éƒ¨è¿­ä»£å™¨"></a>1. å†…éƒ¨è¿­ä»£å™¨å’Œå¤–éƒ¨è¿­ä»£å™¨</h2><h3 id="1-1-å†…éƒ¨è¿­ä»£å™¨"><a href="#1-1-å†…éƒ¨è¿­ä»£å™¨" class="headerlink" title="1.1 å†…éƒ¨è¿­ä»£å™¨"></a>1.1 å†…éƒ¨è¿­ä»£å™¨</h3><blockquote><p>å†…éƒ¨å®šä¹‰å¥½è¿­ä»£è§„åˆ™ï¼Œå¤–éƒ¨åªéœ€è¦ä¸€æ¬¡åˆå§‹è°ƒç”¨</p></blockquote><p>æ¯”å¦‚è¯´jqueryçš„<code>$.each</code>ï¼Œä»¥åŠjsçš„<code>for...of</code></p><h3 id="1-2-å¤–éƒ¨è¿­ä»£å™¨"><a href="#1-2-å¤–éƒ¨è¿­ä»£å™¨" class="headerlink" title="1.2 å¤–éƒ¨è¿­ä»£å™¨"></a>1.2 å¤–éƒ¨è¿­ä»£å™¨</h3><blockquote><p>æ˜¾ç¤ºçš„è¯·æ±‚è¿­ä»£ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œè¿­ä»£æµç¨‹ç”±å¤–éƒ¨æ§åˆ¶</p></blockquote><p>æ¯”å¦‚è¯´es6çš„è¿­ä»£å™¨<code>yield</code></p><h2 id="2-å®ç°ä¸€ä¸ª-eachçš„è¿­ä»£å™¨"><a href="#2-å®ç°ä¸€ä¸ª-eachçš„è¿­ä»£å™¨" class="headerlink" title="2. å®ç°ä¸€ä¸ª$.eachçš„è¿­ä»£å™¨"></a>2. å®ç°ä¸€ä¸ª$.eachçš„è¿­ä»£å™¨</h2><p>å¯ä»¥éå†ç±»æ•°ç»„å¯¹è±¡ä»¥åŠå­—é¢é‡å¯¹è±¡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">each</span>(<span class="params">obj, callback</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> length, i = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// åˆ¤æ–­æ˜¯å¦ä¸ºç±»æ•°ç»„å¯¹è±¡</span></span><br><span class="line">  <span class="keyword">if</span> (isArrayLike(obj)) &#123;</span><br><span class="line">    length = obj.length;</span><br><span class="line">    <span class="keyword">for</span> (; i &lt; length; i++) &#123;</span><br><span class="line">      <span class="comment">// å¦‚æœå›è°ƒå‡½æ•°æ”¾å›falseï¼Œä¸­æ–­è¿­ä»£å™¨</span></span><br><span class="line">      <span class="keyword">if</span> (callback.call(obj[i], i, obj[i]) === <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> obj) &#123;</span><br><span class="line">      <span class="keyword">if</span> (callback.call(obj[i], i, obj[i]) === <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> obj</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> data = &#123; <span class="number">0</span>: <span class="string">&quot;a&quot;</span>, <span class="number">1</span>: <span class="string">&quot;b&quot;</span>, <span class="attr">length</span>: <span class="number">2</span> &#125;</span><br><span class="line">each(data, <span class="function">(<span class="params">key, val</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key, val); </span><br><span class="line">  <span class="comment">// 0 a</span></span><br><span class="line">  <span class="comment">// 1 b</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="3-æ‰‹åŠ¨å®ç°es6çš„ç®€æ˜“è¿­ä»£å™¨"><a href="#3-æ‰‹åŠ¨å®ç°es6çš„ç®€æ˜“è¿­ä»£å™¨" class="headerlink" title="3. æ‰‹åŠ¨å®ç°es6çš„ç®€æ˜“è¿­ä»£å™¨"></a>3. æ‰‹åŠ¨å®ç°es6çš„ç®€æ˜“è¿­ä»£å™¨</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ç”Ÿæˆå™¨å‡½æ•°ï¼Œå…¥å‚æ˜¯ä»»æ„é›†åˆ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">iteratorGenerator</span>(<span class="params">list</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// idxè®°å½•å½“å‰è®¿é—®çš„ç´¢å¼•</span></span><br><span class="line">  <span class="keyword">let</span> idx = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// lenè®°å½•ä¼ å…¥é›†åˆçš„é•¿åº¦</span></span><br><span class="line">  <span class="keyword">const</span> len = list.length;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// è‡ªå®šä¹‰nextæ–¹æ³•</span></span><br><span class="line">    next: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// å¦‚æœç´¢å¼•è¿˜æ²¡æœ‰è¶…å‡ºé›†åˆé•¿åº¦ï¼Œdone ä¸º false</span></span><br><span class="line">      <span class="keyword">const</span> done = idx &gt;= len;</span><br><span class="line">      <span class="comment">// å¦‚æœdoneä¸ºfalseï¼Œåˆ™å¯ä»¥ç»§ç»­å–å€¼</span></span><br><span class="line">      <span class="keyword">const</span> value = !done ? list[idx++] : <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// å°†å½“å‰å€¼ä¸éå†æ˜¯å¦å®Œæ¯•ï¼ˆdoneï¼‰è¿”å›</span></span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        done: done,</span><br><span class="line">        value: value</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ã€Šjavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹<br>ã€Š<a href="https://juejin.cn/book/6844733790204461070/section">JavaScript è®¾è®¡æ¨¡å¼æ ¸â¼¼åŸç†ä¸åº”â½¤å®è·µ</a>ã€‹</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;è¿­ä»£å™¨æ¨¡å¼&quot;&gt;&lt;a href=&quot;#è¿­ä»£å™¨æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;è¿­ä»£å™¨æ¨¡å¼&quot;&gt;&lt;/a&gt;è¿­ä»£å™¨æ¨¡å¼&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;æ˜¯æŒ‡æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚&lt;/p&gt;
      
    
    </summary>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://liang5757.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
</feed>
